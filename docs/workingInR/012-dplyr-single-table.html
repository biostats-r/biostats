<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.20">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>14&nbsp; Working with single tables in dplyr – Working in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./013-dplyr-multiple-tables.html" rel="next">
<link href="./011-tidyr-pivot.html" rel="prev">
<link href="./../figures/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7fcc278e5cff05d3108fdca62cff0c71.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-5aa1d2b69dd70a877b51c7f7d5713d8d.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7fcc278e5cff05d3108fdca62cff0c71.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5104340a04435264153ef873f23f72c3.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-5494b68deea9f9baeb7399c3c408f1fa.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-5104340a04435264153ef873f23f72c3.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="include/webex.css">
</head>
<body class="nav-sidebar floating slimcontent quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const queryPrefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const darkModeDefault = queryPrefersDark.matches;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    queryPrefersDark.addEventListener("change", e => {
      if(window.localStorage.getItem("quarto-color-scheme") !== null)
        return;
      const alternate = e.matches
      toggleColorMode(alternate);
      localAlternateSentinel = e.matches ? 'alternate' : 'default'; // this is used alongside local storage!
      toggleGiscusIfUsed(alternate, darkModeDefault);
    });
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./010-pipes.html">Data manipulation with the tidyverse</a></li><li class="breadcrumb-item"><a href="./012-dplyr-single-table.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Working with single tables in <code>dplyr</code></span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Working in R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/biostats-r/biostats" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Setting up R and RStudio</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0010_Getting_Started_with_RStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Installing and configuring R and RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0011_projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">RStudio projects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0012_scripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working with a script</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0013_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Installing packages</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">First steps in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0021_R_calculator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R as a calculator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0022_help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Help!</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0023_objects_names.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Objects and names</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./002_V_is_for_vector.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">V is for vector</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0025_data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data structures beyond the vector</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./005_Importing_Data_in_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Importing data in R</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Data manipulation with the tidyverse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./010-pipes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Pipes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./011-tidyr-pivot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Tidying data with <code>tidyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./012-dplyr-single-table.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Working with single tables in <code>dplyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./013-dplyr-multiple-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Working with multiple tables in <code>dplyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./014-iterate-with-purrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Running code repeatedly</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Visualisation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./100_why_data_visualisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Why is data visualization important?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./101_getting_started_with_ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Getting started with ggplot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./103_different_types_of_vizualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Choosing your visualisation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./118_themes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Themes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./120_colour_shape_linetypes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Colours, shapes and linetypes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./125_ggplot_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Regression and ggplot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./130_patchwork.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Combining plots</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./140_maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Making maps in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./141-mathematical-notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Mathematical notation for plots</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./150_ggplot_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">ggplot2 helper packages</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Other Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./050_missing_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Handling missing values</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./060_bestiary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Bestiary of Brackets and other R notation</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p><a href="https://biostats.w.uib.no/"><img src="https://biostats.w.uib.no/files/2020/01/biostats-button-res2.png" title="bioST@TS | When biology adds up, at last…" class="img-fluid" alt="Link to biostats website"></a> <br><a href="../index.html"><img src="../figures/icons_all.png" title="BioST@TS books" alt="Link to biostats books" width="250" height="50"></a></p>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#load-the-package" id="toc-load-the-package" class="nav-link active" data-scroll-target="#load-the-package"><span class="header-section-number">14.0.1</span> Load the package</a></li>
  <li><a href="#more-feedback-tidylog" id="toc-more-feedback-tidylog" class="nav-link" data-scroll-target="#more-feedback-tidylog"><span class="header-section-number">14.0.2</span> More feedback <code>tidylog</code></a></li>
  <li><a href="#the-penguins-dataset" id="toc-the-penguins-dataset" class="nav-link" data-scroll-target="#the-penguins-dataset"><span class="header-section-number">14.1</span> The <code>penguins</code> dataset</a></li>
  <li>
<a href="#selecting-columns-with-select" id="toc-selecting-columns-with-select" class="nav-link" data-scroll-target="#selecting-columns-with-select"><span class="header-section-number">14.2</span> Selecting columns with <code>select()</code></a>
  <ul class="collapse">
<li><a href="#sec-select-helpers" id="toc-sec-select-helpers" class="nav-link" data-scroll-target="#sec-select-helpers"><span class="header-section-number">14.2.1</span> <code>select()</code> helpers</a></li>
  </ul>
</li>
  <li><a href="#renaming-columns-with-rename" id="toc-renaming-columns-with-rename" class="nav-link" data-scroll-target="#renaming-columns-with-rename"><span class="header-section-number">14.3</span> Renaming columns with <code>rename</code></a></li>
  <li><a href="#moving-columns-with-relocate" id="toc-moving-columns-with-relocate" class="nav-link" data-scroll-target="#moving-columns-with-relocate"><span class="header-section-number">14.4</span> Moving columns with <code>relocate()</code></a></li>
  <li>
<a href="#filtering-rows-with-filter" id="toc-filtering-rows-with-filter" class="nav-link" data-scroll-target="#filtering-rows-with-filter"><span class="header-section-number">14.5</span> Filtering rows with <code>filter()</code></a>
  <ul class="collapse">
<li><a href="#filtering-on-multiple-criteria" id="toc-filtering-on-multiple-criteria" class="nav-link" data-scroll-target="#filtering-on-multiple-criteria"><span class="header-section-number">14.5.1</span> Filtering on multiple criteria</a></li>
  <li><a href="#common-errors" id="toc-common-errors" class="nav-link" data-scroll-target="#common-errors"><span class="header-section-number">14.5.2</span> Common errors</a></li>
  </ul>
</li>
  <li><a href="#slicing-the-data-with-slice" id="toc-slicing-the-data-with-slice" class="nav-link" data-scroll-target="#slicing-the-data-with-slice"><span class="header-section-number">14.6</span> Slicing the data with <code>slice()</code></a></li>
  <li><a href="#distinct-rows-with-distinct" id="toc-distinct-rows-with-distinct" class="nav-link" data-scroll-target="#distinct-rows-with-distinct"><span class="header-section-number">14.7</span> Distinct rows with <code>distinct()</code></a></li>
  <li><a href="#random-rows" id="toc-random-rows" class="nav-link" data-scroll-target="#random-rows"><span class="header-section-number">14.8</span> Random rows</a></li>
  <li><a href="#mutating-and-adding-columns-with-mutate" id="toc-mutating-and-adding-columns-with-mutate" class="nav-link" data-scroll-target="#mutating-and-adding-columns-with-mutate"><span class="header-section-number">14.9</span> Mutating and adding columns with <code>mutate</code></a></li>
  <li>
<a href="#summarising-data-with-summarise" id="toc-summarising-data-with-summarise" class="nav-link" data-scroll-target="#summarising-data-with-summarise"><span class="header-section-number">14.10</span> Summarising data with <code>summarise()</code></a>
  <ul class="collapse">
<li><a href="#summarising-multiple-columns" id="toc-summarising-multiple-columns" class="nav-link" data-scroll-target="#summarising-multiple-columns"><span class="header-section-number">14.10.1</span> Summarising multiple columns</a></li>
  </ul>
</li>
  <li><a href="#grouping-data-with-group_by" id="toc-grouping-data-with-group_by" class="nav-link" data-scroll-target="#grouping-data-with-group_by"><span class="header-section-number">14.11</span> Grouping data with <code>group_by</code></a></li>
  <li><a href="#sorting-with-arrange" id="toc-sorting-with-arrange" class="nav-link" data-scroll-target="#sorting-with-arrange"><span class="header-section-number">14.12</span> Sorting with <code>arrange()</code></a></li>
  <li><a href="#counting-rows-with-count-and-n" id="toc-counting-rows-with-count-and-n" class="nav-link" data-scroll-target="#counting-rows-with-count-and-n"><span class="header-section-number">14.13</span> Counting rows with <code>count()</code> and <code>n()</code></a></li>
  <li>
<a href="#common-problems" id="toc-common-problems" class="nav-link" data-scroll-target="#common-problems"><span class="header-section-number">14.14</span> Common problems</a>
  <ul class="collapse">
<li><a href="#non-standard-names" id="toc-non-standard-names" class="nav-link" data-scroll-target="#non-standard-names"><span class="header-section-number">14.14.1</span> Non standard names</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./010-pipes.html">Data manipulation with the tidyverse</a></li><li class="breadcrumb-item"><a href="./012-dplyr-single-table.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Working with single tables in <code>dplyr</code></span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-working-with-single-tables-in-dplyr" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Working with single tables in <code>dplyr</code></span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Data frames are usually the most convenient objects for storing, plotting or analysing data in R. We also need to be able to manipulate data in data frames.</p>
<p>This tutorial will show you how to manipulate data frames using the <code>dplyr</code> package, part of <code>tidyverse</code>.</p>
<p>Everything that can be done with <code>dplyr</code> can be done with base R. The <code>dplyr</code> solution is usually easier to write and understand, and can be faster.</p>
<p>There are many function in <code>dplyr</code>, this tutorial focuses on the functions we find most useful.</p>
<section id="load-the-package" class="level3" data-number="14.0.1"><h3 data-number="14.0.1" class="anchored" data-anchor-id="load-the-package">
<span class="header-section-number">14.0.1</span> Load the package</h3>
<p>You can load <code>dplyr</code> with</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org">"dplyr"</a></span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>But is is usually more convenient to load <code>tidyverse</code> so that you get <code>ggplot2</code>, <code>dplyr</code>, <code>readr</code> and other useful packages with one command.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="more-feedback-tidylog" class="level3" data-number="14.0.2"><h3 data-number="14.0.2" class="anchored" data-anchor-id="more-feedback-tidylog">
<span class="header-section-number">14.0.2</span> More feedback <code>tidylog</code>
</h3>
<p>We can get more feedback on what <code>dplyr</code> functions have done to the data by loading the <code>tidylog</code> package.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/elbersb/tidylog/">"tidylog"</a></span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>More than once, <code>tidylog</code> has helped identified bugs in my code.</p>
</section><section id="the-penguins-dataset" class="level2" data-number="14.1"><h2 data-number="14.1" class="anchored" data-anchor-id="the-penguins-dataset">
<span class="header-section-number">14.1</span> The <code>penguins</code> dataset</h2>
<p>This tutorial will use the <code>penguins</code> dataset that is included with R. The <code>penguins</code> dataset contains morphological data on three species of penguin. You will meet this dataset repeatedly as it provides a convenient set of variables and observations well-suited for illustrating many purposes. To improve printing, we’ve converted the <code>penguins</code> data.frame into a tibble.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Show the data</span></span>
<span><span class="va">penguins</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  species    island bill_len bill_dep flipper_len body_mass    sex year
1  Adelie Torgersen     39.1     18.7         181      3750   male 2007
2  Adelie Torgersen     39.5     17.4         186      3800 female 2007
3  Adelie Torgersen     40.3     18.0         195      3250 female 2007
 [ reached 'max' / getOption("max.print") -- omitted 341 rows ]</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># convert to tibble to improve printing</span></span>
<span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="selecting-columns-with-select" class="level2" data-number="14.2"><h2 data-number="14.2" class="anchored" data-anchor-id="selecting-columns-with-select">
<span class="header-section-number">14.2</span> Selecting columns with <code>select()</code>
</h2>
<p>You can choose which columns of the data frame you want with <code>select()</code>.</p>
<p>The first argument is the data, which is supplied by the pipe <code>|&gt;</code>, the next arguments are the names of the columns you want. The names do not need quote marks.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#select species, bill_len &amp; bill_dep</span></span>
<span><span class="va">penguins</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">species</span>, <span class="va">bill_len</span>, <span class="va">bill_dep</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>select: dropped 5 variables (island, flipper_len, body_mass, sex, year)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 3
  species bill_len bill_dep
  &lt;fct&gt;      &lt;dbl&gt;    &lt;dbl&gt;
1 Adelie      39.1     18.7
2 Adelie      39.5     17.4
3 Adelie      40.3     18  
# ℹ 341 more rows</code></pre>
</div>
</div>
<p>This is equivalent to the base R code</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#select species, bill_len &amp; bill_dep</span></span>
<span><span class="va">penguins</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"bill_len"</span>, <span class="st">"bill_dep"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 3
  species bill_len bill_dep
  &lt;fct&gt;      &lt;dbl&gt;    &lt;dbl&gt;
1 Adelie      39.1     18.7
2 Adelie      39.5     17.4
3 Adelie      40.3     18  
# ℹ 341 more rows</code></pre>
</div>
</div>
<p>Remember that if you want to use the output of this code in a further analysis, you need to assign it to an object name with <code>&lt;-</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the <code>penguins</code> data, select</p>
<ul>
<li><code>species</code></li>
<li>
<code>species</code> and <code>bill_len</code>
</li>
<li>all columns except year</li>
</ul>
<details><summary>
Hint
</summary><div class="cell" data-nolint="true">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(___, ___)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
</div>
</div>
<section id="sec-select-helpers" class="level3" data-number="14.2.1"><h3 data-number="14.2.1" class="anchored" data-anchor-id="sec-select-helpers">
<span class="header-section-number">14.2.1</span> <code>select()</code> helpers</h3>
<p>Sometimes we don’t want to write out the names of all the columns we want to select. We might not even know them all in advance. Fortunately there are some helper functions.</p>
<p>If you want to <code>select()</code> adjacent columns, you can use the notation <code>first:last</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#select species to bill_dep</span></span>
<span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="va">species</span><span class="op">:</span><span class="va">bill_dep</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>select: dropped 4 variables (flipper_len, body_mass, sex, year)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 4
  species island    bill_len bill_dep
  &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;
1 Adelie  Torgersen     39.1     18.7
2 Adelie  Torgersen     39.5     17.4
3 Adelie  Torgersen     40.3     18  
# ℹ 341 more rows</code></pre>
</div>
</div>
<p>Sometimes it is easier to remove the columns you don’t want. You can do this by putting a <code>-</code> in front of the column name.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#select everything but year and sex</span></span>
<span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">year</span>, <span class="op">-</span><span class="va">sex</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>select: dropped 2 variables (sex, year)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 6
  species island    bill_len bill_dep flipper_len body_mass
  &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt;
1 Adelie  Torgersen     39.1     18.7         181      3750
2 Adelie  Torgersen     39.5     17.4         186      3800
3 Adelie  Torgersen     40.3     18           195      3250
# ℹ 341 more rows</code></pre>
</div>
</div>
<p>If there is a pattern to the column names that we want to select (or remove), there are some helper functions. For example, to select columns that start with “bill”, we can use <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with()</a></code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#select bill_len &amp; bill_dep"</span></span>
<span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"bill"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>select: dropped 6 variables (species, island, flipper_len, body_mass, sex, …)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 2
  bill_len bill_dep
     &lt;dbl&gt;    &lt;dbl&gt;
1     39.1     18.7
2     39.5     17.4
3     40.3     18  
# ℹ 341 more rows</code></pre>
</div>
</div>
<p>Conversely, if we want to select all columns that end with “len”, we can use <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">ends_with()</a></code>. <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains()</a></code> is more flexible and <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches()</a></code> is the most powerful of the helper functions, using regular expressions to identify the columns (see the regular expression tutorial).</p>
<p>Sometimes, you might want to select all the columns of a certain type. For example, to select all the numeric columns we can use the <code>is.numeric</code> function inside <code>select()</code> with the helper <code><a href="https://tidyselect.r-lib.org/reference/where.html">where()</a></code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span> <span class="co"># No brackets on the function</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>select: dropped 3 variables (species, island, sex)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 5
  bill_len bill_dep flipper_len body_mass  year
     &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;int&gt;
1     39.1     18.7         181      3750  2007
2     39.5     17.4         186      3800  2007
3     40.3     18           195      3250  2007
# ℹ 341 more rows</code></pre>
</div>
</div>
<p>Other <code>is.*</code> functions exist, for example, <code>is.character</code> for text.</p>
<p>You can also select columns by number (1 being the first column), but this is generally a bad idea because it makes the code difficult to understand and if a new column is added, or the column order is changed, the code will break.</p>
<p>Which of these strategies works best is context dependent.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the <code>penguins</code> data, select</p>
<ul>
<li>all columns except year</li>
<li>all non-numeric columns</li>
<li>
<code>species</code> and columns ending in “len”</li>
</ul>
<details><summary>
Hint
</summary><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hint 1</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>___)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># hint 2</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>?where</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># hint 3</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>?ends_with</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
</div>
</div>
</section></section><section id="renaming-columns-with-rename" class="level2" data-number="14.3"><h2 data-number="14.3" class="anchored" data-anchor-id="renaming-columns-with-rename">
<span class="header-section-number">14.3</span> Renaming columns with <code>rename</code>
</h2>
<p>You can use <code>rename()</code> to rename columns</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">rename</span><span class="op">(</span>Species <span class="op">=</span> <span class="va">species</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>rename: renamed one variable (Species)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 8
  Species island    bill_len bill_dep flipper_len body_mass sex     year
  &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
1 Adelie  Torgersen     39.1     18.7         181      3750 male    2007
2 Adelie  Torgersen     39.5     17.4         186      3800 female  2007
3 Adelie  Torgersen     40.3     18           195      3250 female  2007
# ℹ 341 more rows</code></pre>
</div>
</div>
<p>The syntax is <code>new_name = current_name</code>.</p>
<p>You can also rename a column when selecting. This is convenient if you are using <code>select()</code> anyway.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">select</span><span class="op">(</span>Species <span class="op">=</span> <span class="va">species</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>select: renamed one variable (Species) and dropped 7 variables</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 1
  Species
  &lt;fct&gt;  
1 Adelie 
2 Adelie 
3 Adelie 
# ℹ 341 more rows</code></pre>
</div>
</div>
</section><section id="moving-columns-with-relocate" class="level2" data-number="14.4"><h2 data-number="14.4" class="anchored" data-anchor-id="moving-columns-with-relocate">
<span class="header-section-number">14.4</span> Moving columns with <code>relocate()</code>
</h2>
<p>Sometimes it is useful to reorder the columns. This is never necessary for data analysis or plotting, but can be needed when making a table for presentation.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">relocate</span><span class="op">(</span><span class="va">island</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>relocate: columns reordered (island, species, bill_len, bill_dep, flipper_len,
…)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 8
  island    species bill_len bill_dep flipper_len body_mass sex     year
  &lt;fct&gt;     &lt;fct&gt;      &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
1 Torgersen Adelie      39.1     18.7         181      3750 male    2007
2 Torgersen Adelie      39.5     17.4         186      3800 female  2007
3 Torgersen Adelie      40.3     18           195      3250 female  2007
# ℹ 341 more rows</code></pre>
</div>
</div>
<p>The default is to move the named column first, the <code>.before</code> and <code>.after</code> arguments let you move the column into any position.</p>
</section><section id="filtering-rows-with-filter" class="level2" data-number="14.5"><h2 data-number="14.5" class="anchored" data-anchor-id="filtering-rows-with-filter">
<span class="header-section-number">14.5</span> Filtering rows with <code>filter()</code>
</h2>
<p>Filtering rows that meet some condition is a very common task.</p>
<p>For example, to filter rows of <code>penguins</code> that have a bill length greater than 40 mm, we can use</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">filter</span><span class="op">(</span><span class="va">bill_len</span> <span class="op">&gt;</span> <span class="fl">40</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>filter: removed 102 rows (30%), 242 rows remaining</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 242 × 8
  species island    bill_len bill_dep flipper_len body_mass sex     year
  &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
1 Adelie  Torgersen     40.3     18           195      3250 female  2007
2 Adelie  Torgersen     42       20.2         190      4250 &lt;NA&gt;    2007
3 Adelie  Torgersen     41.1     17.6         182      3200 female  2007
# ℹ 239 more rows</code></pre>
</div>
</div>
<p>This will filter out each row where the condition is <code>TRUE</code>.</p>
<p>The base R equivalent of this is</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span><span class="op">[</span><span class="va">penguins</span><span class="op">$</span><span class="va">bill_len</span> <span class="op">&gt;</span> <span class="fl">40</span>, <span class="op">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 244 × 8
  species island    bill_len bill_dep flipper_len body_mass sex     year
  &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
1 Adelie  Torgersen     40.3     18           195      3250 female  2007
2 &lt;NA&gt;    &lt;NA&gt;          NA       NA            NA        NA &lt;NA&gt;      NA
3 Adelie  Torgersen     42       20.2         190      4250 &lt;NA&gt;    2007
# ℹ 241 more rows</code></pre>
</div>
</div>
<p>Generally, <code>filter</code> makes it easier to understand, especially with more complex criteria.</p>
<p>Other tests include</p>
<ul>
<li>
<code>==</code> exactly equals. Often a bad idea to use with numeric data</li>
<li>
<code>near</code> safe function for testing equality of numeric data as it has a tolerance for rounding errors.</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">==</span> <span class="fl">2</span> <span class="co"># should be true, but rounding errors</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">-</span> <span class="fl">2</span> <span class="co"># the difference</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.440892e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/near.html">near</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># safe alternative</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<ul>
<li>
<code>!=</code> not equal to</li>
<li>
<code>&lt;</code> less than</li>
<li>
<code>&lt;=</code> less than or equal to</li>
<li>
<code>&gt;</code> greater than</li>
<li>
<code>&gt;=</code> greater than or equal to</li>
<li>
<code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code> for filtering by missing values.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/between.html">between()</a></code> for filtering values with a range</li>
<li>
<code>%in%</code> is used when you want to test if a value is in a vector</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Adelie"</span>, <span class="st">"Chinstrap"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>filter: removed 124 rows (36%), 220 rows remaining</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 220 × 8
  species island    bill_len bill_dep flipper_len body_mass sex     year
  &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
1 Adelie  Torgersen     39.1     18.7         181      3750 male    2007
2 Adelie  Torgersen     39.5     17.4         186      3800 female  2007
3 Adelie  Torgersen     40.3     18           195      3250 female  2007
# ℹ 217 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#equivalent to</span></span>
<span><span class="va">penguins</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Adelie"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Chinstrap"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>filter: removed 124 rows (36%), 220 rows remaining</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 220 × 8
  species island    bill_len bill_dep flipper_len body_mass sex     year
  &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
1 Adelie  Torgersen     39.1     18.7         181      3750 male    2007
2 Adelie  Torgersen     39.5     17.4         186      3800 female  2007
3 Adelie  Torgersen     40.3     18           195      3250 female  2007
# ℹ 217 more rows</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="co"># with many alternatives, this gets very long</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="filtering-on-multiple-criteria" class="level3" data-number="14.5.1"><h3 data-number="14.5.1" class="anchored" data-anchor-id="filtering-on-multiple-criteria">
<span class="header-section-number">14.5.1</span> Filtering on multiple criteria</h3>
<p>If we want to filter on multiple criteria, we need to decide whether we want all criteria to be <code>TRUE</code> (AND in Boolean logic), or for one or more to be <code>TRUE</code> (OR in Boolean logic).</p>
<p>If we want all criteria to be <code>TRUE</code>, we can separate them by a comma (or by an <code>&amp;</code> if you want to be explicit).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">bill_len</span> <span class="op">&gt;</span> <span class="fl">40</span>, <span class="va">bill_dep</span> <span class="op">&gt;</span> <span class="fl">18</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>filter: removed 263 rows (76%), 81 rows remaining</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 81 × 8
  species island    bill_len bill_dep flipper_len body_mass sex    year
  &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt; &lt;int&gt;
1 Adelie  Torgersen     42       20.2         190      4250 &lt;NA&gt;   2007
2 Adelie  Torgersen     42.5     20.7         197      4500 male   2007
3 Adelie  Torgersen     46       21.5         194      4200 male   2007
# ℹ 78 more rows</code></pre>
</div>
</div>
<p>If we want rows where any of the criteria is <code>TRUE</code>, we can separate them by a <code>|</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">bill_len</span> <span class="op">&gt;</span> <span class="fl">40</span> <span class="op">|</span> <span class="va">bill_dep</span> <span class="op">&gt;</span> <span class="fl">18</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>filter: removed 53 rows (15%), 291 rows remaining</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 291 × 8
  species island    bill_len bill_dep flipper_len body_mass sex     year
  &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
1 Adelie  Torgersen     39.1     18.7         181      3750 male    2007
2 Adelie  Torgersen     40.3     18           195      3250 female  2007
3 Adelie  Torgersen     36.7     19.3         193      3450 female  2007
# ℹ 288 more rows</code></pre>
</div>
</div>
<p>We can negate a criterion by putting <code>!</code> in front of it. So to filter rows that do not have bills longer than 40 mm we can use</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="va">bill_len</span> <span class="op">&gt;</span> <span class="fl">40</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>filter: removed 244 rows (71%), 100 rows remaining</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 8
  species island    bill_len bill_dep flipper_len body_mass sex     year
  &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
1 Adelie  Torgersen     39.1     18.7         181      3750 male    2007
2 Adelie  Torgersen     39.5     17.4         186      3800 female  2007
3 Adelie  Torgersen     36.7     19.3         193      3450 female  2007
# ℹ 97 more rows</code></pre>
</div>
</div>
<p>Of course, in this example, we could also use <code>&lt;=</code> as the test.</p>
</section><section id="common-errors" class="level3" data-number="14.5.2"><h3 data-number="14.5.2" class="anchored" data-anchor-id="common-errors">
<span class="header-section-number">14.5.2</span> Common errors</h3>
<p>The commonest error is to use a single <code>=</code> rather than <code>==</code>. Only the latter is a test of equality. If you do this, the error message is quite helpful.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">filter</span><span class="op">(</span>species <span class="op">=</span> <span class="st">"Chinstrap"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `.fun()` at tidylog/R/filter.R:99:5:
! We detected a named input.
ℹ This usually means that you've used `=` instead of `==`.
ℹ Did you mean `species == "Chinstrap"`?</code></pre>
</div>
</div>
<p>Another common error is to forget to quote any strings.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">filter</span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="va">Chinstrap</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `.fun()` at tidylog/R/filter.R:99:5:
ℹ In argument: `species == Chinstrap`.
Caused by error:
! object 'Chinstrap' not found</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the <code>penguins</code> data, filter</p>
<ul>
<li>Gentoo penguins</li>
<li>Gentoo or Adelie penguins</li>
<li>penguins with a mass greater than or equal to 5000g</li>
<li>penguins with a bill length between 45 and 50 mm</li>
<li>Gentoo penguins not from from Dream Island</li>
</ul>
<details><summary>
Hint
</summary><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#hint 1</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="at">___ =</span> ___)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co">#hint 2</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>?<span class="st">`</span><span class="at">%in%</span><span class="st">`</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co">#hint 3</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">filter</span>(___ <span class="sc">&gt;=</span> ___)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co">#hint 4</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>?between</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co">#hint 5</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>?<span class="st">`</span><span class="at">!</span><span class="st">`</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
</div>
</div>
</section></section><section id="slicing-the-data-with-slice" class="level2" data-number="14.6"><h2 data-number="14.6" class="anchored" data-anchor-id="slicing-the-data-with-slice">
<span class="header-section-number">14.6</span> Slicing the data with <code>slice()</code>
</h2>
<p>Sometimes it is useful to extract rows by row number.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">slice</span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>slice: removed 339 rows (99%), 5 rows remaining</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 8
  species island    bill_len bill_dep flipper_len body_mass sex     year
  &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
1 Adelie  Torgersen     40.3     18           195      3250 female  2007
2 Adelie  Torgersen     NA       NA            NA        NA &lt;NA&gt;    2007
3 Adelie  Torgersen     36.7     19.3         193      3450 female  2007
4 Adelie  Torgersen     39.3     20.6         190      3650 male    2007
5 Adelie  Torgersen     38.9     17.8         181      3625 female  2007</code></pre>
</div>
</div>
<p>You can use negative numbers to remove rows. Be careful using <code>slice()</code> as if the data change, different rows may be returned.</p>
</section><section id="distinct-rows-with-distinct" class="level2" data-number="14.7"><h2 data-number="14.7" class="anchored" data-anchor-id="distinct-rows-with-distinct">
<span class="header-section-number">14.7</span> Distinct rows with <code>distinct()</code>
</h2>
<p>If there are duplicates in the data, we can remove these with <code>distinct()</code>. <code>distinct()</code> with no extra arguments will remove duplicate rows.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">distinct</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>distinct: no rows removed</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 8
  species island    bill_len bill_dep flipper_len body_mass sex     year
  &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
1 Adelie  Torgersen     39.1     18.7         181      3750 male    2007
2 Adelie  Torgersen     39.5     17.4         186      3800 female  2007
3 Adelie  Torgersen     40.3     18           195      3250 female  2007
# ℹ 341 more rows</code></pre>
</div>
</div>
<p>If we are only interested in some of the columns, we can supply the names of these columns.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">distinct</span><span class="op">(</span><span class="va">island</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>distinct: removed 341 rows (99%), 3 rows remaining</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 1
  island   
  &lt;fct&gt;    
1 Torgersen
2 Biscoe   
3 Dream    </code></pre>
</div>
</div>
<p>Other columns will be removed unless the argument <code>.keep_all = TRUE</code> is used.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the <code>penguins</code> data, find distinct values of</p>
<ul>
<li>species</li>
<li>species, island and sex</li>
</ul>
<details><summary>
Hint
</summary><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">distinct</span>(___, ___)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
</div>
</div>
</section><section id="random-rows" class="level2" data-number="14.8"><h2 data-number="14.8" class="anchored" data-anchor-id="random-rows">
<span class="header-section-number">14.8</span> Random rows</h2>
<p>Sometimes you want to sample rows at random from a data.frame. This can be done with <code>slice_sample()</code>. This can either sample a constant <em>n</em> rows or constant fraction of the rows depending on whether the <code>n</code> or <code>prop</code> argument is used.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">slice_sample</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>slice_sample: removed 334 rows (97%), 10 rows remaining</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 8
   species   island    bill_len bill_dep flipper_len body_mass sex     year
   &lt;fct&gt;     &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
 1 Chinstrap Dream         51.5     18.7         187      3250 male    2009
 2 Adelie    Torgersen     38.8     17.6         191      3275 female  2009
 3 Chinstrap Dream         51.3     19.9         198      3700 male    2007
 4 Gentoo    Biscoe        46.5     14.4         217      4900 female  2008
 5 Gentoo    Biscoe        48.7     15.1         222      5350 male    2007
 6 Adelie    Torgersen     36.7     18.8         187      3800 female  2008
 7 Gentoo    Biscoe        47.7     15           216      4750 female  2008
 8 Adelie    Dream         39.8     19.1         184      4650 male    2007
 9 Adelie    Dream         43.2     18.5         192      4100 male    2008
10 Chinstrap Dream         46.1     18.2         178      3250 female  2007</code></pre>
</div>
</div>
</section><section id="mutating-and-adding-columns-with-mutate" class="level2" data-number="14.9"><h2 data-number="14.9" class="anchored" data-anchor-id="mutating-and-adding-columns-with-mutate">
<span class="header-section-number">14.9</span> Mutating and adding columns with <code>mutate</code>
</h2>
<p>The function <code>mutate()</code> can add an new column or replace an existing one.</p>
<p>To make a new column called <code>body_mass_kg</code> we can use</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>body_mass_kg <span class="op">=</span> <span class="va">body_mass</span> <span class="op">/</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>mutate: new variable 'body_mass_kg' (double) with 95 unique values and 1% NA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 9
  species island    bill_len bill_dep flipper_len body_mass sex     year
  &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
1 Adelie  Torgersen     39.1     18.7         181      3750 male    2007
2 Adelie  Torgersen     39.5     17.4         186      3800 female  2007
3 Adelie  Torgersen     40.3     18           195      3250 female  2007
# ℹ 341 more rows
# ℹ 1 more variable: body_mass_kg &lt;dbl&gt;</code></pre>
</div>
</div>
<p>There are lots of functions that are useful to use with mutate. Any function that returns either a single value or as many values as are in the data can be used.</p>
<p><code>mutate()</code> is very useful when cleaning data.</p>
<ul>
<li>See text manipulation tutorial for cleaning text with the <code>stringr</code> package.</li>
<li>See date and time tutorial for cleaning dates and times with the <code>lubridate</code> package.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>With the <code>penguins</code> data,</p>
<ul>
<li>convert flipper length to cm</li>
<li>add a column with the ratio of bill width to length</li>
</ul>
<details><summary>
Hint
</summary><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hint 1</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">___ =</span> ___)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
</div>
</div>
</section><section id="summarising-data-with-summarise" class="level2" data-number="14.10"><h2 data-number="14.10" class="anchored" data-anchor-id="summarising-data-with-summarise">
<span class="header-section-number">14.10</span> Summarising data with <code>summarise()</code>
</h2>
<p><code>summarise()</code> lets us summarise data. We can use it if we want to calculate a summary statistic of the data. Remember to separate arguments with a comma.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu">summarise</span><span class="op">(</span></span>
<span>  flipper_len_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">flipper_len</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  flipper_len_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">flipper_len</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>summarise: now one row and 2 columns, ungrouped</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  flipper_len_mean flipper_len_sd
             &lt;dbl&gt;          &lt;dbl&gt;
1             201.           14.1</code></pre>
</div>
</div>
<p>Only the columns created in the <code>summarise()</code> and any grouping columns (see below) will be kept.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>With the <code>penguins</code> data, find</p>
<ul>
<li>the maximum and minimum bill length</li>
</ul>
<details><summary>
Hint
</summary><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">___ =</span> <span class="fu">___</span>(___))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
</div>
</div>
<section id="summarising-multiple-columns" class="level3" data-number="14.10.1"><h3 data-number="14.10.1" class="anchored" data-anchor-id="summarising-multiple-columns">
<span class="header-section-number">14.10.1</span> Summarising multiple columns</h3>
<p>Sometimes you want to summarise multiple columns at the same time. This can be done with the <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code> helper function. <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code> needs to be told which columns to process and what function or functions to use.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span></span>
<span>   <span class="fu">summarise</span><span class="op">(</span></span>
<span>     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bill_len</span>, <span class="va">bill_dep</span><span class="op">)</span>,</span>
<span>            .fns <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>summarise: now one row and 2 columns, ungrouped</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  bill_len bill_dep
     &lt;dbl&gt;    &lt;dbl&gt;
1     43.9     17.2</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#using a list of functions</span></span>
<span><span class="va">penguins</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"bill"</span><span class="op">)</span>,</span>
<span>           .fns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>sd <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                       mean <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>summarise: now one row and 4 columns, ungrouped</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  bill_len_sd bill_len_mean bill_dep_sd bill_dep_mean
        &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;
1        5.46          43.9        1.97          17.2</code></pre>
</div>
</div>
<p>You can also use <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code> with <code>mutate()</code> to mutate several columns at the same time.</p>
</section></section><section id="grouping-data-with-group_by" class="level2" data-number="14.11"><h2 data-number="14.11" class="anchored" data-anchor-id="grouping-data-with-group_by">
<span class="header-section-number">14.11</span> Grouping data with <code>group_by</code>
</h2>
<p><code>group_by()</code> changes the way that many of the <code>dplyr</code> functions work. Instead of working on the entire dataset, they now work on each group in the data</p>
<p>To find the mean flipper length for each species, we need to <code>group_by()</code> species and then <code>summarise()</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean_flipper_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">flipper_len</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>group_by: one grouping variable (species)
summarise: now 3 rows and 2 columns, ungrouped</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  species   mean_flipper_length
  &lt;fct&gt;                   &lt;dbl&gt;
1 Adelie                    NA 
2 Chinstrap                196.
3 Gentoo                    NA </code></pre>
</div>
</div>
<p>Grouped data can be ungrouped with <code>ungroup()</code>. This can help prevent surprises!</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>With the <code>penguins</code> data, find</p>
<ul>
<li>the maximum and minimum bill depth of each species</li>
</ul>
<details><summary>
Hint
</summary><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(___)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">___ =</span>  <span class="fu">___</span>(___))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
</div>
</div>
</section><section id="sorting-with-arrange" class="level2" data-number="14.12"><h2 data-number="14.12" class="anchored" data-anchor-id="sorting-with-arrange">
<span class="header-section-number">14.12</span> Sorting with <code>arrange()</code>
</h2>
<p>To sort the data frame by one or more of the variables we can use <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">bill_len</span>, <span class="va">bill_dep</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 8
  species island    bill_len bill_dep flipper_len body_mass sex     year
  &lt;fct&gt;   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
1 Adelie  Dream         32.1     15.5         188      3050 female  2009
2 Adelie  Dream         33.1     16.1         178      2900 female  2008
3 Adelie  Torgersen     33.5     19           190      3600 female  2008
# ℹ 341 more rows</code></pre>
</div>
</div>
<p>This will sort smallest first. To reverse the sort order, use <code><a href="https://dplyr.tidyverse.org/reference/desc.html">desc()</a></code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">bill_len</span><span class="op">)</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">bill_dep</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 8
  species   island bill_len bill_dep flipper_len body_mass sex     year
  &lt;fct&gt;     &lt;fct&gt;     &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;     &lt;int&gt; &lt;fct&gt;  &lt;int&gt;
1 Gentoo    Biscoe     59.6     17           230      6050 male    2007
2 Chinstrap Dream      58       17.8         181      3700 female  2007
3 Gentoo    Biscoe     55.9     17           228      5600 male    2009
# ℹ 341 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sort the <code>penguins</code> data by</p>
<ul>
<li>body mass</li>
<li>island and body mass, with the largest birds first</li>
</ul>
<details><summary>
Hint
</summary><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hint 1</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(___, ___)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="co"># hint 2</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>?desc</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
</div>
</div>
</section><section id="counting-rows-with-count-and-n" class="level2" data-number="14.13"><h2 data-number="14.13" class="anchored" data-anchor-id="counting-rows-with-count-and-n">
<span class="header-section-number">14.13</span> Counting rows with <code>count()</code> and <code>n()</code>
</h2>
<p>The function <code>n</code> can count how many rows there are in the each group (or the entire data frame if it is not grouped). It can be used with either <code>mutate()</code> or <code>summarise()</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>group_by: one grouping variable (species)
summarise: now 3 rows and 2 columns, ungrouped</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  species       n
  &lt;fct&gt;     &lt;int&gt;
1 Adelie      152
2 Chinstrap    68
3 Gentoo      124</code></pre>
</div>
</div>
<p>Or with <code>count()</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">species</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>count: now 3 rows and 2 columns, ungrouped</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  species       n
  &lt;fct&gt;     &lt;int&gt;
1 Adelie      152
2 Chinstrap    68
3 Gentoo      124</code></pre>
</div>
</div>
<p><code>count()</code> is more concise, but <code>group_by()</code> and <code>summarise()</code> is useful when you need to calculate more variables (for example mean and standard deviation).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the <code>penguins</code> data, find</p>
<ul>
<li>how many penguins are there of each species</li>
<li>how many penguins are there of each species in each island</li>
</ul>
<details><summary>
Hint
</summary><div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(___, ___)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(___) <span class="sc">|&gt;</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">___ =</span> <span class="fu">n</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</details>
</div>
</div>
</section><section id="common-problems" class="level2 page-columns page-full" data-number="14.14"><h2 data-number="14.14" class="anchored" data-anchor-id="common-problems">
<span class="header-section-number">14.14</span> Common problems</h2>
<section id="non-standard-names" class="level3" data-number="14.14.1"><h3 data-number="14.14.1" class="anchored" data-anchor-id="non-standard-names">
<span class="header-section-number">14.14.1</span> Non standard names</h3>
<p>Ideally column names should follow the standard rules for naming objects in R - UPPER and lower case letters, numbers, “.” and “_” with the first character being a letter (or a dot if you want an invisible object). Sometimes when you import data, it has non-standard names with spaces or extra characters. If you need to refer to a column name that doesn’t follow the rules, you need to enclose it with back-ticks.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>`Region/Country` <span class="op">=</span> <span class="st">"Norway"</span>, value <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  `Region/Country` value
  &lt;chr&gt;            &lt;dbl&gt;
1 Norway              42</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu">rename</span><span class="op">(</span>region_country <span class="op">=</span> <span class="va">`Region/Country`</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>rename: renamed one variable (region_country)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  region_country value
  &lt;chr&gt;          &lt;dbl&gt;
1 Norway            42</code></pre>
</div>
</div>
<p>It is sometimes best to rename these columns to make them easier to refer to. <code><a href="https://sfirke.github.io/janitor/reference/clean_names.html">janitor::clean_names()</a></code> is very efficient for making easy-to-use names.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Further reading
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://stat545.com/dplyr-intro.html">stat545</a></li>
<li><a href="https://r4ds.hadley.nz/">R for data science</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf"><code>dplyr</code> cheatsheet</a></li>
</ul>
</div>
</div>
</section>

<!-- -->

<div class="no-row-height column-margin column-container"><section id="contributors" class="level3 unlisted unnumbered"><h3 class="unlisted unnumbered anchored" data-anchor-id="contributors">Contributors</h3>
<ul>
<li>Richard Telford</li>
</ul></section></div></section></main><!-- /main --><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./011-tidyr-pivot.html" class="pagination-link" aria-label="Tidying data with `tidyr`">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Tidying data with <code>tidyr</code></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./013-dplyr-multiple-tables.html" class="pagination-link" aria-label="Working with multiple tables in `dplyr`">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Working with multiple tables in <code>dplyr</code></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb115" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/setup.R"</span>)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(penguins)<span class="co"># revert to original dataframe</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu"># Working with single tables in `dplyr` {#sec-working-with-single-tables-in-dplyr}</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>Data frames are usually the most convenient objects for storing, plotting or analysing data in R.</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>We also need to be able to manipulate data in data frames.</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>This tutorial will show you how to manipulate data frames using the <span class="in">`dplyr`</span> package, part of <span class="in">`tidyverse`</span>.</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>Everything that can be done with <span class="in">`dplyr`</span> can be done with base R.</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>The <span class="in">`dplyr`</span> solution is usually easier to write and understand, and can be faster.</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>There are many function in <span class="in">`dplyr`</span>, this tutorial focuses on the functions we find most useful.</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a><span class="fu">### Load the package</span></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>You can load <span class="in">`dplyr`</span> with</span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load-dplyr}</span></span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a>But is is usually more convenient to load <span class="in">`tidyverse`</span> so that you get <span class="in">`ggplot2`</span>, <span class="in">`dplyr`</span>, <span class="in">`readr`</span> and other useful packages with one command.</span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load-packages, eval = FALSE}</span></span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a><span class="fu">### More feedback `tidylog`</span></span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>We can get more feedback on what <span class="in">`dplyr`</span> functions have done to the data by loading the <span class="in">`tidylog`</span> package.</span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{r tidylog, echo = TRUE, message = FALSE}</span></span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidylog"</span>)</span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a>More than once, <span class="in">`tidylog`</span> has helped identified bugs in my code.</span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a><span class="fu">## The `penguins` dataset</span></span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-44"><a href="#cb115-44" aria-hidden="true" tabindex="-1"></a>This tutorial will use the <span class="in">`penguins`</span> dataset that is included with R.</span>
<span id="cb115-45"><a href="#cb115-45" aria-hidden="true" tabindex="-1"></a>The <span class="in">`penguins`</span> dataset contains morphological data on three species of penguin. </span>
<span id="cb115-46"><a href="#cb115-46" aria-hidden="true" tabindex="-1"></a>You will meet this dataset repeatedly as it provides a convenient set of variables and observations well-suited for illustrating many purposes.</span>
<span id="cb115-47"><a href="#cb115-47" aria-hidden="true" tabindex="-1"></a>To improve printing, we've converted the <span class="in">`penguins`</span> data.frame into a tibble.</span>
<span id="cb115-48"><a href="#cb115-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-49"><a href="#cb115-49" aria-hidden="true" tabindex="-1"></a><span class="in">```{r penguins}</span></span>
<span id="cb115-50"><a href="#cb115-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the data</span></span>
<span id="cb115-51"><a href="#cb115-51" aria-hidden="true" tabindex="-1"></a>penguins</span>
<span id="cb115-52"><a href="#cb115-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-53"><a href="#cb115-53" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to tibble to improve printing</span></span>
<span id="cb115-54"><a href="#cb115-54" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(penguins)</span>
<span id="cb115-55"><a href="#cb115-55" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-56"><a href="#cb115-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-57"><a href="#cb115-57" aria-hidden="true" tabindex="-1"></a><span class="fu">## Selecting columns with `select()`</span></span>
<span id="cb115-58"><a href="#cb115-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-59"><a href="#cb115-59" aria-hidden="true" tabindex="-1"></a>You can choose which columns of the data frame you want with <span class="in">`select()`</span>.</span>
<span id="cb115-60"><a href="#cb115-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-61"><a href="#cb115-61" aria-hidden="true" tabindex="-1"></a>The first argument is the data, which is supplied by the pipe <span class="in">`|&gt;`</span>, the next arguments are the names of the columns you want.</span>
<span id="cb115-62"><a href="#cb115-62" aria-hidden="true" tabindex="-1"></a>The names do not need quote marks.</span>
<span id="cb115-63"><a href="#cb115-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-64"><a href="#cb115-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{r select1}</span></span>
<span id="cb115-65"><a href="#cb115-65" aria-hidden="true" tabindex="-1"></a><span class="co">#select species, bill_len &amp; bill_dep</span></span>
<span id="cb115-66"><a href="#cb115-66" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-67"><a href="#cb115-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(species, bill_len, bill_dep)</span>
<span id="cb115-68"><a href="#cb115-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-69"><a href="#cb115-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-70"><a href="#cb115-70" aria-hidden="true" tabindex="-1"></a>This is equivalent to the base R code</span>
<span id="cb115-71"><a href="#cb115-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-72"><a href="#cb115-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r select1.5}</span></span>
<span id="cb115-73"><a href="#cb115-73" aria-hidden="true" tabindex="-1"></a><span class="co">#select species, bill_len &amp; bill_dep</span></span>
<span id="cb115-74"><a href="#cb115-74" aria-hidden="true" tabindex="-1"></a>penguins[, <span class="fu">c</span>(<span class="st">"species"</span>, <span class="st">"bill_len"</span>, <span class="st">"bill_dep"</span>)]</span>
<span id="cb115-75"><a href="#cb115-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-76"><a href="#cb115-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-77"><a href="#cb115-77" aria-hidden="true" tabindex="-1"></a>Remember that if you want to use the output of this code in a further analysis, you need to assign it to an object name with <span class="in">`&lt;-`</span>.</span>
<span id="cb115-78"><a href="#cb115-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-79"><a href="#cb115-79" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb115-80"><a href="#cb115-80" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise</span></span>
<span id="cb115-81"><a href="#cb115-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-82"><a href="#cb115-82" aria-hidden="true" tabindex="-1"></a>From the <span class="in">`penguins`</span> data, select</span>
<span id="cb115-83"><a href="#cb115-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-84"><a href="#cb115-84" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`species`</span></span>
<span id="cb115-85"><a href="#cb115-85" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`species`</span> and <span class="in">`bill_len`</span></span>
<span id="cb115-86"><a href="#cb115-86" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>all columns except year</span>
<span id="cb115-87"><a href="#cb115-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-88"><a href="#cb115-88" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-89"><a href="#cb115-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-90"><a href="#cb115-90" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Hint<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb115-91"><a href="#cb115-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-94"><a href="#cb115-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-95"><a href="#cb115-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: hint-1</span></span>
<span id="cb115-96"><a href="#cb115-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb115-97"><a href="#cb115-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| tidy: false</span></span>
<span id="cb115-98"><a href="#cb115-98" aria-hidden="true" tabindex="-1"></a><span class="co">#| nolint: true</span></span>
<span id="cb115-99"><a href="#cb115-99" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-100"><a href="#cb115-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(___, ___)</span>
<span id="cb115-101"><a href="#cb115-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-102"><a href="#cb115-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-103"><a href="#cb115-103" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-104"><a href="#cb115-104" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-105"><a href="#cb115-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-106"><a href="#cb115-106" aria-hidden="true" tabindex="-1"></a><span class="fu">### `select()` helpers {#sec-select-helpers}</span></span>
<span id="cb115-107"><a href="#cb115-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-108"><a href="#cb115-108" aria-hidden="true" tabindex="-1"></a>Sometimes we don't want to write out the names of all the columns we want to select.</span>
<span id="cb115-109"><a href="#cb115-109" aria-hidden="true" tabindex="-1"></a>We might not even know them all in advance.</span>
<span id="cb115-110"><a href="#cb115-110" aria-hidden="true" tabindex="-1"></a>Fortunately there are some helper functions.</span>
<span id="cb115-111"><a href="#cb115-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-112"><a href="#cb115-112" aria-hidden="true" tabindex="-1"></a>If you want to <span class="in">`select()`</span> adjacent columns, you can use the notation <span class="in">`first:last`</span>.</span>
<span id="cb115-113"><a href="#cb115-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-114"><a href="#cb115-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r select2}</span></span>
<span id="cb115-115"><a href="#cb115-115" aria-hidden="true" tabindex="-1"></a><span class="co">#select species to bill_dep</span></span>
<span id="cb115-116"><a href="#cb115-116" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">select</span>(species<span class="sc">:</span>bill_dep)</span>
<span id="cb115-117"><a href="#cb115-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-118"><a href="#cb115-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-119"><a href="#cb115-119" aria-hidden="true" tabindex="-1"></a>Sometimes it is easier to remove the columns you don't want.</span>
<span id="cb115-120"><a href="#cb115-120" aria-hidden="true" tabindex="-1"></a>You can do this by putting a <span class="in">`-`</span> in front of the column name.</span>
<span id="cb115-121"><a href="#cb115-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-122"><a href="#cb115-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r select3}</span></span>
<span id="cb115-123"><a href="#cb115-123" aria-hidden="true" tabindex="-1"></a><span class="co">#select everything but year and sex</span></span>
<span id="cb115-124"><a href="#cb115-124" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>year, <span class="sc">-</span>sex)</span>
<span id="cb115-125"><a href="#cb115-125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-126"><a href="#cb115-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-127"><a href="#cb115-127" aria-hidden="true" tabindex="-1"></a>If there is a pattern to the column names that we want to select (or remove), there are some helper functions.</span>
<span id="cb115-128"><a href="#cb115-128" aria-hidden="true" tabindex="-1"></a>For example, to select columns that start with "bill", we can use <span class="in">`starts_with()`</span>.</span>
<span id="cb115-129"><a href="#cb115-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-130"><a href="#cb115-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r select4}</span></span>
<span id="cb115-131"><a href="#cb115-131" aria-hidden="true" tabindex="-1"></a><span class="co">#select bill_len &amp; bill_dep"</span></span>
<span id="cb115-132"><a href="#cb115-132" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"bill"</span>))</span>
<span id="cb115-133"><a href="#cb115-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-134"><a href="#cb115-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-135"><a href="#cb115-135" aria-hidden="true" tabindex="-1"></a>Conversely, if we want to select all columns that end with "len", we can use <span class="in">`ends_with()`</span>.</span>
<span id="cb115-136"><a href="#cb115-136" aria-hidden="true" tabindex="-1"></a><span class="in">`contains()`</span> is more flexible and <span class="in">`matches()`</span> is the most powerful of the helper functions, using regular expressions to identify the columns (see the regular expression tutorial).</span>
<span id="cb115-137"><a href="#cb115-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-138"><a href="#cb115-138" aria-hidden="true" tabindex="-1"></a>Sometimes, you might want to select all the columns of a certain type.</span>
<span id="cb115-139"><a href="#cb115-139" aria-hidden="true" tabindex="-1"></a>For example, to select all the numeric columns we can use the <span class="in">`is.numeric`</span> function inside <span class="in">`select()`</span> with the helper <span class="in">`where()`</span>.</span>
<span id="cb115-140"><a href="#cb115-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-141"><a href="#cb115-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r select5}</span></span>
<span id="cb115-142"><a href="#cb115-142" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="co"># No brackets on the function</span></span>
<span id="cb115-143"><a href="#cb115-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-144"><a href="#cb115-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-145"><a href="#cb115-145" aria-hidden="true" tabindex="-1"></a>Other <span class="in">`is.*`</span> functions exist, for example, <span class="in">`is.character`</span> for text.</span>
<span id="cb115-146"><a href="#cb115-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-147"><a href="#cb115-147" aria-hidden="true" tabindex="-1"></a>You can also select columns by number (1 being the first column), but this is generally a bad idea because it makes the code difficult to understand and if a new column is added, or the column order is changed, the code will break.</span>
<span id="cb115-148"><a href="#cb115-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-149"><a href="#cb115-149" aria-hidden="true" tabindex="-1"></a>Which of these strategies works best is context dependent.</span>
<span id="cb115-150"><a href="#cb115-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-151"><a href="#cb115-151" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb115-152"><a href="#cb115-152" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise</span></span>
<span id="cb115-153"><a href="#cb115-153" aria-hidden="true" tabindex="-1"></a>From the <span class="in">`penguins`</span> data, select</span>
<span id="cb115-154"><a href="#cb115-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-155"><a href="#cb115-155" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>all columns except year</span>
<span id="cb115-156"><a href="#cb115-156" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>all non-numeric columns</span>
<span id="cb115-157"><a href="#cb115-157" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`species`</span> and columns ending in "len"</span>
<span id="cb115-158"><a href="#cb115-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-159"><a href="#cb115-159" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-160"><a href="#cb115-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-161"><a href="#cb115-161" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Hint<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb115-162"><a href="#cb115-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-165"><a href="#cb115-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-166"><a href="#cb115-166" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: hint-2</span></span>
<span id="cb115-167"><a href="#cb115-167" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb115-168"><a href="#cb115-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| tidy: false</span></span>
<span id="cb115-169"><a href="#cb115-169" aria-hidden="true" tabindex="-1"></a><span class="co"># hint 1</span></span>
<span id="cb115-170"><a href="#cb115-170" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-171"><a href="#cb115-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>___)</span>
<span id="cb115-172"><a href="#cb115-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-173"><a href="#cb115-173" aria-hidden="true" tabindex="-1"></a><span class="co"># hint 2</span></span>
<span id="cb115-174"><a href="#cb115-174" aria-hidden="true" tabindex="-1"></a>?where</span>
<span id="cb115-175"><a href="#cb115-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-176"><a href="#cb115-176" aria-hidden="true" tabindex="-1"></a><span class="co"># hint 3</span></span>
<span id="cb115-177"><a href="#cb115-177" aria-hidden="true" tabindex="-1"></a>?ends_with</span>
<span id="cb115-178"><a href="#cb115-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-179"><a href="#cb115-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-180"><a href="#cb115-180" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-181"><a href="#cb115-181" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-182"><a href="#cb115-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-183"><a href="#cb115-183" aria-hidden="true" tabindex="-1"></a><span class="fu">## Renaming columns with `rename`</span></span>
<span id="cb115-184"><a href="#cb115-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-185"><a href="#cb115-185" aria-hidden="true" tabindex="-1"></a>You can use <span class="in">`rename()`</span> to rename columns</span>
<span id="cb115-186"><a href="#cb115-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-187"><a href="#cb115-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rename1}</span></span>
<span id="cb115-188"><a href="#cb115-188" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">Species =</span> species)</span>
<span id="cb115-189"><a href="#cb115-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-190"><a href="#cb115-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-191"><a href="#cb115-191" aria-hidden="true" tabindex="-1"></a>The syntax is <span class="in">`new_name = current_name`</span>.</span>
<span id="cb115-192"><a href="#cb115-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-193"><a href="#cb115-193" aria-hidden="true" tabindex="-1"></a>You can also rename a column when selecting.</span>
<span id="cb115-194"><a href="#cb115-194" aria-hidden="true" tabindex="-1"></a>This is convenient if you are using <span class="in">`select()`</span> anyway.</span>
<span id="cb115-195"><a href="#cb115-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-196"><a href="#cb115-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rename2}</span></span>
<span id="cb115-197"><a href="#cb115-197" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="at">Species =</span> species)</span>
<span id="cb115-198"><a href="#cb115-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-199"><a href="#cb115-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-200"><a href="#cb115-200" aria-hidden="true" tabindex="-1"></a><span class="fu">## Moving columns with `relocate()`</span></span>
<span id="cb115-201"><a href="#cb115-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-202"><a href="#cb115-202" aria-hidden="true" tabindex="-1"></a>Sometimes it is useful to reorder the columns.</span>
<span id="cb115-203"><a href="#cb115-203" aria-hidden="true" tabindex="-1"></a>This is never necessary for data analysis or plotting, but can be needed when making a table for presentation.</span>
<span id="cb115-204"><a href="#cb115-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-205"><a href="#cb115-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r relocate}</span></span>
<span id="cb115-206"><a href="#cb115-206" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">relocate</span>(island)</span>
<span id="cb115-207"><a href="#cb115-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-208"><a href="#cb115-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-209"><a href="#cb115-209" aria-hidden="true" tabindex="-1"></a>The default is to move the named column first, the <span class="in">`.before`</span> and <span class="in">`.after`</span> arguments let you move the column into any position.</span>
<span id="cb115-210"><a href="#cb115-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-211"><a href="#cb115-211" aria-hidden="true" tabindex="-1"></a><span class="fu">## Filtering rows with `filter()`</span></span>
<span id="cb115-212"><a href="#cb115-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-213"><a href="#cb115-213" aria-hidden="true" tabindex="-1"></a>Filtering rows that meet some condition is a very common task.</span>
<span id="cb115-214"><a href="#cb115-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-215"><a href="#cb115-215" aria-hidden="true" tabindex="-1"></a>For example, to filter rows of <span class="in">`penguins`</span> that have a bill length greater than 40 mm, we can use</span>
<span id="cb115-216"><a href="#cb115-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-217"><a href="#cb115-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filter1}</span></span>
<span id="cb115-218"><a href="#cb115-218" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">filter</span>(bill_len <span class="sc">&gt;</span> <span class="dv">40</span>)</span>
<span id="cb115-219"><a href="#cb115-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-220"><a href="#cb115-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-221"><a href="#cb115-221" aria-hidden="true" tabindex="-1"></a>This will filter out each row where the condition is <span class="in">`TRUE`</span>.</span>
<span id="cb115-222"><a href="#cb115-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-223"><a href="#cb115-223" aria-hidden="true" tabindex="-1"></a>The base R equivalent of this is</span>
<span id="cb115-224"><a href="#cb115-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-225"><a href="#cb115-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filter_base}</span></span>
<span id="cb115-226"><a href="#cb115-226" aria-hidden="true" tabindex="-1"></a>penguins[penguins<span class="sc">$</span>bill_len <span class="sc">&gt;</span> <span class="dv">40</span>, ]</span>
<span id="cb115-227"><a href="#cb115-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-228"><a href="#cb115-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-229"><a href="#cb115-229" aria-hidden="true" tabindex="-1"></a>Generally, <span class="in">`filter`</span> makes it easier to understand, especially with more complex criteria.</span>
<span id="cb115-230"><a href="#cb115-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-231"><a href="#cb115-231" aria-hidden="true" tabindex="-1"></a>Other tests include</span>
<span id="cb115-232"><a href="#cb115-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-233"><a href="#cb115-233" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`==`</span> exactly equals. Often a bad idea to use with numeric data</span>
<span id="cb115-234"><a href="#cb115-234" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`near`</span> safe function for testing equality of numeric data as it has a tolerance for rounding errors.</span>
<span id="cb115-235"><a href="#cb115-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-236"><a href="#cb115-236" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filter-near}</span></span>
<span id="cb115-237"><a href="#cb115-237" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">2</span>) <span class="sc">^</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">2</span> <span class="co"># should be true, but rounding errors</span></span>
<span id="cb115-238"><a href="#cb115-238" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">2</span>) <span class="sc">^</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span> <span class="co"># the difference</span></span>
<span id="cb115-239"><a href="#cb115-239" aria-hidden="true" tabindex="-1"></a><span class="fu">near</span>(<span class="fu">sqrt</span>(<span class="dv">2</span>) <span class="sc">^</span> <span class="dv">2</span>, <span class="dv">2</span>) <span class="co"># safe alternative</span></span>
<span id="cb115-240"><a href="#cb115-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-241"><a href="#cb115-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-242"><a href="#cb115-242" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`!=`</span> not equal to</span>
<span id="cb115-243"><a href="#cb115-243" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`&lt;`</span> less than</span>
<span id="cb115-244"><a href="#cb115-244" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`&lt;=`</span> less than or equal to</span>
<span id="cb115-245"><a href="#cb115-245" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`&gt;`</span> greater than</span>
<span id="cb115-246"><a href="#cb115-246" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`&gt;=`</span> greater than or equal to</span>
<span id="cb115-247"><a href="#cb115-247" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`is.na()`</span> for filtering by missing values.</span>
<span id="cb115-248"><a href="#cb115-248" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`between()`</span> for filtering values with a range</span>
<span id="cb115-249"><a href="#cb115-249" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`%in%`</span> is used when you want to test if a value is in a vector</span>
<span id="cb115-250"><a href="#cb115-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-251"><a href="#cb115-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filter-in}</span></span>
<span id="cb115-252"><a href="#cb115-252" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-253"><a href="#cb115-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Adelie"</span>, <span class="st">"Chinstrap"</span>))</span>
<span id="cb115-254"><a href="#cb115-254" aria-hidden="true" tabindex="-1"></a><span class="co">#equivalent to</span></span>
<span id="cb115-255"><a href="#cb115-255" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-256"><a href="#cb115-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Adelie"</span> <span class="sc">|</span> species <span class="sc">==</span> <span class="st">"Chinstrap"</span>)</span>
<span id="cb115-257"><a href="#cb115-257" aria-hidden="true" tabindex="-1"></a>  <span class="co"># with many alternatives, this gets very long</span></span>
<span id="cb115-258"><a href="#cb115-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-259"><a href="#cb115-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-260"><a href="#cb115-260" aria-hidden="true" tabindex="-1"></a><span class="fu">### Filtering on multiple criteria</span></span>
<span id="cb115-261"><a href="#cb115-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-262"><a href="#cb115-262" aria-hidden="true" tabindex="-1"></a>If we want to filter on multiple criteria, we need to decide whether we want all criteria to be <span class="in">`TRUE`</span> (AND in Boolean logic), or for one or more to be <span class="in">`TRUE`</span> (OR in Boolean logic).</span>
<span id="cb115-263"><a href="#cb115-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-264"><a href="#cb115-264" aria-hidden="true" tabindex="-1"></a>If we want all criteria to be <span class="in">`TRUE`</span>, we can separate them by a comma (or by an <span class="in">`&amp;`</span> if you want to be explicit).</span>
<span id="cb115-265"><a href="#cb115-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-266"><a href="#cb115-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filter-AND}</span></span>
<span id="cb115-267"><a href="#cb115-267" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-268"><a href="#cb115-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bill_len <span class="sc">&gt;</span> <span class="dv">40</span>, bill_dep <span class="sc">&gt;</span> <span class="dv">18</span>)</span>
<span id="cb115-269"><a href="#cb115-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-270"><a href="#cb115-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-271"><a href="#cb115-271" aria-hidden="true" tabindex="-1"></a>If we want rows where any of the criteria is <span class="in">`TRUE`</span>, we can separate them by a <span class="in">`|`</span>.</span>
<span id="cb115-272"><a href="#cb115-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-273"><a href="#cb115-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filter-OR}</span></span>
<span id="cb115-274"><a href="#cb115-274" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-275"><a href="#cb115-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bill_len <span class="sc">&gt;</span> <span class="dv">40</span> <span class="sc">|</span> bill_dep <span class="sc">&gt;</span> <span class="dv">18</span>)</span>
<span id="cb115-276"><a href="#cb115-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-277"><a href="#cb115-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-278"><a href="#cb115-278" aria-hidden="true" tabindex="-1"></a>We can negate a criterion by putting <span class="in">`!`</span> in front of it.</span>
<span id="cb115-279"><a href="#cb115-279" aria-hidden="true" tabindex="-1"></a>So to filter rows that do not have bills longer than 40 mm we can use</span>
<span id="cb115-280"><a href="#cb115-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-281"><a href="#cb115-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filter-NOT}</span></span>
<span id="cb115-282"><a href="#cb115-282" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>bill_len <span class="sc">&gt;</span> <span class="dv">40</span>)</span>
<span id="cb115-283"><a href="#cb115-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-284"><a href="#cb115-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-285"><a href="#cb115-285" aria-hidden="true" tabindex="-1"></a>Of course, in this example, we could also use <span class="in">`&lt;=`</span> as the test.</span>
<span id="cb115-286"><a href="#cb115-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-287"><a href="#cb115-287" aria-hidden="true" tabindex="-1"></a><span class="fu">### Common errors</span></span>
<span id="cb115-288"><a href="#cb115-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-289"><a href="#cb115-289" aria-hidden="true" tabindex="-1"></a>The commonest error is to use a single <span class="in">`=`</span> rather than <span class="in">`==`</span>.</span>
<span id="cb115-290"><a href="#cb115-290" aria-hidden="true" tabindex="-1"></a>Only the latter is a test of equality.</span>
<span id="cb115-291"><a href="#cb115-291" aria-hidden="true" tabindex="-1"></a>If you do this, the error message is quite helpful.</span>
<span id="cb115-292"><a href="#cb115-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-293"><a href="#cb115-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filter-error, error=TRUE}</span></span>
<span id="cb115-294"><a href="#cb115-294" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="at">species =</span> <span class="st">"Chinstrap"</span>)</span>
<span id="cb115-295"><a href="#cb115-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-296"><a href="#cb115-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-297"><a href="#cb115-297" aria-hidden="true" tabindex="-1"></a>Another common error is to forget to quote any strings.</span>
<span id="cb115-298"><a href="#cb115-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-299"><a href="#cb115-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r filter-error2, error=TRUE}</span></span>
<span id="cb115-300"><a href="#cb115-300" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">filter</span>(species <span class="sc">==</span> Chinstrap)</span>
<span id="cb115-301"><a href="#cb115-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-302"><a href="#cb115-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-303"><a href="#cb115-303" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb115-304"><a href="#cb115-304" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise</span></span>
<span id="cb115-305"><a href="#cb115-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-306"><a href="#cb115-306" aria-hidden="true" tabindex="-1"></a>From the <span class="in">`penguins`</span> data, filter</span>
<span id="cb115-307"><a href="#cb115-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-308"><a href="#cb115-308" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Gentoo penguins</span>
<span id="cb115-309"><a href="#cb115-309" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Gentoo or Adelie penguins</span>
<span id="cb115-310"><a href="#cb115-310" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>penguins with a mass greater than or equal to 5000g</span>
<span id="cb115-311"><a href="#cb115-311" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>penguins with a bill length between 45 and 50 mm</span>
<span id="cb115-312"><a href="#cb115-312" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Gentoo penguins not from from Dream Island</span>
<span id="cb115-313"><a href="#cb115-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-314"><a href="#cb115-314" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-315"><a href="#cb115-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-316"><a href="#cb115-316" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Hint<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb115-317"><a href="#cb115-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-320"><a href="#cb115-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-321"><a href="#cb115-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: hint-3</span></span>
<span id="cb115-322"><a href="#cb115-322" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb115-323"><a href="#cb115-323" aria-hidden="true" tabindex="-1"></a><span class="co">#| tidy: false</span></span>
<span id="cb115-324"><a href="#cb115-324" aria-hidden="true" tabindex="-1"></a><span class="co">#hint 1</span></span>
<span id="cb115-325"><a href="#cb115-325" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="at">___ =</span> ___)</span>
<span id="cb115-326"><a href="#cb115-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-327"><a href="#cb115-327" aria-hidden="true" tabindex="-1"></a><span class="co">#hint 2</span></span>
<span id="cb115-328"><a href="#cb115-328" aria-hidden="true" tabindex="-1"></a>?<span class="st">`</span><span class="at">%in%</span><span class="st">`</span></span>
<span id="cb115-329"><a href="#cb115-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-330"><a href="#cb115-330" aria-hidden="true" tabindex="-1"></a><span class="co">#hint 3</span></span>
<span id="cb115-331"><a href="#cb115-331" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">filter</span>(___ <span class="sc">&gt;=</span> ___)</span>
<span id="cb115-332"><a href="#cb115-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-333"><a href="#cb115-333" aria-hidden="true" tabindex="-1"></a><span class="co">#hint 4</span></span>
<span id="cb115-334"><a href="#cb115-334" aria-hidden="true" tabindex="-1"></a>?between</span>
<span id="cb115-335"><a href="#cb115-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-336"><a href="#cb115-336" aria-hidden="true" tabindex="-1"></a><span class="co">#hint 5</span></span>
<span id="cb115-337"><a href="#cb115-337" aria-hidden="true" tabindex="-1"></a>?<span class="st">`</span><span class="at">!</span><span class="st">`</span></span>
<span id="cb115-338"><a href="#cb115-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-339"><a href="#cb115-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-340"><a href="#cb115-340" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-341"><a href="#cb115-341" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-342"><a href="#cb115-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-343"><a href="#cb115-343" aria-hidden="true" tabindex="-1"></a><span class="fu">## Slicing the data with `slice()`</span></span>
<span id="cb115-344"><a href="#cb115-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-345"><a href="#cb115-345" aria-hidden="true" tabindex="-1"></a>Sometimes it is useful to extract rows by row number.</span>
<span id="cb115-346"><a href="#cb115-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-347"><a href="#cb115-347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r slice}</span></span>
<span id="cb115-348"><a href="#cb115-348" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb115-349"><a href="#cb115-349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-350"><a href="#cb115-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-351"><a href="#cb115-351" aria-hidden="true" tabindex="-1"></a>You can use negative numbers to remove rows.</span>
<span id="cb115-352"><a href="#cb115-352" aria-hidden="true" tabindex="-1"></a>Be careful using <span class="in">`slice()`</span> as if the data change, different rows may be returned.</span>
<span id="cb115-353"><a href="#cb115-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-354"><a href="#cb115-354" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distinct rows with `distinct()`</span></span>
<span id="cb115-355"><a href="#cb115-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-356"><a href="#cb115-356" aria-hidden="true" tabindex="-1"></a>If there are duplicates in the data, we can remove these with <span class="in">`distinct()`</span>.</span>
<span id="cb115-357"><a href="#cb115-357" aria-hidden="true" tabindex="-1"></a><span class="in">`distinct()`</span> with no extra arguments will remove duplicate rows.</span>
<span id="cb115-358"><a href="#cb115-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-361"><a href="#cb115-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-362"><a href="#cb115-362" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">distinct</span>()</span>
<span id="cb115-363"><a href="#cb115-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-364"><a href="#cb115-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-365"><a href="#cb115-365" aria-hidden="true" tabindex="-1"></a>If we are only interested in some of the columns, we can supply the names of these columns.</span>
<span id="cb115-366"><a href="#cb115-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-369"><a href="#cb115-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-370"><a href="#cb115-370" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">distinct</span>(island)</span>
<span id="cb115-371"><a href="#cb115-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-372"><a href="#cb115-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-373"><a href="#cb115-373" aria-hidden="true" tabindex="-1"></a>Other columns will be removed unless the argument <span class="in">`.keep_all = TRUE`</span> is used.</span>
<span id="cb115-374"><a href="#cb115-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-375"><a href="#cb115-375" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb115-376"><a href="#cb115-376" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise {.unnumbered .facta .toc-ignore}</span></span>
<span id="cb115-377"><a href="#cb115-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-378"><a href="#cb115-378" aria-hidden="true" tabindex="-1"></a>From the <span class="in">`penguins`</span> data, find distinct values of</span>
<span id="cb115-379"><a href="#cb115-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-380"><a href="#cb115-380" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>species</span>
<span id="cb115-381"><a href="#cb115-381" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>species, island and sex</span>
<span id="cb115-382"><a href="#cb115-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-383"><a href="#cb115-383" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-384"><a href="#cb115-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-385"><a href="#cb115-385" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Hint<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb115-386"><a href="#cb115-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-389"><a href="#cb115-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-390"><a href="#cb115-390" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: hint-4</span></span>
<span id="cb115-391"><a href="#cb115-391" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb115-392"><a href="#cb115-392" aria-hidden="true" tabindex="-1"></a><span class="co">#| tidy: false</span></span>
<span id="cb115-393"><a href="#cb115-393" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">distinct</span>(___, ___)</span>
<span id="cb115-394"><a href="#cb115-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-395"><a href="#cb115-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-396"><a href="#cb115-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-397"><a href="#cb115-397" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-398"><a href="#cb115-398" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-399"><a href="#cb115-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-400"><a href="#cb115-400" aria-hidden="true" tabindex="-1"></a><span class="fu">## Random rows</span></span>
<span id="cb115-401"><a href="#cb115-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-402"><a href="#cb115-402" aria-hidden="true" tabindex="-1"></a>Sometimes you want to sample rows at random from a data.frame.</span>
<span id="cb115-403"><a href="#cb115-403" aria-hidden="true" tabindex="-1"></a>This can be done with <span class="in">`slice_sample()`</span>.</span>
<span id="cb115-404"><a href="#cb115-404" aria-hidden="true" tabindex="-1"></a>This can either sample a constant *n* rows or constant fraction of the rows depending on whether the <span class="in">`n`</span> or <span class="in">`prop`</span> argument is used.</span>
<span id="cb115-405"><a href="#cb115-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-406"><a href="#cb115-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sample-n}</span></span>
<span id="cb115-407"><a href="#cb115-407" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb115-408"><a href="#cb115-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-409"><a href="#cb115-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-410"><a href="#cb115-410" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mutating and adding columns with `mutate`</span></span>
<span id="cb115-411"><a href="#cb115-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-412"><a href="#cb115-412" aria-hidden="true" tabindex="-1"></a>The function <span class="in">`mutate()`</span> can add an new column or replace an existing one.</span>
<span id="cb115-413"><a href="#cb115-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-414"><a href="#cb115-414" aria-hidden="true" tabindex="-1"></a>To make a new column called <span class="in">`body_mass_kg`</span> we can use</span>
<span id="cb115-415"><a href="#cb115-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-418"><a href="#cb115-418" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-419"><a href="#cb115-419" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-420"><a href="#cb115-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">body_mass_kg =</span> body_mass <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb115-421"><a href="#cb115-421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-422"><a href="#cb115-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-423"><a href="#cb115-423" aria-hidden="true" tabindex="-1"></a>There are lots of functions that are useful to use with mutate.</span>
<span id="cb115-424"><a href="#cb115-424" aria-hidden="true" tabindex="-1"></a>Any function that returns either a single value or as many values as are in the data can be used.</span>
<span id="cb115-425"><a href="#cb115-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-426"><a href="#cb115-426" aria-hidden="true" tabindex="-1"></a><span class="in">`mutate()`</span> is very useful when cleaning data.</span>
<span id="cb115-427"><a href="#cb115-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-428"><a href="#cb115-428" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>See text manipulation tutorial for cleaning text with the <span class="in">`stringr`</span> package.</span>
<span id="cb115-429"><a href="#cb115-429" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>See date and time tutorial for cleaning dates and times with the <span class="in">`lubridate`</span> package.</span>
<span id="cb115-430"><a href="#cb115-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-431"><a href="#cb115-431" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb115-432"><a href="#cb115-432" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise </span></span>
<span id="cb115-433"><a href="#cb115-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-434"><a href="#cb115-434" aria-hidden="true" tabindex="-1"></a>With the <span class="in">`penguins`</span> data,</span>
<span id="cb115-435"><a href="#cb115-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-436"><a href="#cb115-436" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>convert flipper length to cm</span>
<span id="cb115-437"><a href="#cb115-437" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>add a column with the ratio of bill width to length</span>
<span id="cb115-438"><a href="#cb115-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-439"><a href="#cb115-439" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-440"><a href="#cb115-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-441"><a href="#cb115-441" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Hint<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb115-442"><a href="#cb115-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-445"><a href="#cb115-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-446"><a href="#cb115-446" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: hint-5</span></span>
<span id="cb115-447"><a href="#cb115-447" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb115-448"><a href="#cb115-448" aria-hidden="true" tabindex="-1"></a><span class="co">#| tidy: false</span></span>
<span id="cb115-449"><a href="#cb115-449" aria-hidden="true" tabindex="-1"></a><span class="co"># hint 1</span></span>
<span id="cb115-450"><a href="#cb115-450" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-451"><a href="#cb115-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">___ =</span> ___)</span>
<span id="cb115-452"><a href="#cb115-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-453"><a href="#cb115-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-454"><a href="#cb115-454" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-455"><a href="#cb115-455" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-456"><a href="#cb115-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-457"><a href="#cb115-457" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summarising data with `summarise()`</span></span>
<span id="cb115-458"><a href="#cb115-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-459"><a href="#cb115-459" aria-hidden="true" tabindex="-1"></a><span class="in">`summarise()`</span> lets us summarise data.</span>
<span id="cb115-460"><a href="#cb115-460" aria-hidden="true" tabindex="-1"></a>We can use it if we want to calculate a summary statistic of the data.</span>
<span id="cb115-461"><a href="#cb115-461" aria-hidden="true" tabindex="-1"></a>Remember to separate arguments with a comma.</span>
<span id="cb115-462"><a href="#cb115-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-463"><a href="#cb115-463" aria-hidden="true" tabindex="-1"></a><span class="in">```{r summarise1}</span></span>
<span id="cb115-464"><a href="#cb115-464" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">summarise</span>(</span>
<span id="cb115-465"><a href="#cb115-465" aria-hidden="true" tabindex="-1"></a>  <span class="at">flipper_len_mean =</span> <span class="fu">mean</span>(flipper_len, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb115-466"><a href="#cb115-466" aria-hidden="true" tabindex="-1"></a>  <span class="at">flipper_len_sd =</span> <span class="fu">sd</span>(flipper_len, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb115-467"><a href="#cb115-467" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb115-468"><a href="#cb115-468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-469"><a href="#cb115-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-470"><a href="#cb115-470" aria-hidden="true" tabindex="-1"></a>Only the columns created in the <span class="in">`summarise()`</span> and any grouping columns (see below) will be kept.</span>
<span id="cb115-471"><a href="#cb115-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-472"><a href="#cb115-472" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb115-473"><a href="#cb115-473" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise</span></span>
<span id="cb115-474"><a href="#cb115-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-475"><a href="#cb115-475" aria-hidden="true" tabindex="-1"></a>With the <span class="in">`penguins`</span> data, find</span>
<span id="cb115-476"><a href="#cb115-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-477"><a href="#cb115-477" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the maximum and minimum bill length</span>
<span id="cb115-478"><a href="#cb115-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-479"><a href="#cb115-479" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-480"><a href="#cb115-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-481"><a href="#cb115-481" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Hint<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb115-482"><a href="#cb115-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-485"><a href="#cb115-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-486"><a href="#cb115-486" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: hint-6</span></span>
<span id="cb115-487"><a href="#cb115-487" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb115-488"><a href="#cb115-488" aria-hidden="true" tabindex="-1"></a><span class="co">#| tidy: false</span></span>
<span id="cb115-489"><a href="#cb115-489" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-490"><a href="#cb115-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">___ =</span> <span class="fu">___</span>(___))</span>
<span id="cb115-491"><a href="#cb115-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-492"><a href="#cb115-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-493"><a href="#cb115-493" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-494"><a href="#cb115-494" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-495"><a href="#cb115-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-496"><a href="#cb115-496" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summarising multiple columns</span></span>
<span id="cb115-497"><a href="#cb115-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-498"><a href="#cb115-498" aria-hidden="true" tabindex="-1"></a>Sometimes you want to summarise multiple columns at the same time.</span>
<span id="cb115-499"><a href="#cb115-499" aria-hidden="true" tabindex="-1"></a>This can be done with the <span class="in">`across()`</span> helper function.</span>
<span id="cb115-500"><a href="#cb115-500" aria-hidden="true" tabindex="-1"></a><span class="in">`across()`</span> needs to be told which columns to process and what function or functions to use.</span>
<span id="cb115-501"><a href="#cb115-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-502"><a href="#cb115-502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r across}</span></span>
<span id="cb115-503"><a href="#cb115-503" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-504"><a href="#cb115-504" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(</span>
<span id="cb115-505"><a href="#cb115-505" aria-hidden="true" tabindex="-1"></a>     <span class="fu">across</span>(<span class="fu">c</span>(bill_len, bill_dep),</span>
<span id="cb115-506"><a href="#cb115-506" aria-hidden="true" tabindex="-1"></a>            <span class="at">.fns =</span> \(x)<span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb115-507"><a href="#cb115-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-508"><a href="#cb115-508" aria-hidden="true" tabindex="-1"></a><span class="co">#using a list of functions</span></span>
<span id="cb115-509"><a href="#cb115-509" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-510"><a href="#cb115-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb115-511"><a href="#cb115-511" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">starts_with</span>(<span class="st">"bill"</span>),</span>
<span id="cb115-512"><a href="#cb115-512" aria-hidden="true" tabindex="-1"></a>           <span class="at">.fns =</span> <span class="fu">list</span>(<span class="at">sd =</span> \(x)<span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb115-513"><a href="#cb115-513" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mean =</span> \(x)<span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))))</span>
<span id="cb115-514"><a href="#cb115-514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-515"><a href="#cb115-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-516"><a href="#cb115-516" aria-hidden="true" tabindex="-1"></a>You can also use <span class="in">`across()`</span> with <span class="in">`mutate()`</span> to mutate several columns at the same time.</span>
<span id="cb115-517"><a href="#cb115-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-518"><a href="#cb115-518" aria-hidden="true" tabindex="-1"></a><span class="fu">## Grouping data with `group_by`</span></span>
<span id="cb115-519"><a href="#cb115-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-520"><a href="#cb115-520" aria-hidden="true" tabindex="-1"></a><span class="in">`group_by()`</span> changes the way that many of the <span class="in">`dplyr`</span> functions work.</span>
<span id="cb115-521"><a href="#cb115-521" aria-hidden="true" tabindex="-1"></a>Instead of working on the entire dataset, they now work on each group in the data</span>
<span id="cb115-522"><a href="#cb115-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-523"><a href="#cb115-523" aria-hidden="true" tabindex="-1"></a>To find the mean flipper length for each species, we need to <span class="in">`group_by()`</span> species and then <span class="in">`summarise()`</span>.</span>
<span id="cb115-524"><a href="#cb115-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-525"><a href="#cb115-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r group-by}</span></span>
<span id="cb115-526"><a href="#cb115-526" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-527"><a href="#cb115-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span></span>
<span id="cb115-528"><a href="#cb115-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_flipper_length =</span> <span class="fu">mean</span>(flipper_len))</span>
<span id="cb115-529"><a href="#cb115-529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-530"><a href="#cb115-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-531"><a href="#cb115-531" aria-hidden="true" tabindex="-1"></a>Grouped data can be ungrouped with <span class="in">`ungroup()`</span>.</span>
<span id="cb115-532"><a href="#cb115-532" aria-hidden="true" tabindex="-1"></a>This can help prevent surprises!</span>
<span id="cb115-533"><a href="#cb115-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-534"><a href="#cb115-534" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb115-535"><a href="#cb115-535" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise </span></span>
<span id="cb115-536"><a href="#cb115-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-537"><a href="#cb115-537" aria-hidden="true" tabindex="-1"></a>With the <span class="in">`penguins`</span> data, find</span>
<span id="cb115-538"><a href="#cb115-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-539"><a href="#cb115-539" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the maximum and minimum bill depth of each species</span>
<span id="cb115-540"><a href="#cb115-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-541"><a href="#cb115-541" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-542"><a href="#cb115-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-543"><a href="#cb115-543" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Hint<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb115-544"><a href="#cb115-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-547"><a href="#cb115-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-548"><a href="#cb115-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: hint-7</span></span>
<span id="cb115-549"><a href="#cb115-549" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb115-550"><a href="#cb115-550" aria-hidden="true" tabindex="-1"></a><span class="co">#| tidy: false</span></span>
<span id="cb115-551"><a href="#cb115-551" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-552"><a href="#cb115-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(___)</span>
<span id="cb115-553"><a href="#cb115-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">___ =</span>  <span class="fu">___</span>(___))</span>
<span id="cb115-554"><a href="#cb115-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-555"><a href="#cb115-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-556"><a href="#cb115-556" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-557"><a href="#cb115-557" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-558"><a href="#cb115-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-559"><a href="#cb115-559" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sorting with `arrange()`</span></span>
<span id="cb115-560"><a href="#cb115-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-561"><a href="#cb115-561" aria-hidden="true" tabindex="-1"></a>To sort the data frame by one or more of the variables we can use <span class="in">`arrange()`</span>.</span>
<span id="cb115-562"><a href="#cb115-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-563"><a href="#cb115-563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r arrange1}</span></span>
<span id="cb115-564"><a href="#cb115-564" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">arrange</span>(bill_len, bill_dep)</span>
<span id="cb115-565"><a href="#cb115-565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-566"><a href="#cb115-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-567"><a href="#cb115-567" aria-hidden="true" tabindex="-1"></a>This will sort smallest first.</span>
<span id="cb115-568"><a href="#cb115-568" aria-hidden="true" tabindex="-1"></a>To reverse the sort order, use <span class="in">`desc()`</span></span>
<span id="cb115-569"><a href="#cb115-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-570"><a href="#cb115-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r arrange2}</span></span>
<span id="cb115-571"><a href="#cb115-571" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(bill_len), <span class="fu">desc</span>(bill_dep))</span>
<span id="cb115-572"><a href="#cb115-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-573"><a href="#cb115-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-574"><a href="#cb115-574" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb115-575"><a href="#cb115-575" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise</span></span>
<span id="cb115-576"><a href="#cb115-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-577"><a href="#cb115-577" aria-hidden="true" tabindex="-1"></a>Sort the <span class="in">`penguins`</span> data by</span>
<span id="cb115-578"><a href="#cb115-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-579"><a href="#cb115-579" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>body mass</span>
<span id="cb115-580"><a href="#cb115-580" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>island and body mass, with the largest birds first</span>
<span id="cb115-581"><a href="#cb115-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-582"><a href="#cb115-582" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-583"><a href="#cb115-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-584"><a href="#cb115-584" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Hint<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb115-585"><a href="#cb115-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-588"><a href="#cb115-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-589"><a href="#cb115-589" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: hint-8</span></span>
<span id="cb115-590"><a href="#cb115-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb115-591"><a href="#cb115-591" aria-hidden="true" tabindex="-1"></a><span class="co">#| tidy: false</span></span>
<span id="cb115-592"><a href="#cb115-592" aria-hidden="true" tabindex="-1"></a><span class="co"># hint 1</span></span>
<span id="cb115-593"><a href="#cb115-593" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-594"><a href="#cb115-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(___, ___)</span>
<span id="cb115-595"><a href="#cb115-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-596"><a href="#cb115-596" aria-hidden="true" tabindex="-1"></a><span class="co"># hint 2</span></span>
<span id="cb115-597"><a href="#cb115-597" aria-hidden="true" tabindex="-1"></a>?desc</span>
<span id="cb115-598"><a href="#cb115-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-599"><a href="#cb115-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-600"><a href="#cb115-600" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-601"><a href="#cb115-601" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-602"><a href="#cb115-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-603"><a href="#cb115-603" aria-hidden="true" tabindex="-1"></a><span class="fu">## Counting rows with `count()` and `n()`</span></span>
<span id="cb115-604"><a href="#cb115-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-605"><a href="#cb115-605" aria-hidden="true" tabindex="-1"></a>The function <span class="in">`n`</span> can count how many rows there are in the each group (or the entire data frame if it is not grouped).</span>
<span id="cb115-606"><a href="#cb115-606" aria-hidden="true" tabindex="-1"></a>It can be used with either <span class="in">`mutate()`</span> or <span class="in">`summarise()`</span>.</span>
<span id="cb115-607"><a href="#cb115-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-608"><a href="#cb115-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r n}</span></span>
<span id="cb115-609"><a href="#cb115-609" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-610"><a href="#cb115-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span></span>
<span id="cb115-611"><a href="#cb115-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb115-612"><a href="#cb115-612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-613"><a href="#cb115-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-614"><a href="#cb115-614" aria-hidden="true" tabindex="-1"></a>Or with <span class="in">`count()`</span></span>
<span id="cb115-615"><a href="#cb115-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-616"><a href="#cb115-616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r count}</span></span>
<span id="cb115-617"><a href="#cb115-617" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-618"><a href="#cb115-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(species)</span>
<span id="cb115-619"><a href="#cb115-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-620"><a href="#cb115-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-621"><a href="#cb115-621" aria-hidden="true" tabindex="-1"></a><span class="in">`count()`</span> is more concise, but <span class="in">`group_by()`</span> and <span class="in">`summarise()`</span> is useful when you need to calculate more variables (for example mean and standard deviation).</span>
<span id="cb115-622"><a href="#cb115-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-623"><a href="#cb115-623" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb115-624"><a href="#cb115-624" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise </span></span>
<span id="cb115-625"><a href="#cb115-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-626"><a href="#cb115-626" aria-hidden="true" tabindex="-1"></a>From the <span class="in">`penguins`</span> data, find</span>
<span id="cb115-627"><a href="#cb115-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-628"><a href="#cb115-628" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>how many penguins are there of each species</span>
<span id="cb115-629"><a href="#cb115-629" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>how many penguins are there of each species in each island</span>
<span id="cb115-630"><a href="#cb115-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-631"><a href="#cb115-631" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-632"><a href="#cb115-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-633"><a href="#cb115-633" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Hint<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb115-634"><a href="#cb115-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-637"><a href="#cb115-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb115-638"><a href="#cb115-638" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: hint-9</span></span>
<span id="cb115-639"><a href="#cb115-639" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb115-640"><a href="#cb115-640" aria-hidden="true" tabindex="-1"></a><span class="co">#| tidy: false</span></span>
<span id="cb115-641"><a href="#cb115-641" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-642"><a href="#cb115-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(___, ___)</span>
<span id="cb115-643"><a href="#cb115-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-644"><a href="#cb115-644" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb115-645"><a href="#cb115-645" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb115-646"><a href="#cb115-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(___) <span class="sc">|&gt;</span></span>
<span id="cb115-647"><a href="#cb115-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">___ =</span> <span class="fu">n</span>())</span>
<span id="cb115-648"><a href="#cb115-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-649"><a href="#cb115-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-650"><a href="#cb115-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-651"><a href="#cb115-651" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb115-652"><a href="#cb115-652" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-653"><a href="#cb115-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-654"><a href="#cb115-654" aria-hidden="true" tabindex="-1"></a><span class="fu">## Common problems</span></span>
<span id="cb115-655"><a href="#cb115-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-656"><a href="#cb115-656" aria-hidden="true" tabindex="-1"></a><span class="fu">### Non standard names</span></span>
<span id="cb115-657"><a href="#cb115-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-658"><a href="#cb115-658" aria-hidden="true" tabindex="-1"></a>Ideally column names should follow the standard rules for naming objects in R - UPPER and lower case letters, numbers, "." and "<span class="sc">\_</span>" with the first character being a letter (or a dot if you want an invisible object).</span>
<span id="cb115-659"><a href="#cb115-659" aria-hidden="true" tabindex="-1"></a>Sometimes when you import data, it has non-standard names with spaces or extra characters.</span>
<span id="cb115-660"><a href="#cb115-660" aria-hidden="true" tabindex="-1"></a>If you need to refer to a column name that doesn't follow the rules, you need to enclose it with back-ticks.</span>
<span id="cb115-661"><a href="#cb115-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-662"><a href="#cb115-662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r non-standard-names}</span></span>
<span id="cb115-663"><a href="#cb115-663" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">`</span><span class="at">Region/Country</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Norway"</span>, <span class="at">value =</span> <span class="dv">42</span>)</span>
<span id="cb115-664"><a href="#cb115-664" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb115-665"><a href="#cb115-665" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">region_country =</span> <span class="st">`</span><span class="at">Region/Country</span><span class="st">`</span>)</span>
<span id="cb115-666"><a href="#cb115-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-667"><a href="#cb115-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-668"><a href="#cb115-668" aria-hidden="true" tabindex="-1"></a>It is sometimes best to rename these columns to make them easier to refer to.</span>
<span id="cb115-669"><a href="#cb115-669" aria-hidden="true" tabindex="-1"></a><span class="in">`janitor::clean_names()`</span> is very efficient for making easy-to-use names.</span>
<span id="cb115-670"><a href="#cb115-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-671"><a href="#cb115-671" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb115-672"><a href="#cb115-672" aria-hidden="true" tabindex="-1"></a><span class="fu">## Further reading</span></span>
<span id="cb115-673"><a href="#cb115-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-674"><a href="#cb115-674" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">stat545</span><span class="co">](https://stat545.com/dplyr-intro.html)</span></span>
<span id="cb115-675"><a href="#cb115-675" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">R for data science</span><span class="co">](https://r4ds.hadley.nz/)</span></span>
<span id="cb115-676"><a href="#cb115-676" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`dplyr` cheatsheet</span><span class="co">](https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf)</span></span>
<span id="cb115-677"><a href="#cb115-677" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb115-678"><a href="#cb115-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-679"><a href="#cb115-679" aria-hidden="true" tabindex="-1"></a>::: {.column-margin}</span>
<span id="cb115-680"><a href="#cb115-680" aria-hidden="true" tabindex="-1"></a><span class="fu">### Contributors {.unlisted .unnumbered}</span></span>
<span id="cb115-681"><a href="#cb115-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-682"><a href="#cb115-682" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Richard Telford</span>
<span id="cb115-683"><a href="#cb115-683" aria-hidden="true" tabindex="-1"></a>:::</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>