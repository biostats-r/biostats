<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>15 Using functions and packages | Working in R</title>
<meta name="author" content="Jonathan Soulé, Aud Halbritter and Richard J Telford">
<meta name="description" content="15.1 Functions Everything that does something in R is a function. For most functions the function name is followed by brackets. Within the brackets are zero or more arguments separated by commas....">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="15 Using functions and packages | Working in R">
<meta property="og:type" content="book">
<meta property="og:description" content="15.1 Functions Everything that does something in R is a function. For most functions the function name is followed by brackets. Within the brackets are zero or more arguments separated by commas....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="15 Using functions and packages | Working in R">
<meta name="twitter:description" content="15.1 Functions Everything that does something in R is a function. For most functions the function name is followed by brackets. Within the brackets are zero or more arguments separated by commas....">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/panelset-0.2.6/panelset.css" rel="stylesheet">
<script src="libs/panelset-0.2.6/panelset.js"></script><link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="css/style-chapters.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Working in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li class="book-part">Setting up R and RStudio</li>
<li><a class="" href="getting-started-with-r.html"><span class="header-section-number">2</span> Getting started with R</a></li>
<li class="book-part">First steps in R</li>
<li><a class="" href="first-steps-in-r.html"><span class="header-section-number">3</span> First steps in R</a></li>
<li><a class="" href="importing-data-in-r.html"><span class="header-section-number">4</span> Importing data in R</a></li>
<li class="book-part">Data manipulation with the tidyverse</li>
<li><a class="" href="pipes.html"><span class="header-section-number">5</span> Pipes</a></li>
<li><a class="" href="tidying-data-with-tidyr.html"><span class="header-section-number">6</span> Tidying data with tidyr</a></li>
<li><a class="" href="working-with-single-tables-in-dplyr.html"><span class="header-section-number">7</span> Working with single tables in dplyr</a></li>
<li><a class="" href="working-with-multiple-tables-in-dplyr.html"><span class="header-section-number">8</span> Working with multiple tables in dplyr</a></li>
<li class="book-part">Data visualisation</li>
<li><a class="" href="why-is-data-visualization-important.html"><span class="header-section-number">9</span> Why is data visualization important?</a></li>
<li><a class="" href="getting-started-with-ggplot.html"><span class="header-section-number">10</span> Getting started with ggplot</a></li>
<li><a class="" href="choosing-your-visualisation.html"><span class="header-section-number">11</span> Choosing your visualisation</a></li>
<li><a class="" href="themes-1.html"><span class="header-section-number">12</span> Themes</a></li>
<li><a class="" href="colours-shapes-and-linetypes.html"><span class="header-section-number">13</span> Colours, shapes and linetypes</a></li>
<li><a class="" href="combining-plots.html"><span class="header-section-number">14</span> Combining plots</a></li>
<li><a class="active" href="using-functions-and-packages.html"><span class="header-section-number">15</span> Using functions and packages</a></li>
<li class="book-part">Other topics</li>
<li><a class="" href="handling-missing-values.html"><span class="header-section-number">16</span> Handling missing values</a></li>
<li><a class="" href="bestiary-of-brackets-and-other-r-notation.html"><span class="header-section-number">17</span> Bestiary of Brackets and other R notation</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="using-functions-and-packages" class="section level1" number="15">
<h1>
<span class="header-section-number">15</span> Using functions and packages<a class="anchor" aria-label="anchor" href="#using-functions-and-packages"><i class="fas fa-link"></i></a>
</h1>
<div id="functions" class="section level2" number="15.1">
<h2>
<span class="header-section-number">15.1</span> Functions<a class="anchor" aria-label="anchor" href="#functions"><i class="fas fa-link"></i></a>
</h2>
<p>Everything that does something in <code>R</code> is a function.</p>
<p>For most functions the function name is followed by brackets.
Within the brackets are zero or more arguments separated by commas.</p>
<p>Missing commas out is a common mistake and will give an error.</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="using-functions-and-packages.html#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">5</span> <span class="at">sd =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Error: &lt;text&gt;:1:24: unexpected symbol
## 1: rnorm(n = 10, mean = 5 sd
##                            ^</code></pre>
<p>To get help on a function, use a <code><a href="https://rdrr.io/r/utils/Question.html">?</a></code>.</p>
<div class="sourceCode" id="cb506"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="va">rnorm</span></code></pre></div>
<p>The examples at the bottom of the help file can be useful to understand how to use the function.
You can run the examples either by copying and pasting them, or using <code><a href="https://rdrr.io/r/utils/example.html">example()</a></code>.</p>
<div class="sourceCode" id="cb507"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/example.html">example</a></span><span class="op">(</span><span class="va">rnorm</span><span class="op">)</span></code></pre></div>
<div id="infix-functions" class="section level3" number="15.1.1">
<h3>
<span class="header-section-number">15.1.1</span> infix functions<a class="anchor" aria-label="anchor" href="#infix-functions"><i class="fas fa-link"></i></a>
</h3>
<p>There is a special type of function called an infix function that does not use brackets but is placed between two objects.</p>
<p>For example, in</p>
<div class="sourceCode" id="cb508"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">5</span> <span class="op">&lt;</span> <span class="fl">3</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p><code><a href="https://rdrr.io/r/base/Comparison.html">&lt;</a></code> is the infix function that tests if the first number is smaller than the second and returns a TRUE or FALSE.</p>
<p>Some other infix functions are</p>
<div class="sourceCode" id="cb510"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">5</span> <span class="op">&gt;</span> <span class="fl">3</span> <span class="co"># Greater than</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb512"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"z"</span><span class="op">)</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span> <span class="co"># are the first values in the second vector</span></code></pre></div>
<pre><code>## [1]  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb514"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">7</span> <span class="op">%%</span> <span class="fl">4</span> <span class="co"># modulus (finds the remainder)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb516"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">7</span> <span class="op">%/%</span> <span class="fl">4</span> <span class="co"># integer division</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>To get help of an infix function surround it with backticks.</p>
<div class="sourceCode" id="cb518"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="va">`%in%`</span></code></pre></div>
</div>
</div>
<div id="packages" class="section level2" number="15.2">
<h2>
<span class="header-section-number">15.2</span> Packages<a class="anchor" aria-label="anchor" href="#packages"><i class="fas fa-link"></i></a>
</h2>
<p>All functions arranged into packages.</p>
<p>Some <code>R</code> packages, for example, <code>stats</code> and <code>utils</code>, are automatically loaded when you start <code>R</code>.</p>
<p>There are also several recommended packages that are installed by default, for example the <code>mgcv</code> package for fitting generalised additive models.</p>
</div>
<div id="loading-packages" class="section level2" number="15.3">
<h2>
<span class="header-section-number">15.3</span> Loading packages<a class="anchor" aria-label="anchor" href="#loading-packages"><i class="fas fa-link"></i></a>
</h2>
<p>If you want to use the functions in a package, you need to load the package with the function <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>.</p>
<div class="sourceCode" id="cb519"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"mgcv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: nlme</code></pre>
<pre><code>## 
## Attaching package: 'nlme'</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     collapse</code></pre>
<pre><code>## This is mgcv 1.8-36. For overview type 'help("mgcv-package")'.</code></pre>
</div>
<div id="installing-extra-packages" class="section level2" number="15.4">
<h2>
<span class="header-section-number">15.4</span> Installing extra packages<a class="anchor" aria-label="anchor" href="#installing-extra-packages"><i class="fas fa-link"></i></a>
</h2>
<p>There are lots of extra <code>R</code> packages available from <a href="https://cran.r-project.org/">CRAN</a> (<code>R</code>s homepage).</p>
<p>You can install or update a package from CRAN with <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code></p>
<div class="sourceCode" id="cb524"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"vegan"</span><span class="op">)</span></code></pre></div>
<p>You only need to do this once (unless you need to install a new version of a package), so you should run this directly in the console and not keep it in your script (otherwise it will install the package every time you run the code).</p>
<p>Once you have installed the package, you can use <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> to load it.
You need to do this every time use use it.</p>
<p>Often you know what package you want to install.
If you don’t know the name of the package you need for your analyses the <a href="https://cran.r-project.org/web/views/">task views</a> can help.
For example, the <a href="https://cran.r-project.org/web/views/Environmetrics.html">Environmetrics</a> task view describes packages for the analysis of ecological and environmental data.</p>
<p>Not all R packages are available on CRAN.
Some packages in development are only available on <a href="github.com">github.com</a>.
Packages on github can be installed with the <code>remotes</code> package.</p>
<div class="sourceCode" id="cb525"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>
<span class="co">#ggvegan for plotting ordinations is only on github</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"gavinsimpson/ggvegan"</span><span class="op">)</span></code></pre></div>
</div>
<div id="debugging-failed-package-installation" class="section level2" number="15.5">
<h2>
<span class="header-section-number">15.5</span> Debugging failed package installation<a class="anchor" aria-label="anchor" href="#debugging-failed-package-installation"><i class="fas fa-link"></i></a>
</h2>
<p>Sometimes packages fail to install properly.
This can be frustrating.</p>
<p>Some recommendations</p>
<ul>
<li>Check exactly which package won’t install. It may be a dependency of the package you want. Try to install it again.</li>
<li>Restart <code>R</code> (in Session menu in RStudio) and try again.</li>
<li>Google any error message. Someone else may have had the same problem.</li>
</ul>
</div>
<div id="name-conflicts" class="section level2" number="15.6">
<h2>
<span class="header-section-number">15.6</span> Name conflicts<a class="anchor" aria-label="anchor" href="#name-conflicts"><i class="fas fa-link"></i></a>
</h2>
<div id="the-problem" class="section level3" number="15.6.1">
<h3>
<span class="header-section-number">15.6.1</span> The problem<a class="anchor" aria-label="anchor" href="#the-problem"><i class="fas fa-link"></i></a>
</h3>
<p>Sometimes two packages have functions with the same names.
For example, both <code>MASS</code> and <code>dplyr</code> have a <code>select</code> function which does completely different things.
If both packages are loaded at the same time there is a conflict and the function that was loaded last takes priority.
This can cause big problems, with difficult to interpret error messages.</p>
<div class="sourceCode" id="cb526"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a></span><span class="op">)</span><span class="co">#load data</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span> <span class="co"># R will report that select is being masked</span></code></pre></div>
<pre><code>## 
## Attaching package: 'MASS'</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     select</code></pre>
<div class="sourceCode" id="cb529"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span> |&gt; <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in select(penguins, species): unused argument (species)</code></pre>
<p>If you have code that worked one day and fails the next with a weird error messages, it might be because of a name conflict.
If you start typing a function name into RStudio, it will show which package the function comes from.</p>
<p>There are three solutions.</p>
</div>
<div id="loading-order" class="section level3" number="15.6.2">
<h3>
<span class="header-section-number">15.6.2</span> Loading order<a class="anchor" aria-label="anchor" href="#loading-order"><i class="fas fa-link"></i></a>
</h3>
<p>Be very careful about the order in which packages are loaded.
If the example above had loaded <code>MASS</code> before <code>dplyr</code> the <code>select</code> function in <code>MASS</code> would have been masked and the code would have worked.
This solution can work in a script that you source, but is fragile in interactive sessions when it is easy to load packages in the wrong order.</p>
</div>
<div id="packagefunction" class="section level3" number="15.6.3">
<h3>
<span class="header-section-number">15.6.3</span> <code>package::function</code><a class="anchor" aria-label="anchor" href="#packagefunction"><i class="fas fa-link"></i></a>
</h3>
<p>Use the <code>package::function</code> notation to specify which package a function comes from.
This is safe and can make code easier to understand by showing which packages the functions are from. The code above could be written safely as</p>
<div class="sourceCode" id="cb531"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 344 × 1
##   species
##   &lt;fct&gt;  
## 1 Adelie 
## 2 Adelie 
## 3 Adelie 
## # … with 341 more rows</code></pre>
<p>This gets ugly fairly quickly, so is best used with packages that you only need a few functions from once or twice, not functions you need many times.</p>
</div>
<div id="conflicted-package" class="section level3" number="15.6.4">
<h3>
<span class="header-section-number">15.6.4</span> <code>conflicted</code> package<a class="anchor" aria-label="anchor" href="#conflicted-package"><i class="fas fa-link"></i></a>
</h3>
<p>The safest solution is to use the <a href="https://conflicted.r-lib.org/"><code>conflicted</code> package</a>.
The <code>conflicted</code> package converts any conflicts between packages into errors.
This might seem like a bad idea, but it is much easier to diagnose an error from <code>conflicted</code> than the weird error of a masked function.</p>
<div class="sourceCode" id="cb533"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-lib/conflicted">conflicted</a></span><span class="op">)</span>

<span class="va">penguins</span> |&gt; <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span></code></pre></div>
<pre><code>## Error: [conflicted] `select` found in 2 packages.
## Either pick the one you want with `::` 
## * MASS::select
## * dplyr::select
## Or declare a preference with `conflict_prefer()`
## * conflict_prefer("select", "MASS")
## * conflict_prefer("select", "dplyr")</code></pre>
<p>As the error message suggests, we can resolve the error either by using the <code>package::function</code> notation, or use the function <code>conflict_prefer</code> to say which function we want to use by default.</p>
<div class="sourceCode" id="cb535"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-lib/conflicted">conflicted</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/conflicted/man/conflict_prefer.html">conflict_prefer</a></span><span class="op">(</span><span class="st">"select"</span>, <span class="st">"dplyr"</span><span class="op">)</span></code></pre></div>
<pre><code>## [conflicted] Will prefer dplyr::select over any other package</code></pre>
<div class="sourceCode" id="cb537"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peguins</span> |&gt; <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in select(peguins, Species): object 'peguins' not found</code></pre>
<p>If there are many functions that need preferences recording, for example if you have loaded <code>tidylog</code>, you can iterate over them with <code><a href="https://purrr.tidyverse.org/reference/map.html">purrr::map</a></code>.</p>
<div class="sourceCode" id="cb539"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/ns-reflect.html">getNamespaceExports</a></span><span class="op">(</span><span class="st">"tidylog"</span><span class="op">)</span> |&gt; 
  <span class="fu">map</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/conflicted/man/conflict_prefer.html">conflict_prefer</a></span><span class="op">(</span><span class="va">.x</span>, winner <span class="op">=</span> <span class="st">"tidylog"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="citing-packages" class="section level2" number="15.7">
<h2>
<span class="header-section-number">15.7</span> Citing packages<a class="anchor" aria-label="anchor" href="#citing-packages"><i class="fas fa-link"></i></a>
</h2>
<p>When you use a package it is important to cite it in a manuscript or thesis both to acknowledge the author’s work in making the package and to increase reproducibility.
The correct citation can be seen with the function <code>citation</code>.</p>
<div class="sourceCode" id="cb540"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html">citation</a></span><span class="op">(</span><span class="st">"lme4"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## To cite lme4 in publications use:
## 
##   Douglas Bates, Martin Maechler, Ben Bolker, Steve Walker (2015).
##   Fitting Linear Mixed-Effects Models Using lme4. Journal of
##   Statistical Software, 67(1), 1-48. doi:10.18637/jss.v067.i01.
## 
## A BibTeX entry for LaTeX users is
## 
##   @Article{,
##     title = {Fitting Linear Mixed-Effects Models Using {lme4}},
##     author = {Douglas Bates and Martin M{\"a}chler and Ben Bolker and Steve Walker},
##     journal = {Journal of Statistical Software},
##     year = {2015},
##     volume = {67},
##     number = {1},
##     pages = {1--48},
##     doi = {10.18637/jss.v067.i01},
##   }</code></pre>
<p>It is also important to cite the version used.</p>
<div class="sourceCode" id="cb542"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"lme4"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] '1.1.27.1'</code></pre>
<p>You should also cite <code>R</code>.
Again, the <code>citation</code> function can be used</p>
<div class="sourceCode" id="cb544"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html">citation</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## To cite R in publications use:
## 
##   R Core Team (2021). R: A language and environment for statistical
##   computing. R Foundation for Statistical Computing, Vienna, Austria.
##   URL https://www.R-project.org/.
## 
## A BibTeX entry for LaTeX users is
## 
##   @Manual{,
##     title = {R: A Language and Environment for Statistical Computing},
##     author = {{R Core Team}},
##     organization = {R Foundation for Statistical Computing},
##     address = {Vienna, Austria},
##     year = {2021},
##     url = {https://www.R-project.org/},
##   }
## 
## We have invested a lot of time and effort in creating R, please cite it
## when using it for data analysis. See also 'citation("pkgname")' for
## citing R packages.</code></pre>
<p>The <code>R</code> version can be obtained with <code>R.version.string</code>.
This is a variable not a function so it does not take brackets.</p>
<div class="sourceCode" id="cb546"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">R.version.string</span></code></pre></div>
<pre><code>## [1] "R version 4.1.1 (2021-08-10)"</code></pre>
</div>
<div id="packages-change-over-time" class="section level2" number="15.8">
<h2>
<span class="header-section-number">15.8</span> Packages change over time<a class="anchor" aria-label="anchor" href="#packages-change-over-time"><i class="fas fa-link"></i></a>
</h2>
<p><code>R</code> packages often get updated.
This is good as functions get improved and bugs get fixed.
However, it also means that code written last year might not work next year with all the latest packages.
This is a big problem for reproducibility.</p>
<p>The solution is to make sure you re-run your code with the same packages.
That is not easy to do by hand.
The <a href="https://rstudio.github.io/renv/articles/renv.html"><code>renv</code> package</a> keeps track of all the packages you are using (and all the packages they depend on).
I use <code>renv</code> for my analyses.</p>
<p>The workflow when working with <code>renv</code> is:</p>
<ul>
<li><p>Call <code><a href="https://rstudio.github.io/renv/reference/init.html">renv::init()</a></code> to initialise a private R library for the project</p></li>
<li><p>Work in the project as normal, installing R packages as needed in the project</p></li>
<li><p>Call <code><a href="https://rstudio.github.io/renv/reference/snapshot.html">renv::snapshot()</a></code> to save the state of the project library</p></li>
<li><p>Continue working on your project, installing and updating R packages as needed.
Use <code><a href="https://rstudio.github.io/renv/reference/install.html">renv::install()</a></code> to install packages from CRAN or github.</p></li>
<li><p>If the changes were successful, call <code><a href="https://rstudio.github.io/renv/reference/snapshot.html">renv::snapshot()</a></code> again. If the updated packages introduced problems, call <code><a href="https://rstudio.github.io/renv/reference/restore.html">renv::restore()</a></code> to revert to the previous state of the library.</p></li>
</ul>
</div>
<div id="writing-your-own-functionpackages" class="section level2" number="15.9">
<h2>
<span class="header-section-number">15.9</span> Writing your own function/packages<a class="anchor" aria-label="anchor" href="#writing-your-own-functionpackages"><i class="fas fa-link"></i></a>
</h2>
<p>If you find that you need to run the same code several times, it can be useful to write a function.</p>
<p>To make a function, you need to use the reserved word <code>function</code> followed by brackets with zero or more arguments. After the brackets, braces encompass the body of the function.</p>
<p>Here is a function that multiples two numbers together.</p>
<div class="sourceCode" id="cb548"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mutliply</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span> <span class="co">#The default value of y is 1</span>
  <span class="va">x</span> <span class="op">*</span> <span class="va">y</span>
<span class="op">}</span>

<span class="fu">multiply</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></code></pre></div>
<p>Once you have written a function, it can be useful to make your own package.
This makes it easy to use in your own analysis and easy to share with other users.
Information on how to make a package using the <code>usethis</code> and <code>devtools</code> packages can be found in the package writing book or at <a href="https://r-pkgs.org/whole-game.html">https://r-pkgs.org/whole-game.html</a>.</p>

</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="combining-plots.html"><span class="header-section-number">14</span> Combining plots</a></div>
<div class="next"><a href="handling-missing-values.html"><span class="header-section-number">16</span> Handling missing values</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#using-functions-and-packages"><span class="header-section-number">15</span> Using functions and packages</a></li>
<li>
<a class="nav-link" href="#functions"><span class="header-section-number">15.1</span> Functions</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#infix-functions"><span class="header-section-number">15.1.1</span> infix functions</a></li></ul>
</li>
<li><a class="nav-link" href="#packages"><span class="header-section-number">15.2</span> Packages</a></li>
<li><a class="nav-link" href="#loading-packages"><span class="header-section-number">15.3</span> Loading packages</a></li>
<li><a class="nav-link" href="#installing-extra-packages"><span class="header-section-number">15.4</span> Installing extra packages</a></li>
<li><a class="nav-link" href="#debugging-failed-package-installation"><span class="header-section-number">15.5</span> Debugging failed package installation</a></li>
<li>
<a class="nav-link" href="#name-conflicts"><span class="header-section-number">15.6</span> Name conflicts</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-problem"><span class="header-section-number">15.6.1</span> The problem</a></li>
<li><a class="nav-link" href="#loading-order"><span class="header-section-number">15.6.2</span> Loading order</a></li>
<li><a class="nav-link" href="#packagefunction"><span class="header-section-number">15.6.3</span> package::function</a></li>
<li><a class="nav-link" href="#conflicted-package"><span class="header-section-number">15.6.4</span> conflicted package</a></li>
</ul>
</li>
<li><a class="nav-link" href="#citing-packages"><span class="header-section-number">15.7</span> Citing packages</a></li>
<li><a class="nav-link" href="#packages-change-over-time"><span class="header-section-number">15.8</span> Packages change over time</a></li>
<li><a class="nav-link" href="#writing-your-own-functionpackages"><span class="header-section-number">15.9</span> Writing your own function/packages</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Working in R</strong>" was written by Jonathan Soulé, Aud Halbritter and Richard J Telford. It was last built on 2021-09-14.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
