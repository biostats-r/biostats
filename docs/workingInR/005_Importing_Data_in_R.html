<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>11&nbsp; Importing data in R – Working in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./010-pipes.html" rel="next">
<link href="./0025_data_structures.html" rel="prev">
<link href="./../figures/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-3e476e15ae565c222d94875412ae43a1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-d3043699f4f525e226433170f63674df.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-09d31aecdfaed6635bc15332bd6d5cdd.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-f217443c5b0c50e22034f6b67fd2df8d.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="include/webex.css">
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./0021_R_calculator.html">First steps in R</a></li><li class="breadcrumb-item"><a href="./005_Importing_Data_in_R.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Importing data in R</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Working in R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/biostats-r/biostats" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Setting up R and RStudio</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0010_Getting_Started_with_RStudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Installing and configuring R and RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0011_projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">RStudio projects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0012_scripts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working with a script</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0013_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Installing packages</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">First steps in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0021_R_calculator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R as a calculator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0022_help.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Help!</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0023_objects_names.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Objects and names</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./002_V_is_for_vector.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">V is for vector</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0025_data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data structures beyond the vector</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./005_Importing_Data_in_R.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Importing data in R</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Data manipulation with the tidyverse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./010-pipes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Pipes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./011-tidyr-pivot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Tidying data with <code>tidyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./012-dplyr-single-table.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Working with single tables in <code>dplyr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./013-dplyr-multiple-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Working with multiple tables in <code>dplyr</code></span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Visualisation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./100_why_data_visualisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Why is data visualization important?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./101_getting_started_with_ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Getting started with ggplot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./103_different_types_of_vizualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Choosing your visualisation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./118_themes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Themes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./120_colour_shape_linetypes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Colours, shapes and linetypes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./125_ggplot_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Regression and ggplot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./130_patchwork.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Combining plots</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./140_maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Making maps in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./141-mathematical-notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Mathematical notation for plots</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./150_ggplot_environment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">ggplot2 helper packages</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Other Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./050_missing_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Handling missing values</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./060_bestiary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Bestiary of Brackets and other R notation</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p><a href="https://biostats.w.uib.no/"><img src="https://biostats.w.uib.no/files/2020/01/biostats-button-res2.png" title="bioST@TS | When biology adds up, at last…" class="img-fluid"></a> <br><a href="../index.html"><img src="../figures/icons_all.png" title="BioST@TS books" width="250" height="50"></a></p>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#what-are-tabular-data" id="toc-what-are-tabular-data" class="nav-link active" data-scroll-target="#what-are-tabular-data"><span class="header-section-number">11.1</span> What are tabular data?</a></li>
  <li><a href="#file-formats" id="toc-file-formats" class="nav-link" data-scroll-target="#file-formats"><span class="header-section-number">11.2</span> File formats</a></li>
  <li><a href="#delimited-files" id="toc-delimited-files" class="nav-link" data-scroll-target="#delimited-files"><span class="header-section-number">11.3</span> Delimited files</a></li>
  <li><a href="#know-your-data" id="toc-know-your-data" class="nav-link" data-scroll-target="#know-your-data"><span class="header-section-number">11.4</span> Know your data!</a></li>
  <li>
<a href="#importing-delimited-files" id="toc-importing-delimited-files" class="nav-link" data-scroll-target="#importing-delimited-files"><span class="header-section-number">11.5</span> Importing delimited files</a>
  <ul class="collapse">
<li><a href="#file-paths" id="toc-file-paths" class="nav-link" data-scroll-target="#file-paths"><span class="header-section-number">11.5.1</span> File paths</a></li>
  <li><a href="#delimiters" id="toc-delimiters" class="nav-link" data-scroll-target="#delimiters"><span class="header-section-number">11.5.2</span> Delimiters</a></li>
  <li><a href="#review-the-imported-data" id="toc-review-the-imported-data" class="nav-link" data-scroll-target="#review-the-imported-data"><span class="header-section-number">11.5.3</span> Review the imported data</a></li>
  <li><a href="#read_csv2" id="toc-read_csv2" class="nav-link" data-scroll-target="#read_csv2"><span class="header-section-number">11.5.4</span> read_csv2()</a></li>
  <li><a href="#useful-arguments" id="toc-useful-arguments" class="nav-link" data-scroll-target="#useful-arguments"><span class="header-section-number">11.5.5</span> Useful arguments</a></li>
  <li><a href="#white-space-delimited-files" id="toc-white-space-delimited-files" class="nav-link" data-scroll-target="#white-space-delimited-files"><span class="header-section-number">11.5.6</span> White space delimited files</a></li>
  </ul>
</li>
  <li><a href="#excel-files" id="toc-excel-files" class="nav-link" data-scroll-target="#excel-files"><span class="header-section-number">11.6</span> Excel files</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./0021_R_calculator.html">First steps in R</a></li><li class="breadcrumb-item"><a href="./005_Importing_Data_in_R.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Importing data in R</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Importing data in R</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i></button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>R can import data from files in many different formats. For example:</p>
<ul>
<li>csv files with the <code>readr</code> package</li>
<li>excel files with the <code>readxl</code> package</li>
<li>xlm files with the <code>xml2</code> package</li>
<li>netcdf files with the <code>ncdf4</code> package</li>
<li>shapefiles with the <code>sf</code> package</li>
</ul>
<p>In this chapter, you will learn how to import tabular data from an external text file as a tibble. We will use functions from the package <code>readr</code> which is part of the <code>tidyverse</code> package, so make sure that you have activated it with <code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Before we start
</div>
</div>
<div class="callout-body-container callout-body">
<p>You must be familiar with tibbles and data types (such as numeric, character, etc).</p>
<p>You will need the following packages (in addition to those installed earlier)</p>
<ul>
<li><code>here</code></li>
</ul>
<p><strong>You need to be working in an RStudio project</strong> (see <a href="0011_projects.html" class="quarto-xref"><span>Chapter 3</span></a>).</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>To import some data, you first need to download some.</p>
<p>We have made some files available which you can download with</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/zip-utils.html">use_zip</a></span><span class="op">(</span><span class="st">"biostats-r/biostats-data"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When asked, agree to delete the zip file.</p>
<p>This will make a new directory called something like “biostats-r-biostats-data-9db4ebe/”. Rename this directory “data”. You can do this in the RStudio file tab.</p>
</div>
</div>
<section id="what-are-tabular-data" class="level2" data-number="11.1"><h2 data-number="11.1" class="anchored" data-anchor-id="what-are-tabular-data">
<span class="header-section-number">11.1</span> What are tabular data?</h2>
<p>Tabular data are data that is organized in the form of a table with rows and columns. A table often has a header, i.e.&nbsp;an additional row that displays variable names. Here is an example of a formatted table with header:</p>
<div class="cell">
<div id="tbl-kable" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-kable-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.1: A simple table with header row
</figcaption><div aria-describedby="tbl-kable-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">month</th>
<th style="text-align: right;">temperature (Celsius)</th>
<th style="text-align: right;">precipitation (mm)</th>
<th style="text-align: right;">Wind (m/s)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">January</td>
<td style="text-align: right;">-3.4</td>
<td style="text-align: right;">29.4</td>
<td style="text-align: right;">1.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">February</td>
<td style="text-align: right;">-0.4</td>
<td style="text-align: right;">15.4</td>
<td style="text-align: right;">0.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">March</td>
<td style="text-align: right;">-1.7</td>
<td style="text-align: right;">57.6</td>
<td style="text-align: right;">1.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">april</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">May</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: right;">25.2</td>
<td style="text-align: right;">1.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">June</td>
<td style="text-align: right;">10.6</td>
<td style="text-align: right;">52.4</td>
<td style="text-align: right;">1.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">July</td>
<td style="text-align: right;">13.1</td>
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">August</td>
<td style="text-align: right;">12.8</td>
<td style="text-align: right;">67.4</td>
<td style="text-align: right;">0.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">September</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">79.0</td>
<td style="text-align: right;">1.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">October</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">18.2</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">November</td>
<td style="text-align: right;">-2.2</td>
<td style="text-align: right;">7.8</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">December</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">92.0</td>
<td style="text-align: right;">1.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In this example, the table consists of 4 variables (columns) and 12 observations (rows) in addition to the header (top row). All cell contents are clearly delimited.</p>
<p>Below is an example of a <em>non</em>-tabular dataset. This dataset is a list of profiles with recurrent fields (<code>Name</code>, <code>Position</code>, <code>Institution</code>). Each profile contains three lines with a <code>field:value</code> pair.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Name: Aud Halbritter
Position: Researcher
Institution: UiB
-----------------------------
Name: Jonathan Soule
Position: Senior Engineer
Institution: UiB
-----------------------------
Name: Richard J. Telford
Position: Associate Professor
Institution: UiB
-----------------------------</code></pre>
</div>
</div>
</section><section id="file-formats" class="level2" data-number="11.2"><h2 data-number="11.2" class="anchored" data-anchor-id="file-formats">
<span class="header-section-number">11.2</span> File formats</h2>
<p>Tabular data may be stored in files using various formats, spreadsheets, etc. The most common spreadsheets store data in their own, proprietary file format, e.g.&nbsp;MS Excel which produces <code>.xls</code> and <code>.xlsx</code> files. Such formats may be a limitation to data management in R. Simpler formats such as plain text files with <code>.txt</code> or <code>.csv</code> should always be preferred when saving data in spreadsheets.</p>
</section><section id="delimited-files" class="level2" data-number="11.3"><h2 data-number="11.3" class="anchored" data-anchor-id="delimited-files">
<span class="header-section-number">11.3</span> Delimited files</h2>
<p>One of the most common format for storing tabular data is plain text files with a delimiter between the columns. The delimiter is often a comma or a semi-colon, but other delimiters are possible including tabs.</p>
<p>Comma or semi-colon delimited files are known as CSV files, which stands for <strong>C</strong>omma-<strong>S</strong>eparated <strong>V</strong>alues, and often have a <code>.csv</code> extension. They may also have a <code>.txt</code> extension.</p>
<p>In a CSV-formatted file, the data is stored in a similar manner to this:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-csv-data" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of a CSV file in notepad.">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-csv-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/csv.png" class="img-fluid figure-img" style="width:75.0%" alt="Screenshot of a CSV file in notepad.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-csv-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.1: Contents of a CSV file viewed in the text editor Notepad
</figcaption></figure>
</div>
</div>
</div>
<p>For information, this file matches the example in <a href="#tbl-kable" class="quarto-xref">Table&nbsp;<span>11.1</span></a>. Each line corresponds to a row in the table (including header) and cell contents are separated with a comma <code>,</code>. Note that the period symbol <code>.</code> is used as decimal separator.</p>
<p>The use of commas in the CSV format is however not universal. Other symbols such as a semi-colon <code>;</code> may be used as a delimiter. This is the case in several European countries where commas are decimal separator. Here is the same data set as above, this time in the European format:</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="figures/csv2.png" class="img-fluid figure-img" style="width:75.0%" alt="Screenshot of a CSV file in notepad with columns separated by semi-colons"></p>
<figcaption><em>Contents of another CSV file</em></figcaption></figure>
</div>
</div>
</div>
</section><section id="know-your-data" class="level2" data-number="11.4"><h2 data-number="11.4" class="anchored" data-anchor-id="know-your-data">
<span class="header-section-number">11.4</span> Know your data!</h2>
<p>There are several reasons why different symbols are used in CSV files. Among these reasons are:</p>
<ul>
<li>locale, i.e.&nbsp;the parameters that define the language and regional settings (currency, time and date, number format setting) in use on your machine,</li>
<li>software-based preferences, the settings which are defined <em>by default</em> by the software that you have used to punch your data,</li>
<li>user-based preferences, the settings that <em>you</em> choose when punching or saving data.</li>
</ul>
<p>It is thus very important to know what your CSV file is made of. We therefore recommend to systematically inspect your data file before importing in R. One way to do it is to open the text file in a text editor (for example RStudio), or to read some of the file into R with <code>read_lines('file.txt')</code> (the <code>n_max</code> argument is useful if there is lots of data) and determine:</p>
<ul>
<li>which symbol is used as decimal separator (<code>,</code> or <code>.</code>)</li>
<li>which symbol is used as delimiter (<code>,</code> or <code>;</code>)</li>
<li>any extra lines of data that need removing</li>
</ul>
<p>Here is our previous example:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">read_lines</span><span class="op">(</span><span class="st">"data/weather.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "month,temperature (Celsius),precipitation (mm),Wind (m/s)"
 [2] "January,-3.4,29.4,1.3"                                    
 [3] "February,-0.4,15.4,0.9"                                   
 [4] "March,-1.7,57.6,1.7"                                      
 [5] "april,3.8,3.2,0.8"                                        
 [6] "May,5.1,25.2,1.4"                                         
 [7] "June,10.6,52.4,1.1"                                       
 [8] "July,13.1,65.0,1.0"                                       
 [9] "August,12.8,67.4,0.7"                                     
[10] "September,6.9,79.0,1.2"                                   
[11] "October,2.5,18.2,0.8"                                     
[12] "November,-2.2,7.8,0.8"                                    
[13] "December,1.5,92.0,1.5"                                    </code></pre>
</div>
</div>
<p>In this file, the decimal separator is <code>.</code> and the delimiter is <code>,</code>.</p>
</section><section id="importing-delimited-files" class="level2 page-columns page-full" data-number="11.5"><h2 data-number="11.5" class="anchored" data-anchor-id="importing-delimited-files">
<span class="header-section-number">11.5</span> Importing delimited files</h2>
<p>We can import delimited files such as csv files with <code><a href="https://readr.tidyverse.org/reference/read_delim.html">readr::read_delim()</a></code>. <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim()</a></code> will import the data as a tibble.</p>
<p>In the following example, we import the file <code>weather.csv</code> located in the subfolder <code>data</code> of the current RStudio project into the object <code>weather</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 12 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): month
dbl (3): temperature (Celsius), precipitation (mm), Wind (m/s)

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>When the function is executed, the console shows a short series of messages. In the frame above, the message <code>Column specification</code> tells you that the content of the column <code>month</code> has been recognized as of data type <code>character</code>, and that the three other columns have been recognized as <code>double</code> (which is similar to <code>numeric</code>).</p>
<p>Now the tibble <code>weather</code> is available in R as you may see in the tab <code>Environment</code> (see <a href="#fig-csv-env" class="quarto-xref">Figure&nbsp;<span>11.2</span></a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-csv-env" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshot of the environment tab showing one object &quot;weather&quot; with 12 obsevations and 4 variables. ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-csv-env-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/csv-env.png" class="img-fluid figure-img" style="width:100.0%" alt="Screenshot of the environment tab showing one object &quot;weather&quot; with 12 obsevations and 4 variables. ">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-csv-env-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.2: The <em>tibble</em> weather is now stored in R.
</figcaption></figure>
</div>
</div>
</div>
<p>You can display the table as follows:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   month     `temperature (Celsius)` `precipitation (mm)` `Wind (m/s)`
   &lt;chr&gt;                       &lt;dbl&gt;                &lt;dbl&gt;        &lt;dbl&gt;
 1 January                      -3.4                 29.4          1.3
 2 February                     -0.4                 15.4          0.9
 3 March                        -1.7                 57.6          1.7
 4 april                         3.8                  3.2          0.8
 5 May                           5.1                 25.2          1.4
 6 June                         10.6                 52.4          1.1
 7 July                         13.1                 65            1  
 8 August                       12.8                 67.4          0.7
 9 September                     6.9                 79            1.2
10 October                       2.5                 18.2          0.8
11 November                     -2.2                  7.8          0.8
12 December                      1.5                 92            1.5</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Remember to assign!
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you don’t assign (<code>&lt;-</code>) the imported data to a name, the tibble will be printed to the screen and then lost.</p>
</div>
</div>
<section id="file-paths" class="level3 page-columns page-full" data-number="11.5.1"><h3 data-number="11.5.1" class="anchored" data-anchor-id="file-paths">
<span class="header-section-number">11.5.1</span> File paths</h3>
<p>The first argument to <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim()</a></code> is <code>file</code>. This wants the location of the file on your computer. Before we can import a file, we have to find it!</p>
<p>You might be tempted to write the absolute path to the file, something like:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="st">"c:/user/bad13/documents/project/my_file.csv"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This would be a bad idea. Why? Because this path only works on your current computer (provided you don’t move the file). This code won’t work for anyone else, so you cannot share the code with your supervisor and have them run it, nor archive it with a manuscript. The code is not reproducible.</p>
<p>Much better is to a path relative to your RStudio project (remember to use an RStudio project - for more info about them, read <a href="0011_projects.html" class="quarto-xref"><span>Chapter 3</span></a>). If the contents of your RStudio project looked like this</p>
<div class="cell column-page-right">
<div class="cell-output cell-output-stdout">
<pre><code>.
├── R
│   ├── 01_import.R
│   └── 02_analyse.R
├── data
│   ├── 2022-3-24_lake-tilo-chemistry.csv
│   ├── 2022-3-24_lake-tilo-diatoms.csv
│   └── 2022-8-15_lake-tilo-diatoms.csv
├── my_project.Rproj
├── output
│   └── manuscript.pdf
└── quarto
    ├── manuscript.qmd
    └── references.bib</code></pre>
</div>
</div>
<p>Now we could use</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="st">"data/2022-3-24_lake-tilo-chemistry.csv"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to access the chemistry data. If we move the RStudio project to a different location on your computer, or another computer, the code will still work. You don’t even need to type the full name: just type the quote marks and a few characters and autocomplete will start making suggestions.</p>
<p>There is still a problem though. When we use a quarto document, the working directory is the directory where the quarto document is stored. This can cause some confusion, which we can avoid if we use the <code>here</code> package to find the RStudio project root.</p>
<p>Our import code would now look like this</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://here.r-lib.org/">"here"</a></span><span class="op">)</span></span>
<span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data/weather.csv"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using <code>here</code> is highly recommended.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Forward slashes and backslashes
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember to use forward slashes <code>/</code> to separate directories in the path. If you use back slashes <code>\</code>, you will get an error as these are used to escape the following character (e.g., <code>\t</code> is a tab). If you really want back slashes, use two of them <code>\\</code> as the first will escape the second. If you let autocomplete fill in your path, it will do it correctly</p>
</div>
</div>
</section><section id="delimiters" class="level3" data-number="11.5.2"><h3 data-number="11.5.2" class="anchored" data-anchor-id="delimiters">
<span class="header-section-number">11.5.2</span> Delimiters</h3>
<p>The second argument to <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim()</a></code> is the column delimiter <code>delim</code>.<br>
It used to be very important to specify the delimiter (or choose a function such as <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> that had it set by default), but, after a recent update, <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim()</a></code> will guess what the delimiter is and we only need to specify it if it gets it wrong.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Import the “weather.csv” data into R and assign it to an name.</p>
</div>
</div>
</section><section id="review-the-imported-data" class="level3" data-number="11.5.3"><h3 data-number="11.5.3" class="anchored" data-anchor-id="review-the-imported-data">
<span class="header-section-number">11.5.3</span> Review the imported data</h3>
<p>Once you have imported the data, it is important to inspect it to check that everything has worked as expected.</p>
<ul>
<li>does it have the correct number of columns (may indicate problems with the delimiter)</li>
<li>are the columns the expected type</li>
<li>are the values correct.</li>
</ul>
<p>To do this, we can print the object or <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code> it. We can also get details of the column specification</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readr.tidyverse.org/reference/spec.html">spec</a></span><span class="op">(</span><span class="va">weather</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cols(
  month = col_character(),
  `temperature (Celsius)` = col_double(),
  `precipitation (mm)` = col_double(),
  `Wind (m/s)` = col_double()
)</code></pre>
</div>
</div>
<p>Any parsing problems (for example if there text in a column that should be numeric) will be shown with <code><a href="https://readr.tidyverse.org/reference/problems.html">problems()</a></code></p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readr.tidyverse.org/reference/problems.html">problems</a></span><span class="op">(</span><span class="va">weather</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 5
# ℹ 5 variables: row &lt;int&gt;, col &lt;int&gt;, expected &lt;chr&gt;, actual &lt;chr&gt;, file &lt;chr&gt;</code></pre>
</div>
</div>
<p>Here, there are no parsing problems so we get a tibble with zero rows.</p>
<p>Let’s try another example. File weather2.csv has semi-colons as delimiters.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather2.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 12 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ";"
chr (2): month, Wind (m/s)
num (2): temperature (Celsius), precipitation (mm)

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readr.tidyverse.org/reference/spec.html">spec</a></span><span class="op">(</span><span class="va">weather</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>cols(
  month = col_character(),
  `temperature (Celsius)` = col_double(),
  `precipitation (mm)` = col_double(),
  `Wind (m/s)` = col_double()
)</code></pre>
</div>
</div>
<p>Here, the message <code>Column specification</code> tells you that the content of the columns <code>month</code> and <code>Wind (m/s)</code> has been recognized as of data type <code>character</code>, and that the two other columns have been recognized as <code>number</code>. While <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim()</a></code> got things right about the number of variables, something went wrong with the variables as we could expect <code>Wind (m/s)</code> to be recognized as <code>double</code>. To find out about this issue we need to review the imported data in the object <code>weather2</code> and compare it to the original file <code>weather2.csv</code>.</p>
<p>The example above shows the importance of carefully verifying that the imported data in R matches the original data set. The following figure compares the content of the file <code>weather2.csv</code> (<a href="#fig-comp-fig" class="quarto-xref">Figure&nbsp;<span>11.3</span></a> left) to the content of the object <code>weather2</code> (<a href="#fig-comp-fig" class="quarto-xref">Figure&nbsp;<span>11.3</span></a> right):</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-comp-fig" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Screenshots of the original text file with decimals separated by commas and the imported object in R, mostly without decimal separators ">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-comp-fig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/comp.png" class="img-fluid figure-img" style="width:100.0%" alt="Screenshots of the original text file with decimals separated by commas and the imported object in R, mostly without decimal separators ">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-comp-fig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.3: The data in the object does not match the data in the file.
</figcaption></figure>
</div>
</div>
</div>
<p>Looking at the rows in both pictures, one can understand that all commas have simply been ignored, excepted those in the last column. To solve that issue, you must impose the separator using <code>locale = locale(decimal_mark = ",")</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"data/weather2.csv"</span>,</span>
<span>  locale <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/locale.html">locale</a></span><span class="op">(</span>decimal_mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 12 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ";"
chr (1): month
dbl (3): temperature (Celsius), precipitation (mm), Wind (m/s)

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>The last column is now recognized as <code>double</code> and the data in the object <code>weather3</code> matches the data in the file:</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="figures/comp2.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption><em>The data in the object now matches the data in the file.</em></figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Decimal seperators
</div>
</div>
<div class="callout-body-container callout-body">
<p>While <code>readr</code> can guess the column delimiter, it cannot guess the decimal separator. The English/American standard is to use “.” as the separator. In Norway it is common to use a comma as the decimal separator (but “.” are also common). If you don’t specify the decimal separator, <code>readr</code> assumes that the comma is a thousand separator and ignores it. Then the values can be 10x higher than expected.</p>
</div>
</div>
</section><section id="read_csv2" class="level3" data-number="11.5.4"><h3 data-number="11.5.4" class="anchored" data-anchor-id="read_csv2">
<span class="header-section-number">11.5.4</span> read_csv2()</h3>
<p>A shortcut for files with a “;” as the column delimiter <strong>and</strong> commas as the decimal separator is <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv2()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather_csv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv2</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather2.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ Using "','" as decimal and "'.'" as grouping mark. Use `read_delim()` for more control.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 12 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ";"
chr (1): month
dbl (3): temperature (Celsius), precipitation (mm), Wind (m/s)

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Note the message above <code>Column specification</code> that indicates which symbols <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv2()</a></code> has considered when importing the data. The resulting tibble looks correct:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather_csv2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   month     `temperature (Celsius)` `precipitation (mm)` `Wind (m/s)`
   &lt;chr&gt;                       &lt;dbl&gt;                &lt;dbl&gt;        &lt;dbl&gt;
 1 January                      -3.4                 29.4          1.3
 2 February                     -0.4                 15.4          0.9
 3 March                        -1.7                 57.6          1.7
 4 april                         3.8                  3.2          0.8
 5 May                           5.1                 25.2          1.4
 6 June                         10.6                 52.4          1.1
 7 July                         13.1                 65            1  
 8 August                       12.8                 67.4          0.7
 9 September                     6.9                 79            1.2
10 October                       2.5                 18.2          0.8
11 November                     -2.2                  7.8          0.8
12 December                      1.5                 92            1.5</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Import the file weather2.csv. Make sure it has imported correctly.</p>
</div>
</div>
</section><section id="useful-arguments" class="level3" data-number="11.5.5"><h3 data-number="11.5.5" class="anchored" data-anchor-id="useful-arguments">
<span class="header-section-number">11.5.5</span> Useful arguments</h3>
<p><code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim()</a></code> and the other functions discussed above have a multitude of arguments that allow for adjusting the way data is read and displayed. Here we review a handful of them.</p>
<section id="n_max" class="level4" data-number="11.5.5.1"><h4 data-number="11.5.5.1" class="anchored" data-anchor-id="n_max">
<span class="header-section-number">11.5.5.1</span> n_max</h4>
<p><code>n_max</code> sets a limit to the number of <em>observations</em> to be read. Note that <code>n_max</code> does not consider the first row (header) of the data file as an observation.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"data/weather.csv"</span>,</span>
<span>  n_max <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  month    `temperature (Celsius)` `precipitation (mm)` `Wind (m/s)`
  &lt;chr&gt;                      &lt;dbl&gt;                &lt;dbl&gt;        &lt;dbl&gt;
1 January                     -3.4                 29.4          1.3
2 February                    -0.4                 15.4          0.9
3 March                       -1.7                 57.6          1.7
4 april                        3.8                  3.2          0.8
5 May                          5.1                 25.2          1.4
6 June                        10.6                 52.4          1.1</code></pre>
</div>
</div>
</section><section id="skip" class="level4" data-number="11.5.5.2"><h4 data-number="11.5.5.2" class="anchored" data-anchor-id="skip">
<span class="header-section-number">11.5.5.2</span> skip</h4>
<p>The argument <code>skip</code> may be used to skip rows when reading the data file.<br>
Be aware that:</p>
<ul>
<li>the header in the original data file counts as one row,</li>
<li>the first row that comes after those which have been skipped becomes the header for the resulting tibble.</li>
</ul>
<p>In the following example, we read the data file <code>weather.csv</code> and skip the first row:</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"data/weather.csv"</span>,</span>
<span>  skip <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 4
   January   `-3.4` `29.4` `1.3`
   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1 February    -0.4   15.4   0.9
 2 March       -1.7   57.6   1.7
 3 april        3.8    3.2   0.8
 4 May          5.1   25.2   1.4
 5 June        10.6   52.4   1.1
 6 July        13.1   65     1  
 7 August      12.8   67.4   0.7
 8 September    6.9   79     1.2
 9 October      2.5   18.2   0.8
10 November    -2.2    7.8   0.8
11 December     1.5   92     1.5</code></pre>
</div>
</div>
<p>As expected, the first row (with the header) is skipped, and the data from the observation <code>January</code> have become the header of the tibble. The argument <code>col_names()</code> introduced below will be useful for solving this issue.</p>
</section><section id="col_names" class="level4" data-number="11.5.5.3"><h4 data-number="11.5.5.3" class="anchored" data-anchor-id="col_names">
<span class="header-section-number">11.5.5.3</span> col_names</h4>
<p>The argument <code>col_names</code> may be used to define the name of the variables/columns of the tibble.</p>
<p><code>col_names =</code> may also be followed by the actual variable names that you want to use. In that case, write <code>col_names = c()</code> and list the names between the parentheses. Be aware that the first row of the original data file, which would have been the column names, will become the first row of the resulting tibble. This means that if you want to replace existing names, you should also use the <code>skip</code> argument.</p>
<p>Here is an example:</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"data/weather.csv"</span>,</span>
<span>  skip <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Month"</span>, <span class="st">"Temp"</span>, <span class="st">"Precip"</span>, <span class="st">"Wind"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">weather</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   Month      Temp Precip  Wind
   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1 January    -3.4   29.4   1.3
 2 February   -0.4   15.4   0.9
 3 March      -1.7   57.6   1.7
 4 april       3.8    3.2   0.8
 5 May         5.1   25.2   1.4
 6 June       10.6   52.4   1.1
 7 July       13.1   65     1  
 8 August     12.8   67.4   0.7
 9 September   6.9   79     1.2
10 October     2.5   18.2   0.8
11 November   -2.2    7.8   0.8
12 December    1.5   92     1.5</code></pre>
</div>
</div>
<p>If lots of column names are badly formatted, it may be easier to use <code><a href="https://sfirke.github.io/janitor/reference/clean_names.html">janitor::clean_names()</a></code> to improve them.</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather.csv"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">weather</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   month     temperature_celsius precipitation_mm wind_m_s
   &lt;chr&gt;                   &lt;dbl&gt;            &lt;dbl&gt;    &lt;dbl&gt;
 1 January                  -3.4             29.4      1.3
 2 February                 -0.4             15.4      0.9
 3 March                    -1.7             57.6      1.7
 4 april                     3.8              3.2      0.8
 5 May                       5.1             25.2      1.4
 6 June                     10.6             52.4      1.1
 7 July                     13.1             65        1  
 8 August                   12.8             67.4      0.7
 9 September                 6.9             79        1.2
10 October                   2.5             18.2      0.8
11 November                 -2.2              7.8      0.8
12 December                  1.5             92        1.5</code></pre>
</div>
</div>
</section><section id="col_types" class="level4" data-number="11.5.5.4"><h4 data-number="11.5.5.4" class="anchored" data-anchor-id="col_types">
<span class="header-section-number">11.5.5.4</span> col_types</h4>
<p>The argument <code>col_types</code> may be used to modify the data type of the variables. This is useful for example when you need to set a variable as <code>factor</code> whereas R has defined it as <code>character</code>. Here is an example with three simple variables.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/groups.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 9 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): group
dbl (2): ID, count

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>As the message clearly indicates, the first and last variables are recognized as <code>double</code> (i.e.&nbsp;<code>numeric</code>) while the second one is recognized as <code>character</code>. The tibble in the object <code>counts</code> displays as follows:</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">counts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
     ID group count
  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
1     1 A         5
2     2 A         3
3     3 A         2
4     4 B         4
5     5 B         5
6     6 B         8
7     7 C         1
8     8 C         2
9     9 C         9</code></pre>
</div>
</div>
<p>Let’s use <code>col_types = cols()</code> to manually set the data types to <code>double</code>, <code>factor</code> and <code>integer</code>, respectively.</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"data/groups.csv"</span>,</span>
<span>  col_types <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html">cols</a></span><span class="op">(</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_double</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">col_factor</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_atomic.html">col_integer</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now the tibble displays like this, with the correct data types for each column:</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">counts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
     ID group count
  &lt;dbl&gt; &lt;fct&gt; &lt;int&gt;
1     1 A         5
2     2 A         3
3     3 A         2
4     4 B         4
5     5 B         5
6     6 B         8
7     7 C         1
8     8 C         2
9     9 C         9</code></pre>
</div>
</div>
<p>If you only need to modify one or a few variables, you must name it/them when writing the code:</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"data/groups.csv"</span>,</span>
<span>  col_types <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html">cols</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_factor.html">col_factor</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The tibble displays like this:</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">counts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
     ID group count
  &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt;
1     1 A         5
2     2 A         3
3     3 A         2
4     4 B         4
5     5 B         5
6     6 B         8
7     7 C         1
8     8 C         2
9     9 C         9</code></pre>
</div>
</div>
<p><code>col_types</code> is particularly useful when importing tabular data that includes formatted dates. Dates are usually recognized as <code>character</code> when their format does not match the expected format set as default (locale, etc). In the following example, dates entered as <code>yyyy-mm-dd</code> in the last column are recognized as of type <code>date</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">countsdates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/groups-dates1.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 9 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (1): group
dbl  (2): ID, count
date (1): date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>However, in the example below, dates entered as <code>dd-mm-yyyy</code> are converted to <code>character</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">countsdates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/groups-dates2.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 9 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): group, date
dbl (2): ID, count

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>To solve this issue, add the function <code><a href="https://readr.tidyverse.org/reference/parse_datetime.html">col_date()</a></code> in <code><a href="https://readr.tidyverse.org/reference/cols.html">cols()</a></code> to help R understand how dates are formatted and shall be read.</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">countsdates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"data/groups-dates2.csv"</span>,</span>
<span>  col_types <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html">cols</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_datetime.html">col_date</a></span><span class="op">(</span><span class="st">"%d-%m-%Y"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The result is the following tibble now correctly formatted:</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">countsdates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
     ID group count date      
  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;date&gt;    
1     1 A         5 2021-03-01
2     2 A         3 2021-03-02
3     3 A         2 2021-03-03
4     4 B         4 2021-03-01
5     5 B         5 2021-03-02
6     6 B         8 2021-03-03
7     7 C         1 2021-03-01
8     8 C         2 2021-03-02
9     9 C         9 2021-03-03</code></pre>
</div>
</div>
<p>You will find the whole list of <code><a href="https://readr.tidyverse.org/reference/cols.html">cols()</a></code> parameters for <code>col_types</code> <a href="https://readr.tidyverse.org/reference/cols.html" target="_blank">here</a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Import the data from “biomass2015_H.csv”. These data are plant biomass data from an alpine grassland near Mt Gonga, China.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Very large files
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>readr</code> imports objects into the computers memory. This is fine for most datasets. But very large datasets (gigabytes) - will not fit into memory and another solution is needed. We can use apache arrow with the <a href="https://arrow.apache.org/docs/r/articles/dataset.html"><code>arrow</code> package</a> or duckDB with <a href="https://duckplyr.tidyverse.org/">duckplyr</a>. Both can work with <code>dplyr</code> functions to process large datasets efficiently.</p>
</div>
</div>
</section></section><section id="white-space-delimited-files" class="level3" data-number="11.5.6"><h3 data-number="11.5.6" class="anchored" data-anchor-id="white-space-delimited-files">
<span class="header-section-number">11.5.6</span> White space delimited files</h3>
<p>Some files have white space separating the columns. If a single tab is used then <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim()</a></code> will automatically detect it and work correctly. Sometimes multiple spaces are used so the columns line up, making the text file easy for humans to read. <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim()</a></code> will not work with these files as it expects a single delimiter. Instead we can use <code><a href="https://readr.tidyverse.org/reference/read_table.html">read_table()</a></code>, shown here with some test data.</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="st">" Species   Value</span></span>
<span><span class="st">            Navicula       1</span></span>
<span><span class="st">            Cymbella       2"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  Species  Value
  &lt;chr&gt;    &lt;dbl&gt;
1 Navicula     1
2 Cymbella     2</code></pre>
</div>
</div>
<p>Another type of data you will sometimes see is the fixed width format. There are no delimiters, but each field has the same position in each row. These files can be imported with <code><a href="https://readr.tidyverse.org/reference/read_fwf.html">read_fwf()</a></code>. Determining the position of each column can be painful unless you have good metadata.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Import part “3a. Clegg et al.&nbsp;2011 Hudson Lake Midge Temperature Data” from “alaska2011midge-t.txt”</p>
<details><summary>
Hint
</summary><code>skip</code> and <code>n_max</code> argument can be useful.
</details>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reading multiple files
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you want to read many files with the <strong>same structure</strong>, you can supply <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim()</a></code> with a vector of files names.</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># get a vector of files</span></span>
<span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"data/"</span>, pattern <span class="op">=</span> <span class="st">"csv"</span><span class="op">)</span></span>
<span><span class="va">files</span></span>
<span><span class="co">#&gt; file1.csv file2.csv</span></span>
<span></span>
<span><span class="co"># read them in at once</span></span>
<span><span class="co"># record paths in a column called filename</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">files</span>, id <span class="op">=</span> <span class="st">"filename"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span><span class="co">#&gt;   filename      x     y</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 file1.csv     1     2</span></span>
<span><span class="co">#&gt; 2 file1.csv     3     4</span></span>
<span><span class="co">#&gt; 3 file2.csv     5     6</span></span>
<span><span class="co">#&gt; 4 file2.csv     7     8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If the files do not have identical structures, perhaps one of the files has text where it should have a number, you either have to use the <code>col_types</code> argument to convert everything to the same format, or iterate (<span class="quarto-unresolved-ref">?sec-iterate</span>) over the files to import and fix them.</p>
</div>
</div>
</section></section><section id="excel-files" class="level2 page-columns page-full" data-number="11.6"><h2 data-number="11.6" class="anchored" data-anchor-id="excel-files">
<span class="header-section-number">11.6</span> Excel files</h2>
<p>Even though we don’t recommend you use Excel files for your own data, you need to know how to import such data as you may be given Excel files for find them in a data repository. To make your analysis reproducible, it is important to keep the files in their original format rather than converting them to CSV so that all the processing is done with code.</p>
<p>Excel files can be imported with the <code>readxl</code> package which is installed with <code>tidyverse</code> but not loaded until you run <code><a href="https://readxl.tidyverse.org">library(readxl)</a></code>. The function <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> will import the data; it can be worth using <code><a href="https://readxl.tidyverse.org/reference/excel_sheets.html">excel_sheets()</a></code> first to check the names of the sheets.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://readxl.tidyverse.org/reference/excel_sheets.html">excel_sheets</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"data/biomass2015.xls"</span><span class="op">)</span></span>
<span><span class="va">biomass_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"data/biomass2015.xls"</span>, sheet <span class="op">=</span> <span class="st">"Site L"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Many of the arguments for skipping rows at the start of the file, enforcing column types, etc, are similar to those in <code><a href="https://readr.tidyverse.org/reference/read_delim.html">readr::read_delim()</a></code></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Import the biomass data from Site A from biomass2015.xls</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Further Reading
</div>
</div>
<div class="callout-body-container callout-body">
<p>You may find the following links useful:</p>
<ul>
<li><a href="https://r4ds.had.co.nz/data-import.html" target="_blank">R for Data Science - Data import</a></li>
<li><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-import.pdf" target="_blank">Data Import Cheatsheet - readr/readxl</a></li>
<li><a href="https://readr.tidyverse.org/" target="_blank">readr</a></li>
</ul>
</div>
</div>


<!-- -->

<div class="no-row-height column-margin column-container"><section id="contributors" class="level3 unlisted unnumbered"><h3 class="unlisted unnumbered anchored" data-anchor-id="contributors">Contributors</h3>
<ul>
<li>Jonathan Soulé</li>
<li>Aud Halbritter</li>
<li>Richard Telford</li>
</ul></section></div></section></main><!-- /main --><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./0025_data_structures.html" class="pagination-link" aria-label="Data structures beyond the vector">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data structures beyond the vector</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./010-pipes.html" class="pagination-link" aria-label="Pipes">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Pipes</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb59" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="in">``` {r setup, include=FALSE}</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="in">source("R/setup.R")</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Importing data in R</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>R can import data from files in many different formats. </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>For example:</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>csv files with the <span class="in">`readr`</span> package</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>excel files with the <span class="in">`readxl`</span> package</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>xlm files with the <span class="in">`xml2`</span> package</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>netcdf files with the <span class="in">`ncdf4`</span> package</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>shapefiles with the <span class="in">`sf`</span> package</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>In this chapter, you will learn how to import tabular data from an external text file as a tibble.</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>We will use functions from the package <span class="in">`readr`</span> which is part of the <span class="in">`tidyverse`</span> package, so make sure that you have activated it with <span class="in">`library(tidyverse)`</span>. </span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Before we start</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>You must be familiar with tibbles and data types (such as numeric, character, etc).</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>You will need the following packages (in addition to those installed earlier)</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`here`</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>**You need to be working in an RStudio project** (see @sec-working-project).</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise</span></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>To import some data, you first need to download some. </span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>We have made some files available which you can download with </span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: download</span></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_zip</span>(<span class="st">"biostats-r/biostats-data"</span>)</span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>When asked, agree to delete the zip file.</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a>This will make a new directory called something like "biostats-r-biostats-data-9db4ebe/".</span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>Rename this directory "data". </span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>You can do this in the RStudio file tab.</span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## What are tabular data? </span></span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a>Tabular data are data that is organized in the form of a table with rows and columns. </span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a>A table often has a header, i.e. an additional row that displays variable names.</span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a>Here is an example of a formatted table with header:</span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a><span class="in">``` {r}</span></span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: tbl-kable</span></span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: A simple table with header row</span></span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a><span class="in">table &lt;- read_delim(file = "data/weather.csv")</span></span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::kable(table)</span></span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a>In this example, the table consists of 4 variables (columns) and 12 observations (rows) in addition to the header (top row). </span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a>All cell contents are clearly delimited.  </span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true" tabindex="-1"></a>Below is an example of a *non*-tabular dataset. </span>
<span id="cb59-74"><a href="#cb59-74" aria-hidden="true" tabindex="-1"></a>This dataset is a list of profiles with recurrent fields (<span class="in">`Name`</span>, <span class="in">`Position`</span>, <span class="in">`Institution`</span>). </span>
<span id="cb59-75"><a href="#cb59-75" aria-hidden="true" tabindex="-1"></a>Each profile contains three lines with a <span class="in">`field:value`</span> pair. </span>
<span id="cb59-76"><a href="#cb59-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-77"><a href="#cb59-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r nontabular, echo = FALSE}</span></span>
<span id="cb59-78"><a href="#cb59-78" aria-hidden="true" tabindex="-1"></a><span class="in">cat(readLines("data/profile.txt"), sep = "\n")</span></span>
<span id="cb59-79"><a href="#cb59-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-80"><a href="#cb59-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-81"><a href="#cb59-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-82"><a href="#cb59-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-83"><a href="#cb59-83" aria-hidden="true" tabindex="-1"></a><span class="fu">## File formats</span></span>
<span id="cb59-84"><a href="#cb59-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-85"><a href="#cb59-85" aria-hidden="true" tabindex="-1"></a>Tabular data may be stored in files using various formats, spreadsheets, etc. </span>
<span id="cb59-86"><a href="#cb59-86" aria-hidden="true" tabindex="-1"></a>The most common spreadsheets store data in their own, proprietary file format, e.g. MS Excel which produces <span class="in">`.xls`</span> and <span class="in">`.xlsx`</span> files.</span>
<span id="cb59-87"><a href="#cb59-87" aria-hidden="true" tabindex="-1"></a>Such formats may be a limitation to data management in R.</span>
<span id="cb59-88"><a href="#cb59-88" aria-hidden="true" tabindex="-1"></a>Simpler formats such as plain text files with <span class="in">`.txt`</span> or <span class="in">`.csv`</span> should always be preferred when saving data in spreadsheets.</span>
<span id="cb59-89"><a href="#cb59-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-90"><a href="#cb59-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-91"><a href="#cb59-91" aria-hidden="true" tabindex="-1"></a><span class="fu">## Delimited files</span></span>
<span id="cb59-92"><a href="#cb59-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-93"><a href="#cb59-93" aria-hidden="true" tabindex="-1"></a>One of the most common format for storing tabular data is plain text files with a delimiter between the columns.</span>
<span id="cb59-94"><a href="#cb59-94" aria-hidden="true" tabindex="-1"></a>The delimiter is often a comma or a semi-colon, but other delimiters are possible including tabs.</span>
<span id="cb59-95"><a href="#cb59-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-96"><a href="#cb59-96" aria-hidden="true" tabindex="-1"></a>Comma or semi-colon delimited files are known as CSV files, which stands for **C**omma-**S**eparated **V**alues, and often have a <span class="in">`.csv`</span> extension. They may also have a <span class="in">`.txt`</span> extension.  </span>
<span id="cb59-97"><a href="#cb59-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-98"><a href="#cb59-98" aria-hidden="true" tabindex="-1"></a>In a CSV-formatted file, the data is stored in a similar manner to this: </span>
<span id="cb59-99"><a href="#cb59-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-100"><a href="#cb59-100" aria-hidden="true" tabindex="-1"></a><span class="in">``` {r}</span></span>
<span id="cb59-101"><a href="#cb59-101" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-csv-data</span></span>
<span id="cb59-102"><a href="#cb59-102" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb59-103"><a href="#cb59-103" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Contents of a CSV file viewed in the text editor Notepad</span></span>
<span id="cb59-104"><a href="#cb59-104" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-alt: Screenshot of a CSV file in notepad.</span></span>
<span id="cb59-105"><a href="#cb59-105" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "75%"</span></span>
<span id="cb59-106"><a href="#cb59-106" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("figures/csv.png")</span></span>
<span id="cb59-107"><a href="#cb59-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-108"><a href="#cb59-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-109"><a href="#cb59-109" aria-hidden="true" tabindex="-1"></a>For information, this file matches the example in @tbl-kable.</span>
<span id="cb59-110"><a href="#cb59-110" aria-hidden="true" tabindex="-1"></a>Each line corresponds to a row in the table (including header) and cell contents are separated with a comma <span class="in">`,`</span>.</span>
<span id="cb59-111"><a href="#cb59-111" aria-hidden="true" tabindex="-1"></a>Note that the period symbol <span class="in">`.`</span> is used as decimal separator.</span>
<span id="cb59-112"><a href="#cb59-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-113"><a href="#cb59-113" aria-hidden="true" tabindex="-1"></a>The use of commas in the CSV format is however not universal. </span>
<span id="cb59-114"><a href="#cb59-114" aria-hidden="true" tabindex="-1"></a>Other symbols such as a semi-colon <span class="in">`;`</span> may be used as a delimiter.</span>
<span id="cb59-115"><a href="#cb59-115" aria-hidden="true" tabindex="-1"></a>This is the case in several European countries where commas are decimal separator.</span>
<span id="cb59-116"><a href="#cb59-116" aria-hidden="true" tabindex="-1"></a>Here is the same data set as above, this time in the European format:</span>
<span id="cb59-117"><a href="#cb59-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-120"><a href="#cb59-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-121"><a href="#cb59-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: csv2-data</span></span>
<span id="cb59-122"><a href="#cb59-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-123"><a href="#cb59-123" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "_Contents of another CSV file_"</span></span>
<span id="cb59-124"><a href="#cb59-124" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: Screenshot of a CSV file in notepad with columns separated by semi-colons</span></span>
<span id="cb59-125"><a href="#cb59-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| out.width: "75%"</span></span>
<span id="cb59-126"><a href="#cb59-126" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/csv2.png"</span>)</span>
<span id="cb59-127"><a href="#cb59-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-128"><a href="#cb59-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-129"><a href="#cb59-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-130"><a href="#cb59-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-131"><a href="#cb59-131" aria-hidden="true" tabindex="-1"></a><span class="fu">## Know your data!</span></span>
<span id="cb59-132"><a href="#cb59-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-133"><a href="#cb59-133" aria-hidden="true" tabindex="-1"></a>There are several reasons why different symbols are used in CSV files.</span>
<span id="cb59-134"><a href="#cb59-134" aria-hidden="true" tabindex="-1"></a>Among these reasons are:</span>
<span id="cb59-135"><a href="#cb59-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-136"><a href="#cb59-136" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>locale, i.e. the parameters that define the language and regional settings (currency, time and date, number format setting) in use on your machine,</span>
<span id="cb59-137"><a href="#cb59-137" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>software-based preferences, the settings which are defined _by default_ by the software that you have used to punch your data,</span>
<span id="cb59-138"><a href="#cb59-138" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>user-based preferences, the settings that _you_ choose when punching or saving data.</span>
<span id="cb59-139"><a href="#cb59-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-140"><a href="#cb59-140" aria-hidden="true" tabindex="-1"></a>It is thus very important to know what your CSV file is made of.</span>
<span id="cb59-141"><a href="#cb59-141" aria-hidden="true" tabindex="-1"></a>We therefore recommend to systematically inspect your data file before importing in R.</span>
<span id="cb59-142"><a href="#cb59-142" aria-hidden="true" tabindex="-1"></a>One way to do it is to open the text file in a text editor (for example RStudio), or to read some of the file into R with <span class="in">`read_lines('file.txt')`</span> (the <span class="in">`n_max`</span> argument is useful if there is lots of data) and determine:</span>
<span id="cb59-143"><a href="#cb59-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-144"><a href="#cb59-144" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>which symbol is used as decimal separator (<span class="in">`,`</span> or <span class="in">`.`</span>)</span>
<span id="cb59-145"><a href="#cb59-145" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>which symbol is used as delimiter (<span class="in">`,`</span> or <span class="in">`;`</span>)</span>
<span id="cb59-146"><a href="#cb59-146" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>any extra lines of data that need removing</span>
<span id="cb59-147"><a href="#cb59-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-148"><a href="#cb59-148" aria-hidden="true" tabindex="-1"></a>Here is our previous example:</span>
<span id="cb59-149"><a href="#cb59-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r readLines, echo = TRUE}</span></span>
<span id="cb59-150"><a href="#cb59-150" aria-hidden="true" tabindex="-1"></a><span class="in">read_lines("data/weather.csv")</span></span>
<span id="cb59-151"><a href="#cb59-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-152"><a href="#cb59-152" aria-hidden="true" tabindex="-1"></a>In this file, the decimal separator is <span class="in">`.`</span> and the delimiter is <span class="in">`,`</span>.</span>
<span id="cb59-153"><a href="#cb59-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-154"><a href="#cb59-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-155"><a href="#cb59-155" aria-hidden="true" tabindex="-1"></a><span class="fu">## Importing delimited files</span></span>
<span id="cb59-156"><a href="#cb59-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-157"><a href="#cb59-157" aria-hidden="true" tabindex="-1"></a>We can import delimited files such as csv files with <span class="in">`readr::read_delim()`</span>.</span>
<span id="cb59-158"><a href="#cb59-158" aria-hidden="true" tabindex="-1"></a><span class="in">`read_delim()`</span> will import the data as a tibble.</span>
<span id="cb59-159"><a href="#cb59-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-160"><a href="#cb59-160" aria-hidden="true" tabindex="-1"></a>In the following example, we import the file <span class="in">`weather.csv`</span> located in the subfolder <span class="in">`data`</span> of the current RStudio project into the object <span class="in">`weather`</span>. </span>
<span id="cb59-161"><a href="#cb59-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-164"><a href="#cb59-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-165"><a href="#cb59-165" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: delim-csv</span></span>
<span id="cb59-166"><a href="#cb59-166" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-167"><a href="#cb59-167" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: true</span></span>
<span id="cb59-168"><a href="#cb59-168" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb59-169"><a href="#cb59-169" aria-hidden="true" tabindex="-1"></a>weather <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="at">file =</span> <span class="st">"data/weather.csv"</span>)</span>
<span id="cb59-170"><a href="#cb59-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-171"><a href="#cb59-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-172"><a href="#cb59-172" aria-hidden="true" tabindex="-1"></a>When the function is executed, the console shows a short series of messages.</span>
<span id="cb59-173"><a href="#cb59-173" aria-hidden="true" tabindex="-1"></a>In the frame above, the message <span class="in">`Column specification`</span> tells you that the content of the column <span class="in">`month`</span> has been recognized as of data type <span class="in">`character`</span>, and that the three other columns have been recognized as <span class="in">`double`</span> (which is similar to <span class="in">`numeric`</span>).  </span>
<span id="cb59-174"><a href="#cb59-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-175"><a href="#cb59-175" aria-hidden="true" tabindex="-1"></a>Now the tibble <span class="in">`weather`</span> is available in R as you may see in the tab <span class="in">`Environment`</span> (see @fig-csv-env). </span>
<span id="cb59-176"><a href="#cb59-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-177"><a href="#cb59-177" aria-hidden="true" tabindex="-1"></a><span class="in">``` {r} </span></span>
<span id="cb59-178"><a href="#cb59-178" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-csv-env</span></span>
<span id="cb59-179"><a href="#cb59-179" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb59-180"><a href="#cb59-180" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: The _tibble_ weather is now stored in R.</span></span>
<span id="cb59-181"><a href="#cb59-181" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-alt: &gt;</span></span>
<span id="cb59-182"><a href="#cb59-182" aria-hidden="true" tabindex="-1"></a><span class="in">#|   Screenshot of the environment tab showing one object "weather" with 12</span></span>
<span id="cb59-183"><a href="#cb59-183" aria-hidden="true" tabindex="-1"></a><span class="in">#|   obsevations and 4 variables.</span></span>
<span id="cb59-184"><a href="#cb59-184" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "100%"</span></span>
<span id="cb59-185"><a href="#cb59-185" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("figures/csv-env.png")</span></span>
<span id="cb59-186"><a href="#cb59-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-187"><a href="#cb59-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-188"><a href="#cb59-188" aria-hidden="true" tabindex="-1"></a>You can display the table as follows:</span>
<span id="cb59-189"><a href="#cb59-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-190"><a href="#cb59-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r weather, echo=TRUE} </span></span>
<span id="cb59-191"><a href="#cb59-191" aria-hidden="true" tabindex="-1"></a><span class="in">weather</span></span>
<span id="cb59-192"><a href="#cb59-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-193"><a href="#cb59-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-194"><a href="#cb59-194" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb59-195"><a href="#cb59-195" aria-hidden="true" tabindex="-1"></a><span class="fu">## Remember to assign!</span></span>
<span id="cb59-196"><a href="#cb59-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-197"><a href="#cb59-197" aria-hidden="true" tabindex="-1"></a>If you don't assign (<span class="in">`&lt;-`</span>) the imported data to a name, the tibble will be printed to the screen and then lost. </span>
<span id="cb59-198"><a href="#cb59-198" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-199"><a href="#cb59-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-200"><a href="#cb59-200" aria-hidden="true" tabindex="-1"></a><span class="fu">### File paths</span></span>
<span id="cb59-201"><a href="#cb59-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-202"><a href="#cb59-202" aria-hidden="true" tabindex="-1"></a>The first argument to <span class="in">`read_delim()`</span> is <span class="in">`file`</span>. </span>
<span id="cb59-203"><a href="#cb59-203" aria-hidden="true" tabindex="-1"></a>This wants the location of the file on your computer.</span>
<span id="cb59-204"><a href="#cb59-204" aria-hidden="true" tabindex="-1"></a>Before we can import a file, we have to find it!</span>
<span id="cb59-205"><a href="#cb59-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-206"><a href="#cb59-206" aria-hidden="true" tabindex="-1"></a>You might be tempted to write the absolute path to the file, something like:</span>
<span id="cb59-207"><a href="#cb59-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-208"><a href="#cb59-208" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb59-209"><a href="#cb59-209" aria-hidden="true" tabindex="-1"></a><span class="st">"c:/user/bad13/documents/project/my_file.csv"</span></span>
<span id="cb59-210"><a href="#cb59-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-211"><a href="#cb59-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-212"><a href="#cb59-212" aria-hidden="true" tabindex="-1"></a>This would be a bad idea. </span>
<span id="cb59-213"><a href="#cb59-213" aria-hidden="true" tabindex="-1"></a>Why?</span>
<span id="cb59-214"><a href="#cb59-214" aria-hidden="true" tabindex="-1"></a>Because this path only works on your current computer (provided you don't move the file). </span>
<span id="cb59-215"><a href="#cb59-215" aria-hidden="true" tabindex="-1"></a>This code won't work for anyone else, so you cannot share the code with your supervisor and have them run it, nor archive it with a manuscript. </span>
<span id="cb59-216"><a href="#cb59-216" aria-hidden="true" tabindex="-1"></a>The code is not reproducible.</span>
<span id="cb59-217"><a href="#cb59-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-218"><a href="#cb59-218" aria-hidden="true" tabindex="-1"></a>Much better is to a path relative to your RStudio project (remember to use an RStudio project - for more info about them, read @sec-working-project).</span>
<span id="cb59-219"><a href="#cb59-219" aria-hidden="true" tabindex="-1"></a>If the contents of your RStudio project looked like this</span>
<span id="cb59-220"><a href="#cb59-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-223"><a href="#cb59-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-224"><a href="#cb59-224" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: file-tree</span></span>
<span id="cb59-225"><a href="#cb59-225" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-right</span></span>
<span id="cb59-226"><a href="#cb59-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-227"><a href="#cb59-227" aria-hidden="true" tabindex="-1"></a><span class="do">## good</span></span>
<span id="cb59-228"><a href="#cb59-228" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs)</span>
<span id="cb59-229"><a href="#cb59-229" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">"demo2"</span>)</span>
<span id="cb59-230"><a href="#cb59-230" aria-hidden="true" tabindex="-1"></a><span class="fu">dir_create</span>(tmp)</span>
<span id="cb59-231"><a href="#cb59-231" aria-hidden="true" tabindex="-1"></a>withr<span class="sc">::</span><span class="fu">with_dir</span>(tmp, {</span>
<span id="cb59-232"><a href="#cb59-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file_create</span>(<span class="st">"my_project.Rproj"</span>)</span>
<span id="cb59-233"><a href="#cb59-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir_create</span>(<span class="st">"data"</span>)</span>
<span id="cb59-234"><a href="#cb59-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file_create</span>(<span class="st">"data/2022-8-15_lake-tilo-diatoms.csv"</span>)</span>
<span id="cb59-235"><a href="#cb59-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file_create</span>(<span class="st">"data/2022-3-24_lake-tilo-diatoms.csv"</span>)</span>
<span id="cb59-236"><a href="#cb59-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file_create</span>(<span class="st">"data/2022-3-24_lake-tilo-chemistry.csv"</span>)</span>
<span id="cb59-237"><a href="#cb59-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir_create</span>(<span class="st">"R"</span>)</span>
<span id="cb59-238"><a href="#cb59-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file_create</span>(<span class="st">"R/01_import.R"</span>)</span>
<span id="cb59-239"><a href="#cb59-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file_create</span>(<span class="st">"R/02_analyse.R"</span>)</span>
<span id="cb59-240"><a href="#cb59-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-241"><a href="#cb59-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir_create</span>(<span class="st">"quarto"</span>)</span>
<span id="cb59-242"><a href="#cb59-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file_create</span>(<span class="st">"quarto/manuscript.qmd"</span>)</span>
<span id="cb59-243"><a href="#cb59-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file_create</span>(<span class="st">"quarto/references.bib"</span>)</span>
<span id="cb59-244"><a href="#cb59-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir_create</span>(<span class="st">"output"</span>)</span>
<span id="cb59-245"><a href="#cb59-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file_create</span>(<span class="st">"output/manuscript.pdf"</span>)</span>
<span id="cb59-246"><a href="#cb59-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-247"><a href="#cb59-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir_tree</span>()</span>
<span id="cb59-248"><a href="#cb59-248" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb59-249"><a href="#cb59-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-250"><a href="#cb59-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-251"><a href="#cb59-251" aria-hidden="true" tabindex="-1"></a>Now we could use</span>
<span id="cb59-252"><a href="#cb59-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-253"><a href="#cb59-253" aria-hidden="true" tabindex="-1"></a><span class="in">``` r</span></span>
<span id="cb59-254"><a href="#cb59-254" aria-hidden="true" tabindex="-1"></a><span class="st">"data/2022-3-24_lake-tilo-chemistry.csv"</span></span>
<span id="cb59-255"><a href="#cb59-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-256"><a href="#cb59-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-257"><a href="#cb59-257" aria-hidden="true" tabindex="-1"></a>to access the chemistry data.</span>
<span id="cb59-258"><a href="#cb59-258" aria-hidden="true" tabindex="-1"></a>If we move the RStudio project to a different location on your computer, or another computer, the code will still work.</span>
<span id="cb59-259"><a href="#cb59-259" aria-hidden="true" tabindex="-1"></a>You don't even need to type the full name: just type the quote marks and a few characters and autocomplete will start making suggestions.</span>
<span id="cb59-260"><a href="#cb59-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-261"><a href="#cb59-261" aria-hidden="true" tabindex="-1"></a>There is still a problem though. </span>
<span id="cb59-262"><a href="#cb59-262" aria-hidden="true" tabindex="-1"></a>When we use a quarto document, the working directory is the directory where the quarto document is stored. </span>
<span id="cb59-263"><a href="#cb59-263" aria-hidden="true" tabindex="-1"></a>This can cause some confusion, which we can avoid if we use the <span class="in">`here`</span> package to find the RStudio project root.</span>
<span id="cb59-264"><a href="#cb59-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-265"><a href="#cb59-265" aria-hidden="true" tabindex="-1"></a>Our import code would now look like this</span>
<span id="cb59-266"><a href="#cb59-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-267"><a href="#cb59-267" aria-hidden="true" tabindex="-1"></a><span class="in">```{r here, echo=TRUE, eval = FALSE} </span></span>
<span id="cb59-268"><a href="#cb59-268" aria-hidden="true" tabindex="-1"></a><span class="in">library("here")</span></span>
<span id="cb59-269"><a href="#cb59-269" aria-hidden="true" tabindex="-1"></a><span class="in">weather &lt;- read_delim(file = here("data/weather.csv"))</span></span>
<span id="cb59-270"><a href="#cb59-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-271"><a href="#cb59-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-272"><a href="#cb59-272" aria-hidden="true" tabindex="-1"></a>Using <span class="in">`here`</span> is highly recommended.</span>
<span id="cb59-273"><a href="#cb59-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-274"><a href="#cb59-274" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb59-275"><a href="#cb59-275" aria-hidden="true" tabindex="-1"></a><span class="fu">## Forward slashes and backslashes</span></span>
<span id="cb59-276"><a href="#cb59-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-277"><a href="#cb59-277" aria-hidden="true" tabindex="-1"></a>Remember to use forward slashes <span class="in">`/`</span> to separate directories in the path. </span>
<span id="cb59-278"><a href="#cb59-278" aria-hidden="true" tabindex="-1"></a>If you use back slashes <span class="in">`\`</span>, you will get an error as these are used to escape the following character (e.g., <span class="in">`\t`</span> is a tab). </span>
<span id="cb59-279"><a href="#cb59-279" aria-hidden="true" tabindex="-1"></a>If you really want back slashes, use two of them <span class="in">`\\`</span> as the first will escape the second.</span>
<span id="cb59-280"><a href="#cb59-280" aria-hidden="true" tabindex="-1"></a>If you let autocomplete fill in your path, it will do it correctly</span>
<span id="cb59-281"><a href="#cb59-281" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-282"><a href="#cb59-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-283"><a href="#cb59-283" aria-hidden="true" tabindex="-1"></a><span class="fu">### Delimiters</span></span>
<span id="cb59-284"><a href="#cb59-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-285"><a href="#cb59-285" aria-hidden="true" tabindex="-1"></a>The second argument to <span class="in">`read_delim()`</span> is the column delimiter <span class="in">`delim`</span>.  </span>
<span id="cb59-286"><a href="#cb59-286" aria-hidden="true" tabindex="-1"></a>It used to be very important to specify the delimiter (or choose a function such as <span class="in">`read_csv()`</span> that had it set by default), but, after a recent update, <span class="in">`read_delim()`</span> will guess what the delimiter is and we only need to specify it if it gets it wrong.</span>
<span id="cb59-287"><a href="#cb59-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-288"><a href="#cb59-288" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb59-289"><a href="#cb59-289" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise</span></span>
<span id="cb59-290"><a href="#cb59-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-291"><a href="#cb59-291" aria-hidden="true" tabindex="-1"></a>Import the "weather.csv" data into R and assign it to an name.</span>
<span id="cb59-292"><a href="#cb59-292" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-293"><a href="#cb59-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-294"><a href="#cb59-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-295"><a href="#cb59-295" aria-hidden="true" tabindex="-1"></a><span class="fu">### Review the imported data</span></span>
<span id="cb59-296"><a href="#cb59-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-297"><a href="#cb59-297" aria-hidden="true" tabindex="-1"></a>Once you have imported the data, it is important to inspect it to check that everything has worked as expected.</span>
<span id="cb59-298"><a href="#cb59-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-299"><a href="#cb59-299" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>does it have the correct number of columns (may indicate problems with the delimiter)</span>
<span id="cb59-300"><a href="#cb59-300" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>are the columns the expected type</span>
<span id="cb59-301"><a href="#cb59-301" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>are the values correct.</span>
<span id="cb59-302"><a href="#cb59-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-303"><a href="#cb59-303" aria-hidden="true" tabindex="-1"></a>To do this, we can print the object or <span class="in">`View()`</span> it. </span>
<span id="cb59-304"><a href="#cb59-304" aria-hidden="true" tabindex="-1"></a>We can also get details of the column specification</span>
<span id="cb59-305"><a href="#cb59-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-308"><a href="#cb59-308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-309"><a href="#cb59-309" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: spec</span></span>
<span id="cb59-310"><a href="#cb59-310" aria-hidden="true" tabindex="-1"></a><span class="fu">spec</span>(weather)</span>
<span id="cb59-311"><a href="#cb59-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-312"><a href="#cb59-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-313"><a href="#cb59-313" aria-hidden="true" tabindex="-1"></a>Any parsing problems (for example if there text in a column that should be numeric) will be shown with <span class="in">`problems()`</span></span>
<span id="cb59-314"><a href="#cb59-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-317"><a href="#cb59-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-318"><a href="#cb59-318" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: problems</span></span>
<span id="cb59-319"><a href="#cb59-319" aria-hidden="true" tabindex="-1"></a><span class="fu">problems</span>(weather)</span>
<span id="cb59-320"><a href="#cb59-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-321"><a href="#cb59-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-322"><a href="#cb59-322" aria-hidden="true" tabindex="-1"></a>Here, there are no parsing problems so we get a tibble with zero rows.</span>
<span id="cb59-323"><a href="#cb59-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-324"><a href="#cb59-324" aria-hidden="true" tabindex="-1"></a>Let's try another example. </span>
<span id="cb59-325"><a href="#cb59-325" aria-hidden="true" tabindex="-1"></a>File weather2.csv has semi-colons as delimiters.</span>
<span id="cb59-326"><a href="#cb59-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-327"><a href="#cb59-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r delim-csv2bis, echo=TRUE} </span></span>
<span id="cb59-328"><a href="#cb59-328" aria-hidden="true" tabindex="-1"></a><span class="in">weather2 &lt;- read_delim(file = "data/weather2.csv")</span></span>
<span id="cb59-329"><a href="#cb59-329" aria-hidden="true" tabindex="-1"></a><span class="in">spec(weather)</span></span>
<span id="cb59-330"><a href="#cb59-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-331"><a href="#cb59-331" aria-hidden="true" tabindex="-1"></a>Here, the message <span class="in">`Column specification`</span> tells you that the content of the columns <span class="in">`month`</span> and <span class="in">`Wind (m/s)`</span> has been recognized as of data type <span class="in">`character`</span>, and that the two other columns have been recognized as <span class="in">`number`</span>. </span>
<span id="cb59-332"><a href="#cb59-332" aria-hidden="true" tabindex="-1"></a>While <span class="in">`read_delim()`</span> got things right about the number of variables, something went wrong with the variables as we could expect <span class="in">`Wind (m/s)`</span> to be recognized as <span class="in">`double`</span>.</span>
<span id="cb59-333"><a href="#cb59-333" aria-hidden="true" tabindex="-1"></a>To find out about this issue we need to review the imported data in the object <span class="in">`weather2`</span> and compare it to the original file <span class="in">`weather2.csv`</span>.</span>
<span id="cb59-334"><a href="#cb59-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-335"><a href="#cb59-335" aria-hidden="true" tabindex="-1"></a>The example above shows the importance of carefully verifying that the imported data in R matches the original data set.</span>
<span id="cb59-336"><a href="#cb59-336" aria-hidden="true" tabindex="-1"></a>The following figure compares the content of the file <span class="in">`weather2.csv`</span> (@fig-comp-fig left) to the content of the object <span class="in">`weather2`</span> (@fig-comp-fig right):</span>
<span id="cb59-337"><a href="#cb59-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-338"><a href="#cb59-338" aria-hidden="true" tabindex="-1"></a><span class="in">``` {r}</span></span>
<span id="cb59-339"><a href="#cb59-339" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-comp-fig</span></span>
<span id="cb59-340"><a href="#cb59-340" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb59-341"><a href="#cb59-341" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: The data in the object does not match the data in the file.</span></span>
<span id="cb59-342"><a href="#cb59-342" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-alt: &gt;</span></span>
<span id="cb59-343"><a href="#cb59-343" aria-hidden="true" tabindex="-1"></a><span class="in">#|   Screenshots of the original text file with decimals separated by commas and</span></span>
<span id="cb59-344"><a href="#cb59-344" aria-hidden="true" tabindex="-1"></a><span class="in">#|   the imported object in R, mostly without decimal separators</span></span>
<span id="cb59-345"><a href="#cb59-345" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "100%"</span></span>
<span id="cb59-346"><a href="#cb59-346" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("figures/comp.png")</span></span>
<span id="cb59-347"><a href="#cb59-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-348"><a href="#cb59-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-349"><a href="#cb59-349" aria-hidden="true" tabindex="-1"></a>Looking at the rows in both pictures, one can understand that all commas have simply been ignored, excepted those in the last column.</span>
<span id="cb59-350"><a href="#cb59-350" aria-hidden="true" tabindex="-1"></a>To solve that issue, you must impose the separator using <span class="in">`locale = locale(decimal_mark = ",")`</span>:</span>
<span id="cb59-351"><a href="#cb59-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-352"><a href="#cb59-352" aria-hidden="true" tabindex="-1"></a><span class="in">```{r delim-csv2ter, echo=TRUE} </span></span>
<span id="cb59-353"><a href="#cb59-353" aria-hidden="true" tabindex="-1"></a><span class="in">weather3 &lt;- read_delim(</span></span>
<span id="cb59-354"><a href="#cb59-354" aria-hidden="true" tabindex="-1"></a><span class="in">  file = "data/weather2.csv",</span></span>
<span id="cb59-355"><a href="#cb59-355" aria-hidden="true" tabindex="-1"></a><span class="in">  locale = locale(decimal_mark = ",")</span></span>
<span id="cb59-356"><a href="#cb59-356" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb59-357"><a href="#cb59-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-358"><a href="#cb59-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-359"><a href="#cb59-359" aria-hidden="true" tabindex="-1"></a>The last column is now recognized as <span class="in">`double`</span> and the data in the object <span class="in">`weather3`</span> matches the data in the file:</span>
<span id="cb59-360"><a href="#cb59-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-361"><a href="#cb59-361" aria-hidden="true" tabindex="-1"></a><span class="in">``` {r comp2, echo=FALSE, fig.cap="_The data in the object now matches the data in the file._", out.width="100%"}</span></span>
<span id="cb59-362"><a href="#cb59-362" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("figures/comp2.png")</span></span>
<span id="cb59-363"><a href="#cb59-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-364"><a href="#cb59-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-365"><a href="#cb59-365" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb59-366"><a href="#cb59-366" aria-hidden="true" tabindex="-1"></a><span class="fu">## Decimal seperators</span></span>
<span id="cb59-367"><a href="#cb59-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-368"><a href="#cb59-368" aria-hidden="true" tabindex="-1"></a>While <span class="in">`readr`</span> can guess the column delimiter, it cannot guess the decimal separator.</span>
<span id="cb59-369"><a href="#cb59-369" aria-hidden="true" tabindex="-1"></a>The English/American standard is to use "." as the separator. </span>
<span id="cb59-370"><a href="#cb59-370" aria-hidden="true" tabindex="-1"></a>In Norway it is common to use a comma as the decimal separator (but "." are also common).</span>
<span id="cb59-371"><a href="#cb59-371" aria-hidden="true" tabindex="-1"></a>If you don't specify the decimal separator, <span class="in">`readr`</span> assumes that the comma is a thousand separator and ignores it. </span>
<span id="cb59-372"><a href="#cb59-372" aria-hidden="true" tabindex="-1"></a>Then the values can be 10x higher than expected.</span>
<span id="cb59-373"><a href="#cb59-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-374"><a href="#cb59-374" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-375"><a href="#cb59-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-376"><a href="#cb59-376" aria-hidden="true" tabindex="-1"></a><span class="fu">### read_csv2()</span></span>
<span id="cb59-377"><a href="#cb59-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-378"><a href="#cb59-378" aria-hidden="true" tabindex="-1"></a>A shortcut for files with a ";" as the column delimiter **and** commas as the decimal separator is <span class="in">`read_csv2()`</span>. </span>
<span id="cb59-379"><a href="#cb59-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-380"><a href="#cb59-380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r read-csv2, echo=TRUE} </span></span>
<span id="cb59-381"><a href="#cb59-381" aria-hidden="true" tabindex="-1"></a><span class="in">weather_csv2 &lt;- read_csv2(file = "data/weather2.csv")</span></span>
<span id="cb59-382"><a href="#cb59-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-383"><a href="#cb59-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-384"><a href="#cb59-384" aria-hidden="true" tabindex="-1"></a>Note the message above <span class="in">`Column specification`</span> that indicates which symbols <span class="in">`read_csv2()`</span> has considered when importing the data. The resulting tibble looks correct:</span>
<span id="cb59-385"><a href="#cb59-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-386"><a href="#cb59-386" aria-hidden="true" tabindex="-1"></a><span class="in">```{r read-csv-tibble2, echo=TRUE} </span></span>
<span id="cb59-387"><a href="#cb59-387" aria-hidden="true" tabindex="-1"></a><span class="in">weather_csv2</span></span>
<span id="cb59-388"><a href="#cb59-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-389"><a href="#cb59-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-390"><a href="#cb59-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-391"><a href="#cb59-391" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb59-392"><a href="#cb59-392" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise</span></span>
<span id="cb59-393"><a href="#cb59-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-394"><a href="#cb59-394" aria-hidden="true" tabindex="-1"></a>Import the file weather2.csv. Make sure it has imported correctly.</span>
<span id="cb59-395"><a href="#cb59-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-396"><a href="#cb59-396" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-397"><a href="#cb59-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-398"><a href="#cb59-398" aria-hidden="true" tabindex="-1"></a><span class="fu">### Useful arguments</span></span>
<span id="cb59-399"><a href="#cb59-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-400"><a href="#cb59-400" aria-hidden="true" tabindex="-1"></a><span class="in">`read_delim()`</span> and the other functions discussed above have a multitude of arguments that allow for adjusting the way data is read and displayed. </span>
<span id="cb59-401"><a href="#cb59-401" aria-hidden="true" tabindex="-1"></a>Here we review a handful of them.</span>
<span id="cb59-402"><a href="#cb59-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-403"><a href="#cb59-403" aria-hidden="true" tabindex="-1"></a><span class="fu">#### n_max</span></span>
<span id="cb59-404"><a href="#cb59-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-405"><a href="#cb59-405" aria-hidden="true" tabindex="-1"></a><span class="in">`n_max`</span> sets a limit to the number of *observations* to be read.</span>
<span id="cb59-406"><a href="#cb59-406" aria-hidden="true" tabindex="-1"></a>Note that <span class="in">`n_max`</span> does not consider the first row (header) of the data file as an observation. </span>
<span id="cb59-407"><a href="#cb59-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-408"><a href="#cb59-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-409"><a href="#cb59-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r nmax, echo=TRUE, message=FALSE} </span></span>
<span id="cb59-410"><a href="#cb59-410" aria-hidden="true" tabindex="-1"></a><span class="in">weather &lt;- read_delim(</span></span>
<span id="cb59-411"><a href="#cb59-411" aria-hidden="true" tabindex="-1"></a><span class="in">  file = "data/weather.csv",</span></span>
<span id="cb59-412"><a href="#cb59-412" aria-hidden="true" tabindex="-1"></a><span class="in">  n_max = 6</span></span>
<span id="cb59-413"><a href="#cb59-413" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb59-414"><a href="#cb59-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-415"><a href="#cb59-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r nmax2, echo=TRUE} </span></span>
<span id="cb59-416"><a href="#cb59-416" aria-hidden="true" tabindex="-1"></a><span class="in">weather</span></span>
<span id="cb59-417"><a href="#cb59-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-418"><a href="#cb59-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-419"><a href="#cb59-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-420"><a href="#cb59-420" aria-hidden="true" tabindex="-1"></a><span class="fu">#### skip</span></span>
<span id="cb59-421"><a href="#cb59-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-422"><a href="#cb59-422" aria-hidden="true" tabindex="-1"></a>The argument <span class="in">`skip`</span> may be used to skip rows when reading the data file.  </span>
<span id="cb59-423"><a href="#cb59-423" aria-hidden="true" tabindex="-1"></a>Be aware that:</span>
<span id="cb59-424"><a href="#cb59-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-425"><a href="#cb59-425" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>the header in the original data file counts as one row,</span>
<span id="cb59-426"><a href="#cb59-426" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>the first row that comes after those which have been skipped becomes the header for the resulting tibble.</span>
<span id="cb59-427"><a href="#cb59-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-428"><a href="#cb59-428" aria-hidden="true" tabindex="-1"></a>In the following example, we read the data file <span class="in">`weather.csv`</span> and skip the first row:</span>
<span id="cb59-429"><a href="#cb59-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-430"><a href="#cb59-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r skip, echo=TRUE, message=FALSE} </span></span>
<span id="cb59-431"><a href="#cb59-431" aria-hidden="true" tabindex="-1"></a><span class="in">weather &lt;- read_delim(</span></span>
<span id="cb59-432"><a href="#cb59-432" aria-hidden="true" tabindex="-1"></a><span class="in">  file = "data/weather.csv",</span></span>
<span id="cb59-433"><a href="#cb59-433" aria-hidden="true" tabindex="-1"></a><span class="in">  skip = 1</span></span>
<span id="cb59-434"><a href="#cb59-434" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb59-435"><a href="#cb59-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-436"><a href="#cb59-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-437"><a href="#cb59-437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r skip2, echo=TRUE} </span></span>
<span id="cb59-438"><a href="#cb59-438" aria-hidden="true" tabindex="-1"></a><span class="in">weather</span></span>
<span id="cb59-439"><a href="#cb59-439" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-440"><a href="#cb59-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-441"><a href="#cb59-441" aria-hidden="true" tabindex="-1"></a>As expected, the first row (with the header) is skipped, and the data from the observation <span class="in">`January`</span> have become the header of the tibble.</span>
<span id="cb59-442"><a href="#cb59-442" aria-hidden="true" tabindex="-1"></a>The argument <span class="in">`col_names()`</span> introduced below will be useful for solving this issue.</span>
<span id="cb59-443"><a href="#cb59-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-444"><a href="#cb59-444" aria-hidden="true" tabindex="-1"></a><span class="fu">#### col_names</span></span>
<span id="cb59-445"><a href="#cb59-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-446"><a href="#cb59-446" aria-hidden="true" tabindex="-1"></a>The argument <span class="in">`col_names`</span> may be used to define the name of the variables/columns of the tibble.</span>
<span id="cb59-447"><a href="#cb59-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-448"><a href="#cb59-448" aria-hidden="true" tabindex="-1"></a><span class="in">`col_names =`</span> may also be followed by the actual variable names that you want to use.</span>
<span id="cb59-449"><a href="#cb59-449" aria-hidden="true" tabindex="-1"></a>In that case, write <span class="in">`col_names = c()`</span> and list the names between the parentheses.</span>
<span id="cb59-450"><a href="#cb59-450" aria-hidden="true" tabindex="-1"></a>Be aware that the first row of the original data file, which would have been the column names, will become the first row of the resulting tibble.</span>
<span id="cb59-451"><a href="#cb59-451" aria-hidden="true" tabindex="-1"></a>This means that if you want to replace existing names, you should also</span>
<span id="cb59-452"><a href="#cb59-452" aria-hidden="true" tabindex="-1"></a>use the <span class="in">`skip`</span> argument.</span>
<span id="cb59-453"><a href="#cb59-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-454"><a href="#cb59-454" aria-hidden="true" tabindex="-1"></a>Here is an example:</span>
<span id="cb59-455"><a href="#cb59-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-456"><a href="#cb59-456" aria-hidden="true" tabindex="-1"></a><span class="in">```{r col-names, echo=TRUE, message = FALSE} </span></span>
<span id="cb59-457"><a href="#cb59-457" aria-hidden="true" tabindex="-1"></a><span class="in">weather &lt;- read_delim(</span></span>
<span id="cb59-458"><a href="#cb59-458" aria-hidden="true" tabindex="-1"></a><span class="in">  file = "data/weather.csv",</span></span>
<span id="cb59-459"><a href="#cb59-459" aria-hidden="true" tabindex="-1"></a><span class="in">  skip = 1,</span></span>
<span id="cb59-460"><a href="#cb59-460" aria-hidden="true" tabindex="-1"></a><span class="in">  col_names = c("Month", "Temp", "Precip", "Wind")</span></span>
<span id="cb59-461"><a href="#cb59-461" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb59-462"><a href="#cb59-462" aria-hidden="true" tabindex="-1"></a><span class="in">weather</span></span>
<span id="cb59-463"><a href="#cb59-463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-464"><a href="#cb59-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-465"><a href="#cb59-465" aria-hidden="true" tabindex="-1"></a>If lots of column names are badly formatted, it may be easier to use <span class="in">`janitor::clean_names()`</span> to improve them.</span>
<span id="cb59-466"><a href="#cb59-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-467"><a href="#cb59-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r janitor, echo=TRUE, message=FALSE} </span></span>
<span id="cb59-468"><a href="#cb59-468" aria-hidden="true" tabindex="-1"></a><span class="in">weather &lt;- read_delim(file = "data/weather.csv") |&gt;</span></span>
<span id="cb59-469"><a href="#cb59-469" aria-hidden="true" tabindex="-1"></a><span class="in">  janitor::clean_names()</span></span>
<span id="cb59-470"><a href="#cb59-470" aria-hidden="true" tabindex="-1"></a><span class="in">weather</span></span>
<span id="cb59-471"><a href="#cb59-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-472"><a href="#cb59-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-473"><a href="#cb59-473" aria-hidden="true" tabindex="-1"></a><span class="fu">#### col_types </span></span>
<span id="cb59-474"><a href="#cb59-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-475"><a href="#cb59-475" aria-hidden="true" tabindex="-1"></a>The argument <span class="in">`col_types`</span> may be used to modify the data type of the variables.</span>
<span id="cb59-476"><a href="#cb59-476" aria-hidden="true" tabindex="-1"></a>This is useful for example when you need to set a variable as <span class="in">`factor`</span> whereas R has defined it as <span class="in">`character`</span>.</span>
<span id="cb59-477"><a href="#cb59-477" aria-hidden="true" tabindex="-1"></a>Here is an example with three simple variables.</span>
<span id="cb59-478"><a href="#cb59-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-479"><a href="#cb59-479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r col-types, echo=TRUE} </span></span>
<span id="cb59-480"><a href="#cb59-480" aria-hidden="true" tabindex="-1"></a><span class="in">counts &lt;- read_delim(file = "data/groups.csv")</span></span>
<span id="cb59-481"><a href="#cb59-481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-482"><a href="#cb59-482" aria-hidden="true" tabindex="-1"></a>As the message clearly indicates, the first and last variables are recognized as <span class="in">`double`</span> (i.e. <span class="in">`numeric`</span>) while the second one is recognized as <span class="in">`character`</span>. </span>
<span id="cb59-483"><a href="#cb59-483" aria-hidden="true" tabindex="-1"></a>The tibble in the object <span class="in">`counts`</span> displays as follows:</span>
<span id="cb59-484"><a href="#cb59-484" aria-hidden="true" tabindex="-1"></a><span class="in">```{r col-types2, echo=TRUE} </span></span>
<span id="cb59-485"><a href="#cb59-485" aria-hidden="true" tabindex="-1"></a><span class="in">counts</span></span>
<span id="cb59-486"><a href="#cb59-486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-487"><a href="#cb59-487" aria-hidden="true" tabindex="-1"></a>Let's use <span class="in">`col_types = cols()`</span> to manually set the data types to <span class="in">`double`</span>, <span class="in">`factor`</span> and <span class="in">`integer`</span>, respectively.</span>
<span id="cb59-488"><a href="#cb59-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-489"><a href="#cb59-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r col-types3, echo=TRUE} </span></span>
<span id="cb59-490"><a href="#cb59-490" aria-hidden="true" tabindex="-1"></a><span class="in">counts &lt;- read_delim(</span></span>
<span id="cb59-491"><a href="#cb59-491" aria-hidden="true" tabindex="-1"></a><span class="in">  file = "data/groups.csv",</span></span>
<span id="cb59-492"><a href="#cb59-492" aria-hidden="true" tabindex="-1"></a><span class="in">  col_types = cols(col_double(), col_factor(), col_integer())</span></span>
<span id="cb59-493"><a href="#cb59-493" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb59-494"><a href="#cb59-494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-495"><a href="#cb59-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-496"><a href="#cb59-496" aria-hidden="true" tabindex="-1"></a>Now the tibble displays like this, with the correct data types for each column:</span>
<span id="cb59-497"><a href="#cb59-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r col-types4, echo=TRUE} </span></span>
<span id="cb59-498"><a href="#cb59-498" aria-hidden="true" tabindex="-1"></a><span class="in">counts</span></span>
<span id="cb59-499"><a href="#cb59-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-500"><a href="#cb59-500" aria-hidden="true" tabindex="-1"></a>If you only need to modify one or a few variables, you must name it/them when writing the code:</span>
<span id="cb59-501"><a href="#cb59-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-502"><a href="#cb59-502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r col-types5, echo=TRUE} </span></span>
<span id="cb59-503"><a href="#cb59-503" aria-hidden="true" tabindex="-1"></a><span class="in">counts &lt;- read_delim(</span></span>
<span id="cb59-504"><a href="#cb59-504" aria-hidden="true" tabindex="-1"></a><span class="in">  file = "data/groups.csv",</span></span>
<span id="cb59-505"><a href="#cb59-505" aria-hidden="true" tabindex="-1"></a><span class="in">  col_types = cols(group = col_factor())</span></span>
<span id="cb59-506"><a href="#cb59-506" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb59-507"><a href="#cb59-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-508"><a href="#cb59-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-509"><a href="#cb59-509" aria-hidden="true" tabindex="-1"></a>The tibble displays like this:</span>
<span id="cb59-510"><a href="#cb59-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r col-types6, echo=TRUE} </span></span>
<span id="cb59-511"><a href="#cb59-511" aria-hidden="true" tabindex="-1"></a><span class="in">counts</span></span>
<span id="cb59-512"><a href="#cb59-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-513"><a href="#cb59-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-514"><a href="#cb59-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-515"><a href="#cb59-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-516"><a href="#cb59-516" aria-hidden="true" tabindex="-1"></a><span class="in">`col_types`</span> is particularly useful when importing tabular data that includes formatted dates.</span>
<span id="cb59-517"><a href="#cb59-517" aria-hidden="true" tabindex="-1"></a>Dates are usually recognized as <span class="in">`character`</span> when their format does not match the expected format set as default (locale, etc).</span>
<span id="cb59-518"><a href="#cb59-518" aria-hidden="true" tabindex="-1"></a>In the following example, dates entered  as <span class="in">`yyyy-mm-dd`</span> in the last column are recognized as of type <span class="in">`date`</span>:</span>
<span id="cb59-519"><a href="#cb59-519" aria-hidden="true" tabindex="-1"></a><span class="in">```{r col-types-dates1, echo=TRUE} </span></span>
<span id="cb59-520"><a href="#cb59-520" aria-hidden="true" tabindex="-1"></a><span class="in">countsdates &lt;- read_delim(file = "data/groups-dates1.csv")</span></span>
<span id="cb59-521"><a href="#cb59-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-522"><a href="#cb59-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-523"><a href="#cb59-523" aria-hidden="true" tabindex="-1"></a>However, in the example below, dates entered as <span class="in">`dd-mm-yyyy`</span> are converted to <span class="in">`character`</span>:</span>
<span id="cb59-524"><a href="#cb59-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-525"><a href="#cb59-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r col-types-dates2, echo=TRUE} </span></span>
<span id="cb59-526"><a href="#cb59-526" aria-hidden="true" tabindex="-1"></a><span class="in">countsdates &lt;- read_delim(file = "data/groups-dates2.csv")</span></span>
<span id="cb59-527"><a href="#cb59-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-528"><a href="#cb59-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-529"><a href="#cb59-529" aria-hidden="true" tabindex="-1"></a>To solve this issue, add the function <span class="in">`col_date()`</span> in <span class="in">`cols()`</span> to help R understand how dates are formatted and shall be read.</span>
<span id="cb59-530"><a href="#cb59-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-531"><a href="#cb59-531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r col-types-dates3, echo=TRUE} </span></span>
<span id="cb59-532"><a href="#cb59-532" aria-hidden="true" tabindex="-1"></a><span class="in">countsdates &lt;- read_delim(</span></span>
<span id="cb59-533"><a href="#cb59-533" aria-hidden="true" tabindex="-1"></a><span class="in">  file = "data/groups-dates2.csv",</span></span>
<span id="cb59-534"><a href="#cb59-534" aria-hidden="true" tabindex="-1"></a><span class="in">  col_types = cols(date = col_date("%d-%m-%Y"))</span></span>
<span id="cb59-535"><a href="#cb59-535" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb59-536"><a href="#cb59-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-537"><a href="#cb59-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-538"><a href="#cb59-538" aria-hidden="true" tabindex="-1"></a>The result is the following tibble now correctly formatted:</span>
<span id="cb59-539"><a href="#cb59-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r col-types-dates4, echo=TRUE} </span></span>
<span id="cb59-540"><a href="#cb59-540" aria-hidden="true" tabindex="-1"></a><span class="in">countsdates</span></span>
<span id="cb59-541"><a href="#cb59-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-542"><a href="#cb59-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-543"><a href="#cb59-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-544"><a href="#cb59-544" aria-hidden="true" tabindex="-1"></a>You will find the whole list of <span class="in">`cols()`</span> parameters for <span class="in">`col_types`</span>  <span class="co">[</span><span class="ot">here</span><span class="co">](https://readr.tidyverse.org/reference/cols.html)</span>{target="_blank"}.  </span>
<span id="cb59-545"><a href="#cb59-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-546"><a href="#cb59-546" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb59-547"><a href="#cb59-547" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise</span></span>
<span id="cb59-548"><a href="#cb59-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-549"><a href="#cb59-549" aria-hidden="true" tabindex="-1"></a>Import the data from "biomass2015_H.csv". </span>
<span id="cb59-550"><a href="#cb59-550" aria-hidden="true" tabindex="-1"></a>These data are plant biomass data from an alpine grassland near Mt Gonga, China. </span>
<span id="cb59-551"><a href="#cb59-551" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-552"><a href="#cb59-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-553"><a href="#cb59-553" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb59-554"><a href="#cb59-554" aria-hidden="true" tabindex="-1"></a><span class="fu">## Very large files</span></span>
<span id="cb59-555"><a href="#cb59-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-556"><a href="#cb59-556" aria-hidden="true" tabindex="-1"></a><span class="in">`readr`</span> imports objects into the computers memory. </span>
<span id="cb59-557"><a href="#cb59-557" aria-hidden="true" tabindex="-1"></a>This is fine for most datasets. </span>
<span id="cb59-558"><a href="#cb59-558" aria-hidden="true" tabindex="-1"></a>But very large datasets (gigabytes) - will not fit into memory and another solution is needed. </span>
<span id="cb59-559"><a href="#cb59-559" aria-hidden="true" tabindex="-1"></a>We can use apache arrow with the <span class="co">[</span><span class="ot">`arrow` package</span><span class="co">](https://arrow.apache.org/docs/r/articles/dataset.html)</span> or duckDB with <span class="co">[</span><span class="ot">duckplyr</span><span class="co">](https://duckplyr.tidyverse.org/)</span>.</span>
<span id="cb59-560"><a href="#cb59-560" aria-hidden="true" tabindex="-1"></a>Both can work with <span class="in">`dplyr`</span> functions to process large datasets efficiently.</span>
<span id="cb59-561"><a href="#cb59-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-562"><a href="#cb59-562" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-563"><a href="#cb59-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-564"><a href="#cb59-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-565"><a href="#cb59-565" aria-hidden="true" tabindex="-1"></a><span class="fu">### White space delimited files</span></span>
<span id="cb59-566"><a href="#cb59-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-567"><a href="#cb59-567" aria-hidden="true" tabindex="-1"></a>Some files have white space separating the columns. </span>
<span id="cb59-568"><a href="#cb59-568" aria-hidden="true" tabindex="-1"></a>If a single tab is used then <span class="in">`read_delim()`</span> will automatically detect it and work correctly.</span>
<span id="cb59-569"><a href="#cb59-569" aria-hidden="true" tabindex="-1"></a>Sometimes multiple spaces are used so the columns line up, making the text file easy for humans to read.</span>
<span id="cb59-570"><a href="#cb59-570" aria-hidden="true" tabindex="-1"></a><span class="in">`read_delim()`</span> will not work with these files as it expects a single delimiter. </span>
<span id="cb59-571"><a href="#cb59-571" aria-hidden="true" tabindex="-1"></a>Instead we can use <span class="in">`read_table()`</span>, shown here with some test data.</span>
<span id="cb59-572"><a href="#cb59-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-575"><a href="#cb59-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-576"><a href="#cb59-576" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: read-white-space</span></span>
<span id="cb59-577"><a href="#cb59-577" aria-hidden="true" tabindex="-1"></a><span class="fu">read_table</span>(<span class="st">" Species   Value</span></span>
<span id="cb59-578"><a href="#cb59-578" aria-hidden="true" tabindex="-1"></a><span class="st">            Navicula       1</span></span>
<span id="cb59-579"><a href="#cb59-579" aria-hidden="true" tabindex="-1"></a><span class="st">            Cymbella       2"</span>)</span>
<span id="cb59-580"><a href="#cb59-580" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-581"><a href="#cb59-581" aria-hidden="true" tabindex="-1"></a>Another type of data you will sometimes see is the fixed width format.</span>
<span id="cb59-582"><a href="#cb59-582" aria-hidden="true" tabindex="-1"></a>There are no delimiters, but each field has the same position in each row. </span>
<span id="cb59-583"><a href="#cb59-583" aria-hidden="true" tabindex="-1"></a>These files can be imported with <span class="in">`read_fwf()`</span>.</span>
<span id="cb59-584"><a href="#cb59-584" aria-hidden="true" tabindex="-1"></a>Determining the position of each column can be painful unless you have good metadata.</span>
<span id="cb59-585"><a href="#cb59-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-586"><a href="#cb59-586" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb59-587"><a href="#cb59-587" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise</span></span>
<span id="cb59-588"><a href="#cb59-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-589"><a href="#cb59-589" aria-hidden="true" tabindex="-1"></a>Import part "3a. Clegg et al. 2011 Hudson Lake Midge Temperature Data" from "alaska2011midge-t.txt"</span>
<span id="cb59-590"><a href="#cb59-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-591"><a href="#cb59-591" aria-hidden="true" tabindex="-1"></a> &lt;details&gt;</span>
<span id="cb59-592"><a href="#cb59-592" aria-hidden="true" tabindex="-1"></a>  &lt;summary&gt;Hint&lt;/summary&gt;</span>
<span id="cb59-593"><a href="#cb59-593" aria-hidden="true" tabindex="-1"></a><span class="in">`skip`</span> and </span>
<span id="cb59-594"><a href="#cb59-594" aria-hidden="true" tabindex="-1"></a><span class="in">`n_max`</span> argument can be useful.</span>
<span id="cb59-595"><a href="#cb59-595" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt; </span>
<span id="cb59-596"><a href="#cb59-596" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-597"><a href="#cb59-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-598"><a href="#cb59-598" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb59-599"><a href="#cb59-599" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reading multiple files</span></span>
<span id="cb59-600"><a href="#cb59-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-601"><a href="#cb59-601" aria-hidden="true" tabindex="-1"></a>If you want to read many files with the **same structure**, you can supply <span class="in">`read_delim()`</span> with a vector of files names.</span>
<span id="cb59-602"><a href="#cb59-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-605"><a href="#cb59-605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-606"><a href="#cb59-606" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: multiple-files</span></span>
<span id="cb59-607"><a href="#cb59-607" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-608"><a href="#cb59-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-609"><a href="#cb59-609" aria-hidden="true" tabindex="-1"></a><span class="co"># get a vector of files</span></span>
<span id="cb59-610"><a href="#cb59-610" aria-hidden="true" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"data/"</span>, <span class="at">pattern =</span> <span class="st">"csv"</span>)</span>
<span id="cb59-611"><a href="#cb59-611" aria-hidden="true" tabindex="-1"></a>files</span>
<span id="cb59-612"><a href="#cb59-612" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; file1.csv file2.csv</span></span>
<span id="cb59-613"><a href="#cb59-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-614"><a href="#cb59-614" aria-hidden="true" tabindex="-1"></a><span class="co"># read them in at once</span></span>
<span id="cb59-615"><a href="#cb59-615" aria-hidden="true" tabindex="-1"></a><span class="co"># record paths in a column called filename</span></span>
<span id="cb59-616"><a href="#cb59-616" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(files, <span class="at">id =</span> <span class="st">"filename"</span>)</span>
<span id="cb59-617"><a href="#cb59-617" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span id="cb59-618"><a href="#cb59-618" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   filename      x     y</span></span>
<span id="cb59-619"><a href="#cb59-619" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb59-620"><a href="#cb59-620" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 file1.csv     1     2</span></span>
<span id="cb59-621"><a href="#cb59-621" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 file1.csv     3     4</span></span>
<span id="cb59-622"><a href="#cb59-622" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 file2.csv     5     6</span></span>
<span id="cb59-623"><a href="#cb59-623" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 file2.csv     7     8</span></span>
<span id="cb59-624"><a href="#cb59-624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-625"><a href="#cb59-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-626"><a href="#cb59-626" aria-hidden="true" tabindex="-1"></a>If the files do not have identical structures, perhaps one of the files has text where it should have a number, you either have to use the <span class="in">`col_types`</span> argument to convert everything to the same format, or iterate (@sec-iterate) over the files to import and fix them.</span>
<span id="cb59-627"><a href="#cb59-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-628"><a href="#cb59-628" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-629"><a href="#cb59-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-630"><a href="#cb59-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-631"><a href="#cb59-631" aria-hidden="true" tabindex="-1"></a><span class="fu">## Excel files</span></span>
<span id="cb59-632"><a href="#cb59-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-633"><a href="#cb59-633" aria-hidden="true" tabindex="-1"></a>Even though we don't recommend you use Excel files for your own data, you need to know how to import such data as you may be given Excel files for find them in a data repository.</span>
<span id="cb59-634"><a href="#cb59-634" aria-hidden="true" tabindex="-1"></a>To make your analysis reproducible, it is important to keep the files in their original format rather than converting them to CSV so that all the processing is done with code.</span>
<span id="cb59-635"><a href="#cb59-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-636"><a href="#cb59-636" aria-hidden="true" tabindex="-1"></a>Excel files can be imported with the <span class="in">`readxl`</span> package which is installed with <span class="in">`tidyverse`</span> but not loaded until you run <span class="in">`library(readxl)`</span>.</span>
<span id="cb59-637"><a href="#cb59-637" aria-hidden="true" tabindex="-1"></a>The function <span class="in">`read_excel()`</span> will import the data; it can be worth using <span class="in">`excel_sheets()`</span> first to check the names of the sheets.</span>
<span id="cb59-638"><a href="#cb59-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-641"><a href="#cb59-641" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-642"><a href="#cb59-642" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: read-excel</span></span>
<span id="cb59-643"><a href="#cb59-643" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-644"><a href="#cb59-644" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb59-645"><a href="#cb59-645" aria-hidden="true" tabindex="-1"></a><span class="fu">excel_sheets</span>(<span class="at">path =</span> <span class="st">"data/biomass2015.xls"</span>)</span>
<span id="cb59-646"><a href="#cb59-646" aria-hidden="true" tabindex="-1"></a>biomass_l <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">"data/biomass2015.xls"</span>, <span class="at">sheet =</span> <span class="st">"Site L"</span>)</span>
<span id="cb59-647"><a href="#cb59-647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-648"><a href="#cb59-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-649"><a href="#cb59-649" aria-hidden="true" tabindex="-1"></a>Many of the arguments for skipping rows at the start of the file, enforcing column types, etc, are similar to those in <span class="in">`readr::read_delim()`</span></span>
<span id="cb59-650"><a href="#cb59-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-651"><a href="#cb59-651" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb59-652"><a href="#cb59-652" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise</span></span>
<span id="cb59-653"><a href="#cb59-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-654"><a href="#cb59-654" aria-hidden="true" tabindex="-1"></a>Import the biomass data from Site A from biomass2015.xls</span>
<span id="cb59-655"><a href="#cb59-655" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-656"><a href="#cb59-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-657"><a href="#cb59-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-658"><a href="#cb59-658" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb59-659"><a href="#cb59-659" aria-hidden="true" tabindex="-1"></a><span class="fu">## Further Reading</span></span>
<span id="cb59-660"><a href="#cb59-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-661"><a href="#cb59-661" aria-hidden="true" tabindex="-1"></a>You may find the following links useful:</span>
<span id="cb59-662"><a href="#cb59-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-663"><a href="#cb59-663" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span><span class="co">[</span><span class="ot">R for Data Science - Data import</span><span class="co">](https://r4ds.had.co.nz/data-import.html)</span>{target="_blank"}</span>
<span id="cb59-664"><a href="#cb59-664" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span><span class="co">[</span><span class="ot">Data Import Cheatsheet - readr/readxl</span><span class="co">](https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-import.pdf)</span>{target="_blank"}</span>
<span id="cb59-665"><a href="#cb59-665" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span><span class="co">[</span><span class="ot">readr</span><span class="co">](https://readr.tidyverse.org/)</span>{target="_blank"}</span>
<span id="cb59-666"><a href="#cb59-666" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-667"><a href="#cb59-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-668"><a href="#cb59-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-669"><a href="#cb59-669" aria-hidden="true" tabindex="-1"></a>::: {.column-margin}</span>
<span id="cb59-670"><a href="#cb59-670" aria-hidden="true" tabindex="-1"></a><span class="fu">### Contributors {.unlisted .unnumbered}</span></span>
<span id="cb59-671"><a href="#cb59-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-672"><a href="#cb59-672" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Jonathan Soulé</span>
<span id="cb59-673"><a href="#cb59-673" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Aud Halbritter</span>
<span id="cb59-674"><a href="#cb59-674" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Richard Telford</span>
<span id="cb59-675"><a href="#cb59-675" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>