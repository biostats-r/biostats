<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>11 Getting started with ggplot | Working in R</title>
<meta name="author" content="Jonathan Soulé, Aud Halbritter and Richard J Telford">
<meta name="description" content="11.0.1 Before you start You need to be familiar with different types of data (continuous, categorical) able to handle tibbles know how to install a package  11.1 Install the ggplot2 package...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="11 Getting started with ggplot | Working in R">
<meta property="og:type" content="book">
<meta property="og:description" content="11.0.1 Before you start You need to be familiar with different types of data (continuous, categorical) able to handle tibbles know how to install a package  11.1 Install the ggplot2 package...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="11 Getting started with ggplot | Working in R">
<meta name="twitter:description" content="11.0.1 Before you start You need to be familiar with different types of data (continuous, categorical) able to handle tibbles know how to install a package  11.1 Install the ggplot2 package...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/panelset-0.2.6/panelset.css" rel="stylesheet">
<script src="libs/panelset-0.2.6/panelset.js"></script><link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="css/style-chapters.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Working in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li class="book-part">Setting up R and RStudio</li>
<li><a class="" href="getting-started-with-r.html"><span class="header-section-number">2</span> Getting started with R</a></li>
<li class="book-part">First steps in R</li>
<li><a class="" href="first-steps-in-r.html"><span class="header-section-number">3</span> First steps in R</a></li>
<li><a class="" href="importing-data-in-r.html"><span class="header-section-number">4</span> Importing data in R</a></li>
<li class="book-part">Data manipulation with the tidyverse</li>
<li><a class="" href="pipes.html"><span class="header-section-number">5</span> Pipes</a></li>
<li><a class="" href="tidying-data-with-tidyr.html"><span class="header-section-number">6</span> Tidying data with tidyr</a></li>
<li><a class="" href="working-with-single-tables-in-dplyr.html"><span class="header-section-number">7</span> Working with single tables in dplyr</a></li>
<li><a class="" href="working-with-multiple-tables-in-dplyr.html"><span class="header-section-number">8</span> Working with multiple tables in dplyr</a></li>
<li class="book-part">Data visualisation</li>
<li><a class="" href="why-is-data-visualization-important.html"><span class="header-section-number">10</span> Why is data visualization important?</a></li>
<li><a class="active" href="getting-started-with-ggplot.html"><span class="header-section-number">11</span> Getting started with ggplot</a></li>
<li><a class="" href="types-of-vizualization.html"><span class="header-section-number">12</span> Types of vizualization</a></li>
<li><a class="" href="themes-1.html"><span class="header-section-number">13</span> Themes</a></li>
<li><a class="" href="shapes-colours-and-linetypes.html"><span class="header-section-number">14</span> Shapes, colours and linetypes</a></li>
<li><a class="" href="combining-plots.html"><span class="header-section-number">15</span> Combining plots</a></li>
<li><a class="" href="using-functions-and-packages.html"><span class="header-section-number">16</span> Using functions and packages</a></li>
<li class="book-part">Other topics</li>
<li><a class="" href="handling-missing-values.html"><span class="header-section-number">17</span> Handling missing values</a></li>
<li><a class="" href="bestiary-of-brackets-and-other-r-notation.html"><span class="header-section-number">18</span> Bestiary of Brackets and other R notation</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="getting-started-with-ggplot" class="section level1" number="11">
<h1>
<span class="header-section-number">11</span> Getting started with ggplot<a class="anchor" aria-label="anchor" href="#getting-started-with-ggplot"><i class="fas fa-link"></i></a>
</h1>
<div id="before-you-start" class="section level3 facta" number="11.0.1">
<h3>
<span class="header-section-number">11.0.1</span> Before you start<a class="anchor" aria-label="anchor" href="#before-you-start"><i class="fas fa-link"></i></a>
</h3>
<p>You need to be</p>
<ul>
<li>familiar with different types of data (continuous, categorical)</li>
<li>able to handle tibbles</li>
<li>know how to install a package</li>
</ul>
</div>
<div id="install-the-ggplot2-package" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Install the <code>ggplot2</code> package<a class="anchor" aria-label="anchor" href="#install-the-ggplot2-package"><i class="fas fa-link"></i></a>
</h2>
<p><code>ggplot2</code> is part of <code>tidyverse</code> so if you have already installed <code>tidyverse</code>, you already have <code>ggplot2</code> installed.
If not, see the section on installing <code>tidyverse</code>.</p>
<p>To activate <code>ggplot2</code>, you can use</p>
<div class="sourceCode" id="cb437"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
<p>But most of the time you can use <code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code>.</p>
</div>
<div id="the-basics" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> The basics<a class="anchor" aria-label="anchor" href="#the-basics"><i class="fas fa-link"></i></a>
</h2>
<p>ggplot is based on the <strong>grammar of graphics</strong>, a terminology describing the components of a figure.</p>
<p>Let us have a look at these terms.</p>
<p>To produce a figure or plot, we take data values and use elements like dots, squares, lines, and colour to convert the data into a visual graphic.
There are many different ways to make a figure, but there are some rules that apply in general.
A plot is always built on data, and a number of other components called aestetics, geometry and scales.
These different components combined make up a figure</p>
</div>
<div id="the-code" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> The code<a class="anchor" aria-label="anchor" href="#the-code"><i class="fas fa-link"></i></a>
</h2>
<p>The basic code for a scatterplot looks something like this:</p>
<div class="sourceCode" id="cb438"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins</span>,
       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_mass_g</span>, y <span class="op">=</span> <span class="va">bill_length_mm</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Body mass, g"</span>, y <span class="op">=</span> <span class="st">"Bill length, mm"</span>, colour <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/ggplot2-1-1.png" width="336"></div>
<p>The main function is <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> and is used to define the data and the aesthetics.
The <code>data</code> is a data frame or tibble containing the variables to produce the figure.
The <code>mapping</code> uses <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> to describe how the variables should be mapped onto the <strong>aes</strong>tetics, such as x and y location or colour.
Every other component of the plot is added with <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code>.
It makes the code easier to read if you put a new line after each <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> (the <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> must go at the end of a line, not at the start).
These other elements include the graphical elements that display the data, usually created with a <code>geom_*()</code> function, labels created with <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code>, and <a href="themes">themes</a> that change the non-data elements of the plot with <code>themes()</code>.</p>
<p>You can think of it as different layers that are put on top of each other see <a href="getting-started-with-ggplot.html#fig:ggplot-hierarchy">11.1</a>.</p>
<div class="figure">
<span style="display:block;" id="fig:ggplot-hierarchy"></span>
<img src="Figures/ggplot_setup.png" alt="Visualization of how ggplots are built." width="100%"><p class="caption">
Figure 11.1: Visualization of how ggplots are built.
</p>
</div>
</div>
<div id="the-palmer-penguin-example" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> The Palmer Penguin Example<a class="anchor" aria-label="anchor" href="#the-palmer-penguin-example"><i class="fas fa-link"></i></a>
</h2>
<p>We will mostly work with the Palmer Penguin data set <span class="citation">[@Horst2020-jy]</span>.
If you are unfamiliar with the dataset have a look at this webpage: <a href="https://github.com/allisonhorst/palmerpenguins" class="uri">https://github.com/allisonhorst/palmerpenguins</a></p>
<p>To install the dataset run this code:</p>
<div class="sourceCode" id="cb439"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"palmerpenguins"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">penguin</span>, package <span class="op">=</span> <span class="st">'palmerpenguins'</span><span class="op">)</span></code></pre></div>
<p>The datasets contains data on 344 individuals from three species of penguins, collected from tree islands in the Palmer Archipelago, Antarctica.
It includes several morphological traits like bill length and depth, flipper length, body mass, and sex.</p>
<div class="sourceCode" id="cb440"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span></code></pre></div>
<pre><code>## # A tibble: 344 × 8
##   species island    bill_length_mm bill_depth_mm flipper_length_mm
##   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;
## 1 Adelie  Torgersen           39.1          18.7               181
## 2 Adelie  Torgersen           39.5          17.4               186
## 3 Adelie  Torgersen           40.3          18                 195
## # … with 341 more rows, and 3 more variables: body_mass_g &lt;int&gt;,
## #   sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
</div>
<div id="building-a-ggplot-figure" class="section level2" number="11.5">
<h2>
<span class="header-section-number">11.5</span> Building a ggplot figure<a class="anchor" aria-label="anchor" href="#building-a-ggplot-figure"><i class="fas fa-link"></i></a>
</h2>
<p>Now we will describe the different components a ggplot is made of.</p>
<div id="data" class="section level3" number="11.5.1">
<h3>
<span class="header-section-number">11.5.1</span> Data<a class="anchor" aria-label="anchor" href="#data"><i class="fas fa-link"></i></a>
</h3>
<p>To make a figure we use the function <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.
The first element in this function is the <strong>data object</strong> containing all the variables that you need to make a figure
Generally, it is advisable to have the data in a long format.</p>
<p>For the penguin example this is how it will look like:</p>
<div class="sourceCode" id="cb442"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/data1-1.png" width="672"></div>
<p>The ggplot function will produce an empty plot, but not show any data.</p>
<p><br><br></p>
</div>
<div id="aestetics" class="section level3" number="11.5.2">
<h3>
<span class="header-section-number">11.5.2</span> Aestetics<a class="anchor" aria-label="anchor" href="#aestetics"><i class="fas fa-link"></i></a>
</h3>
<p>The second element in the <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> function is called the <strong>aestetics</strong>.
The different elements from the aesthetics are used to display the data.
The most important element is the position which describes the location of the data on the plot, usually by x and y.
Other important elements are shape, fill, size, colour and line type, which describe how the data is presented on the plot.</p>
<p>In the penguin example, if we want to plot the bill length against the bill depth, we choose these two variables as x and y.
As a second aesthetic we have chosen to define species as colour.</p>
<div class="sourceCode" id="cb443"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">bill_depth_mm</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/aestetic-1.png" width="672"></div>
<p>One thing that might be confusing about the argument colour is that it only allows to be a variable, for example <code>colour = species</code> or <code>colour = island</code>.
So for example <code>colour = "red"</code> does not work.
If you want to choose a specific colour, this has to be done in geom or in scales (see below).</p>
<p>Now the ggplot function has added the x and y axis to the plot.
<br><br></p>
</div>
<div id="geoms" class="section level3" number="11.5.3">
<h3>
<span class="header-section-number">11.5.3</span> Geoms<a class="anchor" aria-label="anchor" href="#geoms"><i class="fas fa-link"></i></a>
</h3>
<p>To plot the actual data, you need a <strong>geom function</strong>.
There are many different geom functions that you can choose.
See chapter <em>3. different plot types</em> for an overview.</p>
<p>Here, we will use <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>, which displays the data as points (scatterplot).
Also, the legend is automatically plotted on the right side.</p>
<div class="sourceCode" id="cb444"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">bill_depth_mm</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/add-geom-1.png" width="672"></div>
<p>To come back to the previous point, if you want to make all the points red this can be done in the <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> function using <code>colour = "red". Note that this time we chose</code>shape = species`, another aesthetics to use different symbols for the three species.</p>
<div class="sourceCode" id="cb445"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">bill_depth_mm</span>, shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="working-in-R-bookdown_files/figure-html/red-1.png" width="672"><br><br></p>
</div>
<div id="scales" class="section level3" number="11.5.4">
<h3>
<span class="header-section-number">11.5.4</span> Scales<a class="anchor" aria-label="anchor" href="#scales"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Scales</strong> as the name says is for scaling, converting, inverting.
With scales you can manipulate the labels, breaks, transformations and palettes.
In other words you can manually change the axis text, labels, ticks, add breaks, make transformations, and manipulate aesthetics like colour, shape, linetype.</p>
<p>Here is just a small selection to show what is possible.
We can log transform the y axis, change the axis titles, and manipulate the colours.</p>
<div class="sourceCode" id="cb446"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">bill_depth_mm</span>, colour <span class="op">=</span> <span class="va">species</span>, group <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Log bill length in mm"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Bill depth in mm"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/scales-1.png" width="672"></div>
</div>
<div id="labs" class="section level3" number="11.5.5">
<h3>
<span class="header-section-number">11.5.5</span> Labs<a class="anchor" aria-label="anchor" href="#labs"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code> is a useful function to modify the axis labels, titles and legend.</p>
<p>The axis titles can be renamed, and a title and tag can be added.</p>
<div class="sourceCode" id="cb447"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">bill_depth_mm</span>, colour <span class="op">=</span> <span class="va">species</span>, group <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bill depth in mm"</span>, y <span class="op">=</span> <span class="st">"Bill length in mm"</span>, title <span class="op">=</span> <span class="st">"Bill length vs. depth in penguins"</span>, tag <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/labs-1.png" width="672"></div>
</div>
<div id="stats" class="section level3" number="11.5.6">
<h3>
<span class="header-section-number">11.5.6</span> Stats<a class="anchor" aria-label="anchor" href="#stats"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Stats</strong> are statistical transformations to summarize objects in the data in different ways.
You can add means or confidence intervals on top of your data.</p>
<div class="sourceCode" id="cb448"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">bill_depth_mm</span>, colour <span class="op">=</span> <span class="va">species</span>, group <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, colour <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="working-in-R-bookdown_files/figure-html/stats-1.png" width="672"><br><br></p>
</div>
<div id="facets" class="section level3" number="11.5.7">
<h3>
<span class="header-section-number">11.5.7</span> Facets<a class="anchor" aria-label="anchor" href="#facets"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Facets</strong> can be used to divide the data into different subplots, which can enhance readability of a figure.</p>
<p>In the penguin example we can show 3 different panels for each island.
This way of plotting makes it easy to see which penguin species occurs on each island.</p>
<div class="sourceCode" id="cb449"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">bill_depth_mm</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">island</span><span class="op">)</span></code></pre></div>
<p><img src="working-in-R-bookdown_files/figure-html/facets-1.png" width="672"><br><br></p>
</div>
<div id="themes" class="section level3" number="11.5.8">
<h3>
<span class="header-section-number">11.5.8</span> Themes<a class="anchor" aria-label="anchor" href="#themes"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Themes</strong> is a powerful element that controls the look of the plot.
In themes you can change, remove and add the background, gridlines, ticks, text, text size and much more.</p>
<p>In our example, we will change the axis tile text size, the colour of the axis text and change the theme to <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal()</a></code>.</p>
<div class="sourceCode" id="cb450"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">bill_depth_mm</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">island</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,
        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/theme-1.png" width="672"></div>
<p><br><br></p>
</div>
<div id="a-ggplots-are-built-with-layers" class="section level3" number="11.5.9">
<h3>
<span class="header-section-number">11.5.9</span> A ggplots are built with layers<a class="anchor" aria-label="anchor" href="#a-ggplots-are-built-with-layers"><i class="fas fa-link"></i></a>
</h3>
<p>As you can see, there are almost no limits to what you can do in a ggplot.
The trick is to know which element changes what and to remember all the names (i.e. what is axis.text and axis.ticks etc.).</p>
<p>The order in which you code the different components of a plot often does not matter (although there are discussions around that topic, see here).
You can imagine the different components (geom, scale, stats) of the plot as different layers that are plotted on top of each other.
Usually, the order is not so important, unless something needs to be plotted on top of something else.
But this is easy to spot once you see the plot.</p>
<p>For examle, you want to plot the data below and the mean values on top, and not the other way round.
See below, the red points showing the means have disapeard. So, the things you want on top are plotted after.</p>
<div class="sourceCode" id="cb451"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">bill_depth_mm</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, colour <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/wrong-order-1.png" width="672"></div>
</div>
</div>
<div id="common-mistakes" class="section level2 tabset" number="11.6">
<h2>
<span class="header-section-number">11.6</span> Common mistakes<a class="anchor" aria-label="anchor" href="#common-mistakes"><i class="fas fa-link"></i></a>
</h2>
<p>In the beginning you will make mistakes which will result in error messages, warnings or incomplete plots.
These mistakes often occur when one of the layers is missing, because a <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> is forgotten at the end of a line, due to a typo, or the data or other elements are forgotten.
Let us look at some common mistakes and how the ggplot is displayed or not.
<br><br></p>
<div id="no-data" class="section level3" number="11.6.1">
<h3>
<span class="header-section-number">11.6.1</span> No data<a class="anchor" aria-label="anchor" href="#no-data"><i class="fas fa-link"></i></a>
</h3>
<p>If you forget to specify the data ggplot will not be able to make a plot and you will get the following error message:</p>
<div class="sourceCode" id="cb452"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">bill_depth_mm</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Error: `data` must be a data frame, or other object coercible by `fortify()`, not an S3 object with class uneval.
## Did you accidentally pass `aes()` to the `data` argument?</code></pre>
</div>
<div id="missing-aesthetics" class="section level3" number="11.6.2">
<h3>
<span class="header-section-number">11.6.2</span> Missing aesthetics<a class="anchor" aria-label="anchor" href="#missing-aesthetics"><i class="fas fa-link"></i></a>
</h3>
<p>If you forget to define the aesthetics <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> you will also get an error message and a empty image:</p>
<div class="sourceCode" id="cb454"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Error: geom_point requires the following missing aesthetics: x and y</code></pre>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/no-aestetics-1.png" width="672"></div>
</div>
<div id="missing-geometry" class="section level3" number="11.6.3">
<h3>
<span class="header-section-number">11.6.3</span> Missing geometry<a class="anchor" aria-label="anchor" href="#missing-geometry"><i class="fas fa-link"></i></a>
</h3>
<p>If the geometry is missing <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>, ggplot will draw a empty plot, with axis labels, but show not data, because you have not defined how to plot the data.</p>
<div class="sourceCode" id="cb456"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">bill_depth_mm</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/no-geom-1.png" width="672"></div>
</div>
<div id="whats-next-2" class="section level3 facta" number="11.6.4">
<h3>
<span class="header-section-number">11.6.4</span> What’s next?<a class="anchor" aria-label="anchor" href="#whats-next-2"><i class="fas fa-link"></i></a>
</h3>
<p>Next, we will show the <a href="">essential elements</a> of a plot (title, axes, legend, …) and you can learn how to change and adapt each of these elements.
Further you can learn the most common <a href="">plots types</a> that are commonly used.</p>

</div>
<div id="before-we-start-3" class="section level3 facta toc-ignore" number="11.6.5">
<h3>
<span class="header-section-number">11.6.5</span> Before we start<a class="anchor" aria-label="anchor" href="#before-we-start-3"><i class="fas fa-link"></i></a>
</h3>
<p>Data types
Familiar with ggplot (chapter 1 and 2)
Uncertainty things…</p>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="why-is-data-visualization-important.html"><span class="header-section-number">10</span> Why is data visualization important?</a></div>
<div class="next"><a href="types-of-vizualization.html"><span class="header-section-number">12</span> Types of vizualization</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#getting-started-with-ggplot"><span class="header-section-number">11</span> Getting started with ggplot</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#before-you-start"><span class="header-section-number">11.0.1</span> Before you start</a></li></ul>
</li>
<li><a class="nav-link" href="#install-the-ggplot2-package"><span class="header-section-number">11.1</span> Install the ggplot2 package</a></li>
<li><a class="nav-link" href="#the-basics"><span class="header-section-number">11.2</span> The basics</a></li>
<li><a class="nav-link" href="#the-code"><span class="header-section-number">11.3</span> The code</a></li>
<li><a class="nav-link" href="#the-palmer-penguin-example"><span class="header-section-number">11.4</span> The Palmer Penguin Example</a></li>
<li>
<a class="nav-link" href="#building-a-ggplot-figure"><span class="header-section-number">11.5</span> Building a ggplot figure</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#data"><span class="header-section-number">11.5.1</span> Data</a></li>
<li><a class="nav-link" href="#aestetics"><span class="header-section-number">11.5.2</span> Aestetics</a></li>
<li><a class="nav-link" href="#geoms"><span class="header-section-number">11.5.3</span> Geoms</a></li>
<li><a class="nav-link" href="#scales"><span class="header-section-number">11.5.4</span> Scales</a></li>
<li><a class="nav-link" href="#labs"><span class="header-section-number">11.5.5</span> Labs</a></li>
<li><a class="nav-link" href="#stats"><span class="header-section-number">11.5.6</span> Stats</a></li>
<li><a class="nav-link" href="#facets"><span class="header-section-number">11.5.7</span> Facets</a></li>
<li><a class="nav-link" href="#themes"><span class="header-section-number">11.5.8</span> Themes</a></li>
<li><a class="nav-link" href="#a-ggplots-are-built-with-layers"><span class="header-section-number">11.5.9</span> A ggplots are built with layers</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#common-mistakes"><span class="header-section-number">11.6</span> Common mistakes</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#no-data"><span class="header-section-number">11.6.1</span> No data</a></li>
<li><a class="nav-link" href="#missing-aesthetics"><span class="header-section-number">11.6.2</span> Missing aesthetics</a></li>
<li><a class="nav-link" href="#missing-geometry"><span class="header-section-number">11.6.3</span> Missing geometry</a></li>
<li><a class="nav-link" href="#whats-next-2"><span class="header-section-number">11.6.4</span> What’s next?</a></li>
<li><a class="nav-link" href="#before-we-start-3"><span class="header-section-number">11.6.5</span> Before we start</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Working in R</strong>" was written by Jonathan Soulé, Aud Halbritter and Richard J Telford. It was last built on 2021-09-06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
