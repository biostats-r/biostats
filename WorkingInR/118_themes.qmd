---
execute: 
  warning: false
---


``` {r}
#| label: setup
#| include: false
source("R/setup.R")
```

# Themes {#sec-themes}

```{r}
#| label: default-theme
#| eval: true
#| include: false
theme_set(theme_grey())
```

Themes let you customise the non-data elements of a plot.
You can change the whole theme, or update just a few elements.
Here is a plot with the default theme.

```{r}
#| label: theme-plot
#| fig-keep: none
library(ggplot2)
p1 <- ggplot(penguins, aes(
  x = body_mass,
  y = bill_len,
  colour = species
)) +
  geom_point()
p1
```

```{r}
#| label: theme-grey
#| echo: false
#| fig-cap: The default theme, `theme_grey()`
#| fig-alt: >
#|   Scatterplot of penguin bill length against body mass with the default theme
#|   - a grey background to the plot with white gridlines
#| fig-height: 3
#| fig-width: 4
p1 + theme_grey()
```

## Complete themes

You can change the whole theme to a new pre-built theme by adding one of the `theme_*()` functions.

```{r}
#| label: complete-themes
#| fig-cap: '`theme_classic()`'
#| fig-height: 3
#| fig-width: 4
#| fig-alt: >
#|   The previous plot with the classic theme - white background without
#|   gridlines and axis lines only on the bottom and left side of the plot.
p1 +
  theme_classic()
```

There are many pre-built themes, some in `ggplot2`, others in the `ggthemes`, `cowplot`, and other packages. 
You can also write your own.

```{r}
#| label: many-themes
#| echo: false
#| fig-cap: Various themes from `ggplot2` and `gthemes`.
#| fig-alt: Four copies of the previous plot with different themes.
library(ggthemes)
library(patchwork)
bs <- 8
t1 <- p1 + theme_bw(base_size = bs) +
  labs(title = "theme_bw()")
t2 <- p1 + theme_linedraw(base_size = bs) +
  labs(title = "theme_linedraw()")
t3 <- p1 + theme_clean(base_size = bs) +
  labs(title = "theme_clean()")
t4 <- p1 + theme_economist(base_size = bs) +
  labs(title = "theme_economist()")

t1 + t2 + t4 + t3
```
### Setting the font

All the `theme_*()` functions have an argument to set the base size of the font.
The default (about size 11 for most themes) is normally fine for manuscripts and theses, but too small for presentations.
Increase it to 18 or 20 so the audience at the back of the auditorium can read the text.

```{r}
#| label: base-size
#| fig-cap: '`theme_classic()` with a large font.'
#| fig-alt: The previous plot with a large font, suitable for a presentation.
#| fig-height: 3
#| fig-width: 5
p1 +
  theme_classic(base_size = 18)
```

## Setting the default theme

If you are making several figures and want them all to have the same theme, you can set the default with `set_theme()`.
I do this in the first chunk of quarto and R markdown documents.

```{r}
#| label: theme_set
#| eval: false
set_theme(theme_classic())
```

## Changing individual elements of the theme

Every non-data element of the plot can be changed with `theme`.
Below are a few examples.

### Rotating axis labels

Sometimes long axis labels need rotating to stop them overlapping.

```{r}
#| label: theme_rotate
#| fig-height: 3
#| fig-width: 2
#| fig-alt: Boxplot of penguin body masses with the species names overlapping.
p2 <- ggplot(penguins, aes(x = species, y = body_mass)) +
  geom_boxplot()
p2
```
```{r}
#| label: theme_rotate2
#| fig-height: 3
#| fig-width: 2
#| fig-alt: >
#|  The previous plot with the axis labels rotated by 45Â° to avoid overlapping.
p2 +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Reading angled text is hard work, so consider alternative solutions to this problem, such as dodging the axis labels

```{r}
#| label: axis-dodge
#| fig-height: 3
#| fig-width: 2
#| fig-alt: The previous plot with the axis labels offset to avoid overlapping.
p2 + scale_x_discrete(guide = guide_axis(n.dodge = 2))
```

Or flipping the plot.

```{r}
#| label: flip
#| fig-height: 3
#| fig-width: 3
#| fig-alt: >
#|   The previous plot flipped so the boxplots and their labels are horizontal.
p2 + coord_flip()
```

### Changing the legend position

By default, the legend is put to the right of the plot.
It can be moved with the `legend.position` argument to `theme()`.

```{r}
#| label: legend-position
#| fig-height: 3
#| fig-width: 4
#| fig-alt: >
#|   Scatterplot with the legend on the bottom rather than the default location
#|   on the right.
p1 + theme(legend.position = "bottom")
```

If there is space, the legend can be moved into the plot by giving `legend.position` the x and y coordinates relative to the plot (0 is left or bottom, 1 is top or right).
Use `legend.justification` to specify which corner of the legend should be in the position set by `legend.position` justify the legend.

```{r}
#| label: legend-position2
#| fig-height: 3
#| fig-width: 4
#| fig-alt: >
#|   Scatterplot with the legend moved into an empty place within the plot.
p1 +
  theme(
    legend.position = c(x = 0.99, y = 0.01),
    legend.justification = c(x = "right", y = "bottom")
  )
```

The legend can be removed with 

```{r}
#| label: legend-none
#| fig-height: 3
#| fig-width: 4
#| fig-alt: Scatterplot with the legend removed.
p1 + theme(legend.position = "none")
```

This will remove all legends.
If a plot has multiple legends, and you want to keep some of them, you get more control by using the `show.legend` argument to any of the geoms or by using `guides()`

### Removing an element

You can remove non-data elements of the plot by setting them to `element_blank()`.

```{r}
#| label: element-blank
#| fig-height: 3
#| fig-width: 4
#| fig-cap: Removing gridlines with `element_blank()`
#| fig-alt: Scatterplot with the gridlines removed.
p1 + theme(panel.grid = element_blank())
```

::: {.column-margin}
### Contributors {.unlisted .unnumbered}

-   Richard Telford
:::
