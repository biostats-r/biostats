---
output:
  html_document:
    css: custom.css
--- 

```{r setup&variables, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.align = "center")

# title: Creating a frequency polygon
# author: jonathan
# revised: 17/3/2020

WEB <- c("https://bioceed.uib.no/dropfolder/bioSTATS/Rmd/Visualizing/Simple/frequency-polygon.html")
GIT <- c("https://github.com/jonathansoule/biostats/blob/master/Visualizing/Simple/frequency-polygon.Rmd")
library(ggplot2)
library(gridExtra)
```
A frequency polygon and a histogram are very much alike. Both help visualize the distribution of a data series, the former using bars to represent counts and the latter using lines.

Let's use `ggplot()` to draw the frequency polygon for a data set generated by `rnorm()` (read more [here](https://biostats.w.uib.no/4-generating-random-series/){target="_blank"} about `rnorm()`). Here are the variables and dataframe:
```{r dataframe}
# ID
ID <- 1:200
# sample data
values <- rnorm(200, mean = 65, sd = 15)
# dataframe
df <- data.frame(ID, values)
```
<br/><br/>

We first map the data from the variable `values` by typing `ggplot(df, aes(values))` and then use `geom_freqpoly()` to draw the plot:
```{r plot}
ggplot(df, aes(values)) +
  geom_freqpoly()
```
<br/><br/>

To realize how similar a frequency polygon and a histogram are, we can put them next to each other:
```{r plot2a, eval=FALSE}
ggplot(df, aes(values)) + # histogram
  geom_histogram(bins = 30)
ggplot(df, aes(values)) + # frequency polygon
  geom_freqpoly(bins = 30)
```
```{r plot2b, echo=FALSE, fig.width=10, fig.height=4}
grid.arrange(
  ggplot(df, aes(values)) + # histogram
    geom_histogram(bins = 30),
  ggplot(df, aes(values)) + # frequency polygon
    geom_freqpoly(bins = 30),
  ncol = 2
)
```
The shapes of these two plots are not strictly identical but they clearly show the same pattern of distribution. 
<br/><br/>

As for any histogram, we can modify the binwidth or the number of bins using `binwidth=` or `bins=` in `geom_freqpoly()`. Here are two examples:
```{r plot3a, eval=FALSE} 
ggplot(df, aes(values)) +
  geom_freqpoly(bins = 60) # left plot, changing bins
ggplot(df, aes(values)) +
  geom_freqpoly(binwidth = 10) # right plot, changing binwidth
```
```{r plot3b, echo=FALSE, fig.width=10, fig.height=4} 
grid.arrange(
  ggplot(df, aes(values)) +
    geom_freqpoly(bins = 60), # left plot, changing bins
  ggplot(df, aes(values)) +
    geom_freqpoly(binwidth = 10), # right plot, changing binwidth
  ncol = 2
)
```
<br/><br/>

As usual, you may change the look of the line with `size=`, `color=` and `linetype=`:
```{r plot4}
ggplot(df, aes(values)) +
  geom_freqpoly(bins = 60, size = 1.5, color = "darkblue", linetype = "dotted")
```

<br/><br/>

### Adding plot title, axis titles, ticks, labels and other essential elements

In [this section](https://biostats.w.uib.no/topics/data-visualization-with-ggplot2/essential-elements/){target="_blank"}, you will learn how to set/modify all the necessary elements that make a plot complete and comprehensible. Such elements are:

+ [plot title](https://biostats.w.uib.no/title/){target="_blank"}, 
+ [axis title](https://biostats.w.uib.no/axis-titles/){target="_blank"},
+ [axis scale](https://biostats.w.uib.no/axis-scale/){target="_blank"},
+ [axis ticks](https://biostats.w.uib.no/axis-ticks/){target="_blank"},
+ [category labels](https://biostats.w.uib.no/category-labels/){target="_blank"},
+ [legend](https://biostats.w.uib.no/legend/){target="_blank"},
+ [secondary Y-axis](https://biostats.w.uib.no/secondary-y-axis/){target="_blank"},
+ [colors](https://biostats.w.uib.no/choosing-colors-for-your-plot/){target="_blank"},
+ [etc](https://biostats.w.uib.no/topics/data-visualization-with-ggplot2/essential-elements/){target="_blank"}.

<br/><br/>

***
<!-- UNCOMMENT TO ACTIVATE
Get the Rmarkdown file corresponding to this page on [GitHub](`r GIT`){target="_blank"}.
-->
